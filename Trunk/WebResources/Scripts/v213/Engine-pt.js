var Language={"Locale" :  "pt","getToken" : function(key) {var localized = this[key];if( localized != null ) {return localized;}return "@(" + key + ")";},      "AlreadyAttacked" : "Não podes seleccionar a unidade porque ela já fez um ataque.",      "AlreadyBuyed" : "O recurso já foi comprado.",      "AttackFirstMove" : "Não podes atacar quando és o primeiro a jogar.",     "CannotStartOnVacations" : "Não podes começar uma batalha porque estás de férias.",     "ChooseAtLeastOneUnit" : "Tens de escolher, pelo menos, um tipo de unidade.",      "CoolDown" : "Não podes atacar porque a unidade está em espera devido ao último ataque.",      "Errors" : "Erros",      "FleetCantPassWormHole" : "A armada não pode passar por um wormhole porque possui carga que o impede.",      "FleetToWeakToStartBattleMessage" : "Armada fraca demais para iniciar batalha.",      "FriendlyBattleCreatedWithSuccess" : "Batalha amigável foi criada com sucesso.",      "GreaterThanBuyout" : "A licitação não pode ser superior à compra.",      "Information" : "Informação",      "InvalidItem" : "Elemento inválido.",      "InvalidOpponent" : "Oponent é inválido.",      "InvalidProduct" : "Produto inválido.",      "InvalidUnitValue" : "Unidade '{0}' tem uma quantidade inválida.",      "LowerBid" : "Licitação inválida.",      "Maximum8Units" : "Só podes escolher um total de 8 unidades.",      "MinimumMove" : "Tens de mover pelo menos 20% das tuas unidades.",      "MinimumRest" : "Tens de deixar pelo menos 20% das tuas unidades.",      "Moves" : "Não possuis movimentos suficientes.",      "MustBePositiveQuantity" : "Tem de ser inserido um número maior que zero.",      "MustSelectABattleType" : "Tens de seleccionar um tipo de batalha.",      "NaN" : "Não é um número.",      "NoCredits" : "Orions insuficientes.",      "NoInputProvided" : "É necessário inserir um valor.",      "NoMovesToSplit" : "Não tens movimentos suficientes para dividir. Dividir esta unidade custa",      "NoMovesToSplit2" : "movimentos.",      "Ok" : "Operação bem sucedida.",      "Paralysed" : "Não podes mover a unidade por está paralizada.",     "PaymentCancel" : "Pagamento cancelado pelo utilizador.",     "PaymentError" : "Ocorreu um erro na confirmação do pagamento. Para algum esclarecimento podes <a href='Contact.aspx'>contactar-nos</a>.",      "QuantityError" : "insere uma quantidade válida.",      "SamePrincipalAccountError" : "Não é possível transaccionar produtos entre contas.",     "Success" : "Sucesso",      "UltimateUnitAttack" : "Unidade Suprema não possui movimentos suficientes para atacar.",      "UnitsNotPositioned" : "Tens de posicionar todas as unidades.",  "CreateTopic" : "Criar Tópico",  "NoTopics" : "Sem tópicos para mostrar",  "PrivateForum" : "Forum Privado",  "PublicForum" : "Forum Público",  "Topics" : "Tópicos",  "Posts" : "Posts",  "LastPost" : "Último Post",  "NoThreads" : "Este tópico não possui nenhuma conversa",  "NoPosts" : "Esta conversa não possui nenhum post",  "Close" : "Fechar",  "InvalidText" : "O texto inserido é inválido",  "NoPost" : "Sem Posts",  "Erase" : "Apagar",  "Threads" : "Conversas",  "Views" : "Visualizações",  "CreateThread" : "Criar Conversa",  "Weak" : "Fraco",  "Pacific" : "Pacífico",  "Agressive" : "Agressivo",  "Audacious" : "Audacioso",  "Fearless" : "Destemido",  "Legend" : "Lenda",  "Joined" : "Membro desde",  "CreatePost" : "Criar Post",  "ErrorRemovingPost" : "Erro ao remover o Post",  "ErrorRemovingThread" : "Erro ao remover a Conversa",  "ErrorRemovingTopic" : "Erro ao remover o Tópico",  "ReturnTopics" : "Regressar à Pagina principal",  "ReturnThread" : "Regressar a",  "Rank" : "Nível",  "By" : "Por",  "On" : "Em",  "At" : "às",  "EraseThread" : "Desejas remover esta conversa?",  "ErasePost" : "Desejas remover este post?",  "EraseTopic" : "Desejas remover este tópico?",  "ErasePostSimple" : "Eliminar Post",  "EditPost" : "Editar Post",  "CannotRemovePost" : "Não podes remover um post que não te pertence!",  "forumRead" : "Sem novos posts",  "forumUnreadLightHumans" : "Novos posts",  "forumUnreadDarkHumans" : "Novos posts",  "forumUnreadBugs" : "Novos posts",   "VeryHappy" : "Muito Feliz",   "Happy" : "Feliz",   "Sad" : "Triste",   "Surprised" : "Surpreso",   "Shocked" : "Chocado",   "Confused" : "Confundido",   "Cool" : "Cool",   "Laughing" : "Rir",   "Mad" : "Chateado",   "Cheeky" : "Atrevido",   "RedFace" : "Envergonhado",   "Cry" : "Chorar",   "Twisted" : "Demoniaco",   "Wink" : "Piscar os Olhos",   "Edit" : "Editar",     "Academy" : "Academia",       "Alliance" : "Aliança",       "AreYouSure" : "Tens a certeza?",       "AreYouSureYouWantToDeleteFleet" : "Tens a certeza que queres destruir esta armada?",       "Build" : "Construir",       "BuildFacility" : "Construir Edifício",       "BuildUnits" : "Construir Unidades",       "CannotPassWormHoleMessage" : "A armada '{0}' não pode passar por um wormhole porque possui carga que o impede.",       "Cargo" : "Carga",       "ClickHereToBuildOnThisSlot" : "Clica para construires um edifício nesta posição. Podes construir aqui:",       "ClickHereToUpgradeOnThisSlot" : "Clica para evoluires o edifício nesta posição.",       "Continue" : "Queres realmente continuar?",       "Coordinate" : "Coordenada",       "DefenseFleet" : "Armada de Defesa",       "DeployLoaded" : "Posicionamento carregado com sucesso.",       "DeploySaved" : "Posicionamento guardado com sucesso.",       "Destination" : "Destino",       "Destiny" : "Destino",       "DevastationAttack" : "Ataque Devastação",       "DevastationCannotBeUsed" : "Ataque Devastação não pode ser usado porque não tens recursos suficientes.",       "DevastationUsageConfirmation" : "Não podes voltar atrás com um ataque Devastação. Tens a certeza que o queres usar?",       "DropCargoFleetInBattle" : "Não é possível largar a carga porque a armada está em batalha.",       "Duration" : "Duração",       "EndTurn" : "Acabar Turno",       "ETA" : "Chegada em",       "FacilityLevel" : "Nível dos Edifícios",       "False" : "Não",       "false" : "Não",      "FleetAtMaximum" : "A armada só pode levar 8 tipos de nave",       "FleetInBattle" : "Não é possível mover as unidades porque a armada está em batalha.",       "FleetIsMoving" : "Não é possível mover as unidades porque a armada está em movimento.",       "Fleets" : "Armadas",      "FleetSavedWithSuccess" : "Armada salva com sucesso",       "GiveUp" : "Desistir",       "HeavyQuantity" : "Quantidade de Fortes",       "Income" : "Produção",       "InConstruction" : "Em Construção",       "InProduction" : "Em Produção",       "InQueue" : "Em Espera",       "InvalidCoordinate" : "Coordenada inserida é inválida.",       "IsInBattle" : "Está em Batalha",       "IsMoving" : "Em movimento",       "Level" : "Nível",       "LightQuantity" : "Quantidade de Rápidas",      "Market" : "Mercado",       "MediumQuantity" : "Quantidade de Equilibradas",       "MoveUndiscovered" : "Ao mover para uma zona não descoberta, a armada vai sofrer uma penalização de movimento. Queres continuar?",       "NeedToSelectAFleetFirst" : "Precisas de seleccionar uma fleet.",      "No" : "Não",       "NoDeploySaved" : "Nenhum posicionamento foi guardado.",       "NoMessages" : "Nenhuma mensagem de momento!",       "None" : "Nenhuma",       "NotAvailableYet" : "Indisponível",       "NotDiscoveredCoordinate" : "A coordenada inserida ainda não foi descoberta.",       "OnVacations" : "De Férias",       "Owner" : "Dono",       "PillageCoolDownMessage" : "Não podes pilhar o planeta '{0}' por está em cooldown de pilhagem.",      "PirateBay" : "Baía de Piratas",       "Planets" : "Planetas",       "Player1" : "Jogador 1",       "Player2" : "Jogador 2",       "ProductionQueue" : "Fila de Espera para Produção",       "Quest" : "Missão",       "Queue" : "Fila de Espera",       "ReallyAbandonPlanet" : "Ao abandonares este planet, todas as unidades na armada de defesa serão perdidas. Queres mesmo abandonar?",      "ReallyDelete" : "De certeza que queres apagar?",       "ReallyDestroyFacility" : "De certeza que queres destruir este edifício?",       "Running" : "Activo",      "SelectPlayerFirst" : "Tens de pesquisar por um jogador primeiro.",       "State" : "Estado",      "TradeResource" : "Recurso de Troca",       "True" : "Sim",       "true" : "Sim",       "TTM" : "Tempo para Mover",       "Turn" : "turno",       "Turns" : "turnos",       "UltimateWeaponNotReady" : "Arma Suprema não está pronta a ser usada. Verifica se tens recursos suficientes.",       "Undo" : "Voltar Atrás",       "Units" : "Unidades",       "UnloadCargoFleetInBattle" : "Não é possível descarregar a carga porque a armada está em batalha.",       "Upgrade" : "Evoluir",       "UpgradeFacility" : "Evoluir Edifício",       "WormHole" : "Túnel Espacial",       "WormHoles" : "Túneis Espaciais",      "Yes" : "Sim",     "YouHaveBattlesToPlay" : "Tens batalhas de universo para fazer. Até fazeres os teus movimentos, não podes fazer qualquer acção nesta página.",       "youMustSelectAType" : "Tens de seleccionar um tipo de batalha",       "YouWillLooseResources" : "Tens a certeza? Nota que perdes todos os recursos pagos quando cancelas algo já em produção!",       "Air" : "Ar",      "AirVent" : "Conduta de Ar",        "Alcohol" : "Álcool",        "All" : "Completo",        "Animals" : "Animais",      "AntiMatterContainer" : "Contentor Anti Mátéria",        "Anubis" : "Anubis",        "Argon" : "Argon",        "Astatine" : "Astatine",        "Attack" : "Ataque",        "BattleMoon" : "Lua de Batalha",        "BattleMoonAssembler" : "Fábrica de Luas de Combate",        "BattleMoonDescription" : "A derradeira unidade dos humanos sombrios",      "Berilium" : "Berílio",      "BlackMercSpaceChart" : "Mapa Espacial dos Black Mercs",      "BlackMercUniform" : "Uniforme dos Black Mercs",        "BlackWidow" : "Viúva Negra",        "Blinker" : "Pisca-pisca",        "BlinkerAssembler" : "Fábrica de Pisca-piscas",    "BlueMatter" : "Matéria Azul",    "BlueMatterContainer" : "Contentor de Matéria Azul",        "BombAttack" : "Ataque Bomba",        "Boozer" : "Boozer",       "BoozerDescription" : "",        "Bozer" : "Bozer",    "CaptainWolf" : "Capitão Lobo",    "CaptainWolfShipSpecifications" : "Especificações da nave do Capitão Lobo",      "CarbonNanoTube" : "Nano Tubos de Carbono",        "Catapult" : "Catapulta",        "CommandCenter" : "Centro de Comando",    "CommanderFox" : "Comandante Raposa",    "CommanderFoxShipSpecifications" : "Especificações da nave do Comandante Raposa",      "CommanderWolf" : "Comandante Lobo",      "CommunicationsArray" : "Array de Comunicações",        "CosmicDust" : "Poeira Cósmica",    "Crawler" : "Rastejante",    "CrawlerGyroBalancer" : "Giro-Balanceador de um Rastejante",    "CrawlerStaticPulse" : "Impulso Estático de um Rastejante",      "CriminalListAlpha" : "Lista de Criminosos Alpha",      "CriminalListBeta" : "Lista de Criminosos Beta",      "CriminalListDelta" : "Lista de Criminosos Delta",      "CriminalListGamma" : "Lista de Criminosos Gamma",      "CriminalListOmega" : "Lista de Criminosos Omega",      "CriminalListSigma" : "Lista de Criminosos Sigma",        "Crusader" : "Crusador",        "Cryptium" : "Cryptium",    "Cypher" : "Cypher",        "DarkCrusader" : "Cruzador Sombrio",     "DarkMatter" : "Matéria Negra",      "DarkMercSpaceChart" : "Mapa Espacial dos Dark Mercs",      "DarkMercUniform" : "Unforme dos Dark Mercs",        "DarknessHall" : "Capital da Escuridão",        "DarkRain" : "Rain Sombria",        "DarkTaurus" : "Touro Sombrio",        "DeepSpaceScanner" : "Radar de Longo Alcance",        "Defense" : "Defesa",        "Destroyer" : "Destruidor",      "DeutiriumEnergyCapsule" : "Cápsula de Energia de Deutério",        "Devastation" : "Devastação",        "DevotionSanctuary" : "Santuário de Devoção",        "Diagonal" : "Diagonal",        "Diamonds" : "Diamantes",        "DominationYard" : "Hangar do Domínio",        "Doomer" : "Aniquiladora",        "Driller" : "Perfurador",        "Eagle" : "Águia",        "Egg" : "Ovo",       "ElectricCircuit" : "Circuito Elétrico",        "Elk" : "Comida",        "ElkExtractor" : "Extractor de Comida",        "Energy" : "Energia",      "EscapePod" : "Cápsula de Fuga",      "ExhaustionSystem" : "Sistema de Exaustão",        "Extractor" : "Extractor de Recursos",        "Facilities" : "Edifícios",        "Fenix" : "Fénix",    "Fist" : "Punho",    "FistTargettingSystem" : "Sistema de Mira de um Punho",        "Flag" : "Bandeira",        "Front" : "Em Frente",        "Gold" : "Ouro",      "GreyMatter" : "Matéria Cinzenta",        "Ground" : "Terrestre",        "Heavy" : "Grande Porte",        "HeavySeeker" : "Mega Batedor",        "HiveKing" : "Rei da Colmeia",        "HiveProtector" : "Protector da Colmeia",      "HolographicCube" : "Cubo Holográfico",        "Incubator" : "Incubadora",        "InfestationAttack" : "Ataque Venenoso",        "Interceptor" : "Interceptador",        "Intrinsics" : "Intrínsecos",      "IonCannon" : "Canhão de Iões",    "Jumper" : "Jumper",      "JumperReactor" : "Reactor de um Jumper",      "JumperStabilizers" : "Estabilizadores de um Jumper",        "Kahuna" : "Kahuna",        "Kamikaze" : "Suicida",        "Krill" : "Krill",        "Light" : "Pequeno Porte",    "LightEngines" : "Motores de Velocidade da Luz",        "Maggot" : "Larva",        "Mechanic" : "Mecânico",      "MedicalKit" : "Kit Médico",        "Medicine" : "Medicamentos",        "Medium" : "Médio Porte",      "MercSpaceChart" : "Mapa Espacial dos Mercs",       "MercUniform" : "Uniformes de Merc",        "Mercury" : "Mercúrio",       "MetallicBeard" : "Barba Metálica",        "Mithril" : "Mithril",        "MithrilExtractor" : "Extractor de Mithril",        "MovementType" : "Movimento",    "Myst" : "Myst",      "MystPropulsionSystem" : "Sistema de Propulsão de um Myst",      "MystTargetingSystem" : "Sistema de Mira das Myst",      "NanoProbe" : "Nano Sonda",        "Nest" : "Ninho",        "Normal" : "Normal",        "Nova" : "Nova",        "NuclearFacility" : "Extractor de Urânio",        "Organic" : "Orgânico",        "Panther" : "Pantera",        "ParalyseAttack" : "Ataque Paralizador",       "PlasmaConduit" : "Conduta de Plasma",      "PositronCannon" : "Canhão de Positrões",      "PositronContainer" : "Contentor de Positrões",        "Pretorian" : "Pretoriana",      "PrimaryBoard" : "Placa Principal",        "Prismal" : "Prismal",        "ProductionSpace" : "Espaço para Produção",        "Protol" : "Protol",        "ProtolExtractor" : "Extractor de Protol",        "Queen" : "Rainha",        "QueenHatchery" : "Incubadora de Rainhas",        "QueueSpace" : "Espaço na Lista de Espera",        "Radon" : "Radon",        "Rain" : "Rain",        "Range" : "Alcance",        "Raptor" : "Raptor",       "Reaper" : "Ceifeiro",      "ReaperControlHelmet" : "Capacete de Contrôlo de um Reaper",      "ReaperCoreSystem" : "Sistema de Contrôlo de um Ceifeiro",      "ReaperPropulsionSystem" : "Sistema de Propulsão de um Reaper",        "Rebound" : "Ricochete",      "RedMatter" : "Matéria Vermelha",        "RemoveAbilityAttack" : "Remoção de Habilidades",        "Replicator" : "Replicador",        "Resources" : "Recursos",      "RogueMercSpaceChart" : "Mapa Espacial dos Rogue Mercs",      "RogueMercUniform" : "Uniforme de um Rogue Mercs",        "Samurai" : "Samurai",        "Scarab" : "Escaravelho",       "Scourge" : "Flagelo",      "ScourgeControlPanel" : "Painel de Controlo de um Flagelo",      "ScourgeCoreSystem" : "Sistema de Contrôlo de um Flagelo",      "ScourgePropulsionSystem" : "Sistema de Propulsão de um Flagelo",        "Seeker" : "Batedor",       "Sentry" : "Vigilante",      "SentryMercSpaceChart" : "Mapa Espacial dos Sentry Mercs",      "SentryMercUniform" : "Uniforme dos Sentry Mercs",      "SentryReactor" : "Reactor de um Sentry",        "Serium" : "Serium",        "SeriumExtractor" : "Extractor de Serium",      "Silicium" : "Silício",        "Silo" : "Armazém",      "SilverBeard" : "Barba de Prata",        "SlaveWarehouse" : "Poço da Escravatura",        "SolarPanel" : "Painel Solar",      "SpaceForceUniformAlpha" : "Uniforme da Space Force Alpha",      "SpaceForceUniformBeta" : "Uniforme da Space Force Beta",      "SpaceForceUniformDelta" : "Uniforme da Space Force Delta",      "SpaceForceUniformGamma" : "Uniforme da Space Force Gamma",      "SpaceForceUniformOmega" : "Uniforme da Space Force Omega",      "SpaceForceUniformSigma" : "Uniforme da Space Force Sigma",        "Special" : "Especial",        "Spider" : "Aranha",        "Stinger" : "Ferrão",        "StrikeBack" : "Contra-Ataque",      "SubLightEngines" : "Motores Sub-Luz",      "SubSpaceSensors" : "Sensores Sub-Espaço",        "Supplies" : "Mantimentos",      "TacticalComputer" : "Computador Táctico",        "Taurus" : "Touro",      "TechMercSpaceChart" : "Mapa Espacial dos Tech Mercs",      "TechMercUniform" : "Uniforme dos Tech Mercs",       "Titan" : "Titã",      "TitanControlHelmet" : "Capacete de Contrôlo de um Titã",        "Titanium" : "Titânio",        "TitaniumExtractor" : "Extractor de Titânio",      "TitanTargetingSystem" : "Sistema de Mira de um Titã",      "TitanUnitronCannon" : "Canhão Unitron de um Titan",        "Tools" : "Ferramentas",        "Toxic" : "Tóxica",      "TransportSystem" : "Sistema de Transporte",        "Triple" : "Ataque Triplo",        "Ultimate" : "Suprema",        "UnitCategory" : "Categoria",        "UnitDisplacement" : "Posição",        "UnitValue" : "Valor de Unidade",        "UnitYard" : "Porto Espacial",        "Uranium" : "Urânio",        "Vector" : "Vector",       "Walker" : "Caminhante",      "WalkerCore" : "Núcleo de um Walker",      "WalkerGiroBalancer" : "Giro-Balanceador de um Walker",        "Worm" : "Minhoca",        "WormHoleCreator" : "Gerador de Túneis Espaciais",         "Desert" : "Deserto",           "Forest" : "Floresta",           "Ice" : "Gêlo",           "Rock" : "Rocha",           "Space" : "Espaço",           "Terrain" : "Terreno",           "Terrest" : "Terrestre",           "Water" : "Água",           "BattleCalculatorContent" : "Cá em baixo tens a calculadora. Este utilitário permite-te saber quando dano é que a unidade seleccionada consegue  fazer em cada uma das unidades inimigas.",          "BattleContent" : "É a tua vez de jogar na batalha. Tu tens as tuas unidades na parte de baixo, e podes ver as unidades do teu adversário na  parte de cima. Elas têm um fundo vermelho.",           "BattleDeployContent" : "A parte inicial de uma batalha é o posicionamento. É aqui que tu moves as unidades de combate da tua armada  e as colocas no tabuleiro de batalha. Podes colocá-las em qualquer quadrado das duas primeiras linhas, e o teu adversário  fará o mesmo.",          "BattleDeployDropContent" : "Agora, clicka num quadrado qualquer das duas primeiras linhas para colocares a unidade.",          "BattleDeployDropNextContent" : "Isso! Agora só precisavas de fazer o mesmo para todas as unidades na tua armada, e assim conseguirias concluir  o posicionamento. Nota que podes seleccionar uma unidade e alterar a quantidade a mover (aqui à direita). Dessa  forma consegues posicionar vários grupos da mesma unidade.",          "BattleDeployFinishContent" : "Quando acabares de posicionar todas as unidades, clicka no botão 'Posicionar'. Depois terás de esperar a tua vez de jogar,  e nessa altura haverá outro tutorial para te auxiliar.",          "BattleDeploySelectContent" : "Vamos começar por seleccionar uma unidade da tua armada. Cá em baixo tens todas as unidades de combate disponíveis  para a batalha. Por favor clicka numa delas para continuarmos o tutorial.",          "BattleDeployTutorial" : "Tutorial de Posicionamento na Batalha",           "BattleOptionsContent" : "Já tens todo o conhecimento necessário para fazer as tuas jogadas. Quando acabares, tens de clickar em 'Acabar Turno' e então  esperar pela jogada do teu adversário. Neste painel também podes cancelar um movimento ou fazer reset e recomeçar a jogada.  <p />  Boas batalhas!",          "BattleSelectContent" : "Por favor selecciona uma das tuas unidades para prosseguir com o tutorial...",            "BattleTutorial" : "Tutorial da Batalha",             "BattleUnitDirectionContent" : "Também podes rodar a unidade seleccionada, o que também custa 1 ponto de movimento.",           "BattleUnitSelectedAttackContent" : "Este painel ilustra como atacar. Nota que cada unidade tem um alcance de ataque. Mas há unidades que também têm habilidades especiais,  como ataque catapulta, ataque triplo, etc. Deves ver a página do manual da unidade para perceber exactamente o que ela é capaz de  fazer.",          "BattleUnitSelectedContent" : "Neste painel podes ver as características da unidade. Podes ver o ataque e defesa, quantidade, custo de movimento  e alcance de ataque.",          "BattleUnitSelectedMovContent" : "E este painel mostra como a unidade se move. Cada unidade tem um tipo de movimento: normal, total, em frente, diagonal, etc. Nota que  mover a unidade tem um custo, e tu tens 6 pontos de movimento para gastar. Portanto, podes usá-los para mover várias vezes a mesma  unidade no teu turno.",          "BattleUnitSelectedMovPoints2Content" : "... e este valor foi decrementado com o custo de movimento da unidade seleccionada. Tu podes movê-la novamente se ainda tiveres  mais pontos. Ou podes fazer outras acções. Por exemplo, atacar uma unidade inimiga custa 1 ponto de movimento. Tu podes mover  e atacar no mesmo turno.",          "BattleUnitSelectedMovPointsContent" : "E aqui estão os pontos de movimento que tens para gastar no teu turno. Como podes ver, tens os 6 pontos. Agora move a unidade  seleccionada para continuar o tutorial...",          "BattleUnitSelectedStrongContent" : "Este painel mostra as unidades presentes na batalha que são especialmente vulneráveis a levar dano da unidade seleccionada.  Deves usar a unidade seleccionada para atacar as unidades do adversário que estejam nesta lista.",          "BattleUnitSelectedWeakContent" : "Por outro lado, a unidade seleccionada pode ser especialmente fraca contra algumas do adversário. Convém protegeres a  unidade seleccionada daquelas que estão nesta lista.",          "BattleUnitSplitContent" : "Quando moves uma unidade podes alterar a quantidade a mover, a dividir o grupo. Nota que separar um grupo em dois custa  o dobro dos pontos de movimento de mover a unidade.",          "BuildFacilityActionContent" : "Agora vamos construir um edifício. Clicka no botão de 'Construir' para o começar.",          "BuildFacilityContent" : "Esta é uma zona de construção, onde podes construir um edifício. Tens várias zonas de construção disponíveis para  construir. Clicka nesta zona para construir um edifício...",          "BuildFacilityScreenContent" : "... como podes ver, depois do click na zona de construção (ou num edifício já construído), vens para a página de  de construção/evolução. Nesta página podes escolher o que construir naquela zona.",          "HomePlanetContent" : "Este é um deles: o teu Planeta Mãe. Este já se encontra colonizado por ti. Podes aceder-lhe e geri-lo mais tarde  clickando nele e seleccionando 'Ver Planeta', ou seleccionando 'Planetas' no menu de topo.",          "HomeTutorial" : "Tutorial da tua Página Principal",           "HomeTutorialContent" : "A tua Página Principal é onde és notificado de tudo o que se passa no teu império. Nesta zona tens as tuas  mensagens e interacções com outros jogadores.",          "HomeTutorialContent2" : "Nesta zona tens uma amostra do que se encontra a ser comercializado na Casa de Leilões.",           "HomeTutorialContentCharts" : "Aqui encontram-se gráficos que demonstram a tua evolução no jogo. Estes gráficos são actualizados  periodicamente.",          "IncomeContent" : "Esta é a produção do planeta actual. Como podes ver, já tens alguma produção que é dada pelo teu edifício mãe.  Agora precisas de construir outros edifícios para aumentar esta produção.",          "LHBuildingInConstructionContent" : "E agora tens aquele edífício a ser construído. Estará completo dentro de minutos.",          "LHGoToFleetsContent" : "Agora já sabes como construir (e evoluir, que é feito da mesma forma) edifícios nos teus planetas.  De seguida vamos ver como podes gerir Armadas. Por favor clicka no link 'Armadas'.",          "MainFacilityContent" : "Este é o teu edifício mãe, o centro de pesquisa do teu império. Todos os edifícios e unidades de combate dependem  directa ou indirectamente do nível do teu edifício mãe.",           "MoveFleetContent" : "Há muitos recursos perdidos pelo universo. Tu podes mover a tua armada para a posição deles para que eles passem para a  carga dela. Para mover a armada, clicka em cima dela para a seleccionar. De seguida click noutra posição no universo, e  ela começará a mover-se para lá.",          "MoveUnitsFromFleetsContent" : "Quando tens mais que uma armada nesta página, será possível mover unidades de combate de uma armada  para outra. Para o fazer, clicka na unidade pretendida e arrasta-a para a outra fleet. Depois de mover  todas as unidades, não te esqueças de guardar as alterações.",          "Next" : "Próxima »",           "NoTutorial" : "Ainda sem Tutorial",           "NoTutorialContent" : "Ainda não fizemos o tutorial desta página. Se quiseres, podes contactar-nos e partilhar  as tuas dificuldades e ideias. Assim será mais fácil para nós fazer este tutorial.",           "OnFleetsScreenContent" : "É nesta página que podes criar e gerir as tuas armadas. Tens a armada de defesa do planeta, que  é somente usada como repositório e para defesa. Também vais ver nesta página outras armadas  que tenhas em órbita deste planeta.",          "PageTutorial" : "Página Passo a Passo",           "PlanetsTutorial" : "Tutorial dos Planetas",           "PlanetsTutorialContent" : "Este tutorial vai apresentar a interface dos planetas e ensinar todos os conceitos básicos.  <p />  Os teus planetas geram recursos e permitem-te a construção de unidades de combate. Eles são o coração financeiro  do teu império.",          "Previous" : "Anterior",           "PrivateZoneTutorial" : "Tutorial da Zona Privada",           "PrivateZoneTutorialContent" : "Esta é a tua zona privada no universo. Somente tu consegues aceder a esta zona. Na tua zona privada  tens cinco planetas para colonizar.",          "QuestsTaskContent" : "Agora tens um novo tipo de missão: a Tarefa. Estas missões são diferentes porque as tens de aceitar primeiro, depois fazer  as acções definidas, e só então entregar a quest e obter a tua recompensa.",          "QuestsTutorial" : "Tutorial das Missões",           "QuestsTutorialContent" : "Nesta página tens várias missões para seguir, que te vão ajudar a evoluir no jogo mais rapidamente. Neste momento  só tens <i>missões de meta</i>, só precisas de seguir a sua descrição para as entregares e obteres a tua recompensa!",         "RegicideDeployContent" : "Esta é uma batalha de Regicídio! Neste tipo de batalha o objectivo é eliminar a Bandeira adversária.  Preocupa-te também em proteger a tua Bandeira! A Bandeira é a seguinte unidade:  <p /><img src='http://resources.orionsbelt.eu/Images/Common/Units/Flag.png' />",          "ResourcesPanelContent" : "Cá em cima tens os teus recursos actuais. De tempos a tempos eles são actualizados com base na produção dos teus planetas.",          "Top" : "Topo",           "TutorialEnd" : "Tutorial Completo",           "TutorialEndContent" : "E pronto! Contacta-nos se tiveres outras dificuldades. Podes sempre voltar a ver  este tutorial seguindo o link <i>Página Passo a Passo</i> no rodapé.",          "YourFirstFleetContent" : "Nesta posição começas com uma armada. Tu começas o jogo com uma armada exploradora para descobrires a tua zona privada.  Mais tarde poderás criar mais armadas nos teus planetas.",  "Generated" : "19-04-2012 10:08:54"};
var MooTools={version:"1.2.0",build:""};var Native=function(l){l=l||{};var g=l.afterImplement||function(){};var h=l.generics;h=(h!==false);var j=l.legacy;var f=l.initialize;var c=l.protect;var b=l.name;var d=f||j;d.constructor=Native;d.$family={name:"native"};if(j&&f){d.prototype=j.prototype;}d.prototype.constructor=d;if(b){var e=b.toLowerCase();d.prototype.$family={name:e};Native.typize(d,e);}var k=function(p,n,q,o){if(!c||o||!p.prototype[n]){p.prototype[n]=q;}if(h){Native.genericize(p,n,c);}g.call(p,n,q);return p;};d.implement=function(o,n,r){if(typeof o=="string"){return k(this,o,n,r);}for(var q in o){k(this,q,o[q],n);}return this;};d.alias=function(p,n,q){if(typeof p=="string"){p=this.prototype[p];if(p){k(this,n,p,q);}}else{for(var o in p){this.alias(o,p[o],n);}}return this;};return d;};Native.implement=function(e,d){for(var c=0,b=e.length;c<b;c++){e[c].implement(d);}};Native.genericize=function(c,d,b){if((!b||!c[d])&&typeof c.prototype[d]=="function"){c[d]=function(){var e=Array.prototype.slice.call(arguments);return c.prototype[d].apply(e.shift(),e);};}};Native.typize=function(b,c){if(!b.type){b.type=function(d){return($type(d)===c);};}};Native.alias=function(f,c,b,g){for(var e=0,d=f.length;e<d;e++){f[e].alias(c,b,g);}};(function(c){for(var b in c){Native.typize(c[b],b);}})({"boolean":Boolean,"native":Native,object:Object});(function(c){for(var b in c){new Native({name:b,initialize:c[b],protect:true});}})({String:String,Function:Function,Number:Number,Array:Array,RegExp:RegExp,Date:Date});(function(c,b){for(var d=b.length;d--;d){Native.genericize(c,b[d],true);}return arguments.callee;})(Array,["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice","toString","valueOf","indexOf","lastIndexOf"])(String,["charAt","charCodeAt","concat","indexOf","lastIndexOf","match","replace","search","slice","split","substr","substring","toLowerCase","toUpperCase","valueOf"]);function $chk(b){return !!(b||b===0);}function $clear(b){clearTimeout(b);clearInterval(b);return null;}function $defined(b){return(b!=undefined);}function $empty(){}function $arguments(b){return function(){return arguments[b];};}function $lambda(b){return(typeof b=="function")?b:function(){return b;};}function $extend(d,b){for(var c in (b||{})){d[c]=b[c];}return d;}function $unlink(d){var c;switch($type(d)){case"object":c={};for(var f in d){c[f]=$unlink(d[f]);}break;case"hash":c=$unlink(d.getClean());break;case"array":c=[];for(var e=0,b=d.length;e<b;e++){c[e]=$unlink(d[e]);}break;default:return d;}return c;}function $merge(){var f={};for(var e=0,b=arguments.length;e<b;e++){var c=arguments[e];if($type(c)!="object"){continue;}for(var d in c){var h=c[d],g=f[d];f[d]=(g&&$type(h)=="object"&&$type(g)=="object")?$merge(g,h):$unlink(h);}}return f;}function $pick(){for(var c=0,b=arguments.length;c<b;c++){if(arguments[c]!=undefined){return arguments[c];}}return null;}function $random(c,b){return Math.floor(Math.random()*(b-c+1)+c);}function $splat(c){var b=$type(c);return(b)?((b!="array"&&b!="arguments")?[c]:c):[];}var $time=Date.now||function(){return new Date().getTime();};function $try(){for(var c=0,b=arguments.length;c<b;c++){try{return arguments[c]();}catch(d){}}return null;}function $type(b){if(b==undefined){return false;}if(b.$family){return(b.$family.name=="number"&&!isFinite(b))?false:b.$family.name;}if(b.nodeName){switch(b.nodeType){case 1:return"element";case 3:return(/\S/).test(b.nodeValue)?"textnode":"whitespace";}}else{if(typeof b.length=="number"){if(b.callee){return"arguments";}else{if(b.item){return"collection";}}}}return typeof b;}var Hash=new Native({name:"Hash",initialize:function(b){if($type(b)=="hash"){b=$unlink(b.getClean());}for(var c in b){this[c]=b[c];}return this;}});Hash.implement({getLength:function(){var c=0;for(var b in this){if(this.hasOwnProperty(b)){c++;}}return c;},forEach:function(c,d){for(var b in this){if(this.hasOwnProperty(b)){c.call(d,this[b],b,this);}}},getClean:function(){var c={};for(var b in this){if(this.hasOwnProperty(b)){c[b]=this[b];}}return c;}});Hash.alias("forEach","each");function $H(b){return new Hash(b);}Array.implement({forEach:function(d,e){for(var c=0,b=this.length;c<b;c++){d.call(e,this[c],c,this);}}});Array.alias("forEach","each");function $A(d){if(d.item){var e=[];for(var c=0,b=d.length;c<b;c++){e[c]=d[c];}return e;}return Array.prototype.slice.call(d);}function $each(d,c,e){var b=$type(d);((b=="arguments"||b=="collection"||b=="array")?Array:Hash).each(d,c,e);}var Browser=new Hash({Engine:{name:"unknown",version:""},Platform:{name:(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase()},Features:{xpath:!!(document.evaluate),air:!!(window.runtime)},Plugins:{}});if(window.opera){Browser.Engine={name:"presto",version:(document.getElementsByClassName)?950:925};}else{if(window.ActiveXObject){Browser.Engine={name:"trident",version:(window.XMLHttpRequest)?5:4};}else{if(!navigator.taintEnabled){Browser.Engine={name:"webkit",version:(Browser.Features.xpath)?420:419};}else{if(document.getBoxObjectFor!=null){Browser.Engine={name:"gecko",version:(document.getElementsByClassName)?19:18};}}}}Browser.Engine[Browser.Engine.name]=Browser.Engine[Browser.Engine.name+Browser.Engine.version]=true;if(window.orientation!=undefined){Browser.Platform.name="ipod";}Browser.Platform[Browser.Platform.name]=true;Browser.Request=function(){return $try(function(){return new XMLHttpRequest();},function(){return new ActiveXObject("MSXML2.XMLHTTP");});};Browser.Features.xhr=!!(Browser.Request());Browser.Plugins.Flash=(function(){var b=($try(function(){return navigator.plugins["Shockwave Flash"].description;},function(){return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version");})||"0 r0").match(/\d+/g);return{version:parseInt(b[0]||0+"."+b[1]||0),build:parseInt(b[2]||0)};})();function $exec(c){if(!c){return c;}if(window.execScript){window.execScript(c);}else{var b=document.createElement("script");b.setAttribute("type","text/javascript");b.text=c;document.head.appendChild(b);document.head.removeChild(b);}return c;}Native.UID=1;var $uid=(Browser.Engine.trident)?function(b){return(b.uid||(b.uid=[Native.UID++]))[0];}:function(b){return b.uid||(b.uid=Native.UID++);};var Window=new Native({name:"Window",legacy:(Browser.Engine.trident)?null:window.Window,initialize:function(b){$uid(b);if(!b.Element){b.Element=$empty;if(Browser.Engine.webkit){b.document.createElement("iframe");}b.Element.prototype=(Browser.Engine.webkit)?window["[[DOMElement.prototype]]"]:{};}return $extend(b,Window.Prototype);},afterImplement:function(c,b){window[c]=Window.Prototype[c]=b;}});Window.Prototype={$family:{name:"window"}};new Window(window);var Document=new Native({name:"Document",legacy:(Browser.Engine.trident)?null:window.Document,initialize:function(b){$uid(b);b.head=b.getElementsByTagName("head")[0];b.html=b.getElementsByTagName("html")[0];b.window=b.defaultView||b.parentWindow;if(Browser.Engine.trident4){$try(function(){b.execCommand("BackgroundImageCache",false,true);});}return $extend(b,Document.Prototype);},afterImplement:function(c,b){document[c]=Document.Prototype[c]=b;}});Document.Prototype={$family:{name:"document"}};new Document(document);Array.implement({every:function(d,e){for(var c=0,b=this.length;c<b;c++){if(!d.call(e,this[c],c,this)){return false;}}return true;},filter:function(e,f){var d=[];for(var c=0,b=this.length;c<b;c++){if(e.call(f,this[c],c,this)){d.push(this[c]);}}return d;},clean:function(){return this.filter($defined);},indexOf:function(d,e){var b=this.length;for(var c=(e<0)?Math.max(0,b+e):e||0;c<b;c++){if(this[c]===d){return c;}}return -1;},map:function(e,f){var d=[];for(var c=0,b=this.length;c<b;c++){d[c]=e.call(f,this[c],c,this);}return d;},some:function(d,e){for(var c=0,b=this.length;c<b;c++){if(d.call(e,this[c],c,this)){return true;}}return false;},associate:function(d){var e={},c=Math.min(this.length,d.length);for(var b=0;b<c;b++){e[d[b]]=this[b];}return e;},link:function(d){var b={};for(var f=0,c=this.length;f<c;f++){for(var e in d){if(d[e](this[f])){b[e]=this[f];delete d[e];break;}}}return b;},contains:function(b,c){return this.indexOf(b,c)!=-1;},extend:function(d){for(var c=0,b=d.length;c<b;c++){this.push(d[c]);}return this;},getLast:function(){return(this.length)?this[this.length-1]:null;},getRandom:function(){return(this.length)?this[$random(0,this.length-1)]:null;},include:function(b){if(!this.contains(b)){this.push(b);}return this;},combine:function(d){for(var c=0,b=d.length;c<b;c++){this.include(d[c]);}return this;},erase:function(c){for(var b=this.length;b--;b){if(this[b]===c){this.splice(b,1);}}return this;},empty:function(){this.length=0;return this;},flatten:function(){var e=[];for(var c=0,b=this.length;c<b;c++){var d=$type(this[c]);if(!d){continue;}e=e.concat((d=="array"||d=="collection"||d=="arguments")?Array.flatten(this[c]):this[c]);}return e;},hexToRgb:function(c){if(this.length!=3){return null;}var b=this.map(function(d){if(d.length==1){d+=d;}return d.toInt(16);});return(c)?b:"rgb("+b+")";},rgbToHex:function(e){if(this.length<3){return null;}if(this.length==4&&this[3]==0&&!e){return"transparent";}var c=[];for(var b=0;b<3;b++){var d=(this[b]-0).toString(16);c.push((d.length==1)?"0"+d:d);}return(e)?c:"#"+c.join("");}});Function.implement({extend:function(b){for(var c in b){this[c]=b[c];}return this;},create:function(c){var b=this;c=c||{};return function(e){var d=c.arguments;d=(d!=undefined)?$splat(d):Array.slice(arguments,(c.event)?1:0);if(c.event){d=[e||window.event].extend(d);}var f=function(){return b.apply(c.bind||null,d);};if(c.delay){return setTimeout(f,c.delay);}if(c.periodical){return setInterval(f,c.periodical);}if(c.attempt){return $try(f);}return f();};},pass:function(b,c){return this.create({arguments:b,bind:c});},attempt:function(b,c){return this.create({arguments:b,bind:c,attempt:true})();},bind:function(c,b){return this.create({bind:c,arguments:b});},bindWithEvent:function(c,b){return this.create({bind:c,event:true,arguments:b});},delay:function(c,d,b){return this.create({delay:c,bind:d,arguments:b})();},periodical:function(b,d,c){return this.create({periodical:b,bind:d,arguments:c})();},run:function(b,c){return this.apply(c,$splat(b));}});Number.implement({limit:function(c,b){return Math.min(b,Math.max(c,this));},round:function(b){b=Math.pow(10,b||0);return Math.round(this*b)/b;},times:function(c,d){for(var b=0;b<this;b++){c.call(d,b,this);}},toFloat:function(){return parseFloat(this);},toInt:function(b){return parseInt(this,b||10);}});Number.alias("times","each");(function(c){var b={};c.each(function(d){if(!Number[d]){b[d]=function(){return Math[d].apply(null,[this].concat($A(arguments)));};}});Number.implement(b);})(["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","sin","sqrt","tan"]);String.implement({test:function(b,c){return((typeof b=="string")?new RegExp(b,c):b).test(this);},contains:function(b,c){return(c)?(c+this+c).indexOf(c+b+c)>-1:this.indexOf(b)>-1;},trim:function(){return this.replace(/^\s+|\s+$/g,"");},clean:function(){return this.replace(/\s+/g," ").trim();},camelCase:function(){return this.replace(/-\D/g,function(b){return b.charAt(1).toUpperCase();});},hyphenate:function(){return this.replace(/[A-Z]/g,function(b){return("-"+b.charAt(0).toLowerCase());});},capitalize:function(){return this.replace(/\b[a-z]/g,function(b){return b.toUpperCase();});},escapeRegExp:function(){return this.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1");},toInt:function(b){return parseInt(this,b||10);},toFloat:function(){return parseFloat(this);},hexToRgb:function(c){var b=this.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);return(b)?b.slice(1).hexToRgb(c):null;},rgbToHex:function(c){var b=this.match(/\d{1,3}/g);return(b)?b.rgbToHex(c):null;},stripScripts:function(c){var b="";var d=this.replace(/<script[^>]*>([\s\S]*?)<\/script>/gi,function(){b+=arguments[1]+"\n";return"";});if(c===true){$exec(b);}else{if($type(c)=="function"){c(b,d);}}return d;},substitute:function(b,c){return this.replace(c||(/\\?\{([^}]+)\}/g),function(e,d){if(e.charAt(0)=="\\"){return e.slice(1);}return(b[d]!=undefined)?b[d]:"";});}});Hash.implement({has:Object.prototype.hasOwnProperty,keyOf:function(c){for(var b in this){if(this.hasOwnProperty(b)&&this[b]===c){return b;}}return null;},hasValue:function(b){return(Hash.keyOf(this,b)!==null);},extend:function(b){Hash.each(b,function(d,c){Hash.set(this,c,d);},this);return this;},combine:function(b){Hash.each(b,function(d,c){Hash.include(this,c,d);},this);return this;},erase:function(b){if(this.hasOwnProperty(b)){delete this[b];}return this;},get:function(b){return(this.hasOwnProperty(b))?this[b]:null;},set:function(b,c){if(!this[b]||this.hasOwnProperty(b)){this[b]=c;}return this;},empty:function(){Hash.each(this,function(c,b){delete this[b];},this);return this;},include:function(c,d){var b=this[c];if(b==undefined){this[c]=d;}return this;},map:function(c,d){var b=new Hash;Hash.each(this,function(f,e){b.set(e,c.call(d,f,e,this));},this);return b;},filter:function(c,d){var b=new Hash;Hash.each(this,function(f,e){if(c.call(d,f,e,this)){b.set(e,f);}},this);return b;},every:function(c,d){for(var b in this){if(this.hasOwnProperty(b)&&!c.call(d,this[b],b)){return false;}}return true;},some:function(c,d){for(var b in this){if(this.hasOwnProperty(b)&&c.call(d,this[b],b)){return true;}}return false;},getKeys:function(){var b=[];Hash.each(this,function(d,c){b.push(c);});return b;},getValues:function(){var b=[];Hash.each(this,function(c){b.push(c);});return b;},toQueryString:function(b){var c=[];Hash.each(this,function(g,f){if(b){f=b+"["+f+"]";}var e;switch($type(g)){case"object":e=Hash.toQueryString(g,f);break;case"array":var d={};g.each(function(j,h){d[h]=j;});e=Hash.toQueryString(d,f);break;default:e=f+"="+encodeURIComponent(g);}if(g!=undefined){c.push(e);}});return c.join("&");}});Hash.alias({keyOf:"indexOf",hasValue:"contains"});var Event=new Native({name:"Event",initialize:function(b,g){g=g||window;var n=g.document;b=b||g.event;if(b.$extended){return b;}this.$extended=true;var l=b.type;var h=b.target||b.srcElement;while(h&&h.nodeType==3){h=h.parentNode;}if(l.test(/key/)){var c=b.which||b.keyCode;var p=Event.Keys.keyOf(c);if(l=="keydown"){var e=c-111;if(e>0&&e<13){p="f"+e;}}p=p||String.fromCharCode(c).toLowerCase();}else{if(l.match(/(click|mouse|menu)/i)){n=(!n.compatMode||n.compatMode=="CSS1Compat")?n.html:n.body;var k={x:b.pageX||b.clientX+n.scrollLeft,y:b.pageY||b.clientY+n.scrollTop};var d={x:(b.pageX)?b.pageX-g.pageXOffset:b.clientX,y:(b.pageY)?b.pageY-g.pageYOffset:b.clientY};if(l.match(/DOMMouseScroll|mousewheel/)){var j=(b.wheelDelta)?b.wheelDelta/120:-(b.detail||0)/3;}var f=(b.which==3)||(b.button==2);var o=null;if(l.match(/over|out/)){switch(l){case"mouseover":o=b.relatedTarget||b.fromElement;break;case"mouseout":o=b.relatedTarget||b.toElement;}if(!(function(){while(o&&o.nodeType==3){o=o.parentNode;}return true;}).create({attempt:Browser.Engine.gecko})()){o=false;}}}}return $extend(this,{event:b,type:l,page:k,client:d,rightClick:f,wheel:j,relatedTarget:o,target:h,code:c,key:p,shift:b.shiftKey,control:b.ctrlKey,alt:b.altKey,meta:b.metaKey});}});Event.Keys=new Hash({enter:13,up:38,down:40,left:37,right:39,esc:27,space:32,backspace:8,tab:9,"delete":46});Event.implement({stop:function(){return this.stopPropagation().preventDefault();},stopPropagation:function(){if(this.event.stopPropagation){this.event.stopPropagation();}else{this.event.cancelBubble=true;}return this;},preventDefault:function(){if(this.event.preventDefault){this.event.preventDefault();}else{this.event.returnValue=false;}return this;}});var Class=new Native({name:"Class",initialize:function(c){c=c||{};var b=function(f){for(var e in this){this[e]=$unlink(this[e]);}for(var g in Class.Mutators){if(!this[g]){continue;}Class.Mutators[g](this,this[g]);delete this[g];}this.constructor=b;if(f===$empty){return this;}var d=(this.initialize)?this.initialize.apply(this,arguments):this;if(this.options&&this.options.initialize){this.options.initialize.call(this);}return d;};$extend(b,this);b.constructor=Class;b.prototype=c;return b;}});Class.implement({implement:function(){Class.Mutators.Implements(this.prototype,Array.slice(arguments));return this;}});Class.Mutators={Implements:function(b,c){$splat(c).each(function(d){$extend(b,($type(d)=="class")?new d($empty):d);});},Extends:function(self,klass){var instance=new klass($empty);delete instance.parent;delete instance.parentOf;for(var key in instance){var current=self[key],previous=instance[key];if(current==undefined){self[key]=previous;continue;}var ctype=$type(current),ptype=$type(previous);if(ctype!=ptype){continue;}switch(ctype){case"function":if(!arguments.callee.caller){self[key]=eval("("+String(current).replace(/\bthis\.parent\(\s*(\))?/g,function(full,close){return"arguments.callee._parent_.call(this"+(close||", ");})+")");}self[key]._parent_=previous;break;case"object":self[key]=$merge(previous,current);}}self.parent=function(){return arguments.callee.caller._parent_.apply(this,arguments);};self.parentOf=function(descendant){return descendant._parent_.apply(this,Array.slice(arguments,1));};}};var Chain=new Class({chain:function(){this.$chain=(this.$chain||[]).extend(arguments);return this;},callChain:function(){return(this.$chain&&this.$chain.length)?this.$chain.shift().apply(this,arguments):false;},clearChain:function(){if(this.$chain){this.$chain.empty();}return this;}});var Events=new Class({addEvent:function(d,c,b){d=Events.removeOn(d);if(c!=$empty){this.$events=this.$events||{};this.$events[d]=this.$events[d]||[];this.$events[d].include(c);if(b){c.internal=true;}}return this;},addEvents:function(b){for(var c in b){this.addEvent(c,b[c]);}return this;},fireEvent:function(d,c,b){d=Events.removeOn(d);if(!this.$events||!this.$events[d]){return this;}this.$events[d].each(function(e){e.create({bind:this,delay:b,"arguments":c})();},this);return this;},removeEvent:function(c,b){c=Events.removeOn(c);if(!this.$events||!this.$events[c]){return this;}if(!b.internal){this.$events[c].erase(b);}return this;},removeEvents:function(d){for(var f in this.$events){if(d&&d!=f){continue;}var c=this.$events[f];for(var b=c.length;b--;b){this.removeEvent(f,c[b]);}}return this;}});Events.removeOn=function(b){return b.replace(/^on([A-Z])/,function(c,d){return d.toLowerCase();});};var Options=new Class({setOptions:function(){this.options=$merge.run([this.options].extend(arguments));if(!this.addEvent){return this;}for(var b in this.options){if($type(this.options[b])!="function"||!(/^on[A-Z]/).test(b)){continue;}this.addEvent(b,this.options[b]);delete this.options[b];}return this;}});Document.implement({newElement:function(b,c){if(Browser.Engine.trident&&c){["name","type","checked"].each(function(d){if(!c[d]){return;}b+=" "+d+'="'+c[d]+'"';if(d!="checked"){delete c[d];}});b="<"+b+">";}return $.element(this.createElement(b)).set(c);},newTextNode:function(b){return this.createTextNode(b);},getDocument:function(){return this;},getWindow:function(){return this.defaultView||this.parentWindow;},purge:function(){var d=this.getElementsByTagName("*");for(var c=0,b=d.length;c<b;c++){Browser.freeMem(d[c]);}}});var Element=new Native({name:"Element",legacy:window.Element,initialize:function(b,c){var d=Element.Constructors.get(b);if(d){return d(c);}if(typeof b=="string"){return document.newElement(b,c);}return $(b).set(c);},afterImplement:function(b,c){if(!Array[b]){Elements.implement(b,Elements.multi(b));}Element.Prototype[b]=c;}});Element.Prototype={$family:{name:"element"}};Element.Constructors=new Hash;var IFrame=new Native({name:"IFrame",generics:false,initialize:function(){var f=Array.link(arguments,{properties:Object.type,iframe:$defined});var d=f.properties||{};var c=$(f.iframe)||false;var e=d.onload||$empty;delete d.onload;d.id=d.name=$pick(d.id,d.name,c.id,c.name,"IFrame_"+$time());c=new Element(c||"iframe",d);var b=function(){var g=$try(function(){return c.contentWindow.location.host;});if(g&&g==window.location.host){var j=new Window(c.contentWindow);var h=new Document(c.contentWindow.document);$extend(j.Element.prototype,Element.Prototype);}e.call(c.contentWindow,c.contentWindow.document);};(!window.frames[d.id])?c.addListener("load",b):b();return c;}});var Elements=new Native({initialize:function(g,c){c=$extend({ddup:true,cash:true},c);g=g||[];if(c.ddup||c.cash){var h={},f=[];for(var d=0,b=g.length;d<b;d++){var e=$.element(g[d],!c.cash);if(c.ddup){if(h[e.uid]){continue;}h[e.uid]=true;}f.push(e);}g=f;}return(c.cash)?$extend(g,this):g;}});Elements.implement({filter:function(b,c){if(!b){return this;}return new Elements(Array.filter(this,(typeof b=="string")?function(d){return d.match(b);}:b,c));}});Elements.multi=function(b){return function(){var c=[];var g=true;for(var e=0,d=this.length;e<d;e++){var f=this[e][b].apply(this[e],arguments);c.push(f);if(g){g=($type(f)=="element");}}return(g)?new Elements(c):c;};};Window.implement({$:function(c,d){if(c&&c.$family&&c.uid){return c;}var b=$type(c);return($[b])?$[b](c,d,this.document):null;},$$:function(b){if(arguments.length==1&&typeof b=="string"){return this.document.getElements(b);}var g=[];var d=Array.flatten(arguments);for(var e=0,c=d.length;e<c;e++){var f=d[e];switch($type(f)){case"element":f=[f];break;case"string":f=this.document.getElements(f,true);break;default:f=false;}if(f){g.extend(f);}}return new Elements(g);},getDocument:function(){return this.document;},getWindow:function(){return this;}});$.string=function(d,c,b){d=b.getElementById(d);return(d)?$.element(d,c):null;};$.element=function(b,e){$uid(b);if(!e&&!b.$family&&!(/^object|embed$/i).test(b.tagName)){var c=Element.Prototype;for(var d in c){b[d]=c[d];}}return b;};$.object=function(c,d,b){if(c.toElement){return $.element(c.toElement(b),d);}return null;};$.textnode=$.whitespace=$.window=$.document=$arguments(0);Native.implement([Element,Document],{getElement:function(b,c){return $(this.getElements(b,true)[0]||null,c);},getElements:function(b,e){b=b.split(",");var d=[];var c=(b.length>1);b.each(function(f){var g=this.getElementsByTagName(f.trim());(c)?d.extend(g):d=g;},this);return new Elements(d,{ddup:c,cash:!e});}});Element.Storage={get:function(b){return(this[b]||(this[b]={}));}};Element.Inserters=new Hash({before:function(c,b){if(b.parentNode){b.parentNode.insertBefore(c,b);}},after:function(c,b){if(!b.parentNode){return;}var d=b.nextSibling;(d)?b.parentNode.insertBefore(c,d):b.parentNode.appendChild(c);},bottom:function(c,b){b.appendChild(c);},top:function(c,b){var d=b.firstChild;(d)?b.insertBefore(c,d):b.appendChild(c);}});Element.Inserters.inside=Element.Inserters.bottom;Element.Inserters.each(function(d,c){var b=c.capitalize();Element.implement("inject"+b,function(e){d(this,$(e,true));return this;});Element.implement("grab"+b,function(e){d($(e,true),this);return this;});});Element.implement({getDocument:function(){return this.ownerDocument;},getWindow:function(){return this.ownerDocument.getWindow();},getElementById:function(e,d){var c=this.ownerDocument.getElementById(e);if(!c){return null;}for(var b=c.parentNode;b!=this;b=b.parentNode){if(!b){return null;}}return $.element(c,d);},set:function(e,c){switch($type(e)){case"object":for(var d in e){this.set(d,e[d]);}break;case"string":var b=Element.Properties.get(e);(b&&b.set)?b.set.apply(this,Array.slice(arguments,1)):this.setProperty(e,c);}return this;},get:function(c){var b=Element.Properties.get(c);return(b&&b.get)?b.get.apply(this,Array.slice(arguments,1)):this.getProperty(c);},erase:function(c){var b=Element.Properties.get(c);(b&&b.erase)?b.erase.apply(this,Array.slice(arguments,1)):this.removeProperty(c);return this;},match:function(b){return(!b||Element.get(this,"tag")==b);},inject:function(c,b){Element.Inserters.get(b||"bottom")(this,$(c,true));return this;},wraps:function(c,b){c=$(c,true);return this.replaces(c).grab(c,b);},grab:function(c,b){Element.Inserters.get(b||"bottom")($(c,true),this);return this;},appendText:function(c,b){return this.grab(this.getDocument().newTextNode(c),b);},adopt:function(){Array.flatten(arguments).each(function(b){b=$(b,true);if(b){this.appendChild(b);}},this);return this;},dispose:function(){return(this.parentNode)?this.parentNode.removeChild(this):this;},clone:function(e,d){switch($type(this)){case"element":var n={};for(var h=0,f=this.attributes.length;h<f;h++){var c=this.attributes[h],r=c.nodeName.toLowerCase();if(Browser.Engine.trident&&(/input/i).test(this.tagName)&&(/width|height/).test(r)){continue;}var q=(r=="style"&&this.style)?this.style.cssText:c.nodeValue;if(!$chk(q)||r=="uid"||(r=="id"&&!d)){continue;}if(q!="inherit"&&["string","number"].contains($type(q))){n[r]=q;}}var p=new Element(this.nodeName.toLowerCase(),n);if(e!==false){for(var o=0,g=this.childNodes.length;o<g;o++){var b=Element.clone(this.childNodes[o],true,d);if(b){p.grab(b);}}}return p;case"textnode":return document.newTextNode(this.nodeValue);}return null;},replaces:function(b){b=$(b,true);b.parentNode.replaceChild(this,b);return this;},hasClass:function(b){return this.className.contains(b," ");},addClass:function(b){if(!this.hasClass(b)){this.className=(this.className+" "+b).clean();}return this;},removeClass:function(b){this.className=this.className.replace(new RegExp("(^|\\s)"+b+"(?:\\s|$)"),"$1").clean();return this;},toggleClass:function(b){return this.hasClass(b)?this.removeClass(b):this.addClass(b);},getComputedStyle:function(c){if(this.currentStyle){return this.currentStyle[c.camelCase()];}var b=this.getWindow().getComputedStyle(this,null);return(b)?b.getPropertyValue([c.hyphenate()]):null;},empty:function(){$A(this.childNodes).each(function(b){Browser.freeMem(b);Element.empty(b);Element.dispose(b);},this);return this;},destroy:function(){Browser.freeMem(this.empty().dispose());return null;},getSelected:function(){return new Elements($A(this.options).filter(function(b){return b.selected;}));},toQueryString:function(){var b=[];this.getElements("input, select, textarea").each(function(c){if(!c.name||c.disabled){return;}var d=(c.tagName.toLowerCase()=="select")?Element.getSelected(c).map(function(e){return e.value;}):((c.type=="radio"||c.type=="checkbox")&&!c.checked)?null:c.value;$splat(d).each(function(e){if(e){b.push(c.name+"="+encodeURIComponent(e));}});});return b.join("&");},getProperty:function(d){var c=Element.Attributes,b=c.Props[d];var e=(b)?this[b]:this.getAttribute(d,2);return(c.Bools[d])?!!e:(b)?e:e||null;},getProperties:function(){var b=$A(arguments);return b.map(function(c){return this.getProperty(c);},this).associate(b);},setProperty:function(e,f){var d=Element.Attributes,c=d.Props[e],b=$defined(f);if(c&&d.Bools[e]){f=(f||!b)?true:false;}else{if(!b){return this.removeProperty(e);}}(c)?this[c]=f:this.setAttribute(e,f);return this;},setProperties:function(b){for(var c in b){this.setProperty(c,b[c]);}return this;},removeProperty:function(e){var d=Element.Attributes,c=d.Props[e],b=(c&&d.Bools[e]);(c)?this[c]=(b)?false:"":this.removeAttribute(e);return this;},removeProperties:function(){Array.each(arguments,this.removeProperty,this);return this;}});(function(){var b=function(e,c,k,d,g,j){var f=e[k||c];var h=[];while(f){if(f.nodeType==1&&(!d||Element.match(f,d))){h.push(f);if(!g){break;}}f=f[c];}return(g)?new Elements(h,{ddup:false,cash:!j}):$(h[0],j);};Element.implement({getPrevious:function(c,d){return b(this,"previousSibling",null,c,false,d);},getAllPrevious:function(c,d){return b(this,"previousSibling",null,c,true,d);},getNext:function(c,d){return b(this,"nextSibling",null,c,false,d);},getAllNext:function(c,d){return b(this,"nextSibling",null,c,true,d);},getFirst:function(c,d){return b(this,"nextSibling","firstChild",c,false,d);},getLast:function(c,d){return b(this,"previousSibling","lastChild",c,false,d);},getParent:function(c,d){return b(this,"parentNode",null,c,false,d);},getParents:function(c,d){return b(this,"parentNode",null,c,true,d);},getChildren:function(c,d){return b(this,"nextSibling","firstChild",c,true,d);},hasChild:function(c){c=$(c,true);return(!!c&&$A(this.getElementsByTagName(c.tagName)).contains(c));}});})();Element.Properties=new Hash;Element.Properties.style={set:function(b){this.style.cssText=b;},get:function(){return this.style.cssText;},erase:function(){this.style.cssText="";}};Element.Properties.tag={get:function(){return this.tagName.toLowerCase();}};Element.Properties.href={get:function(){return(!this.href)?null:this.href.replace(new RegExp("^"+document.location.protocol+"//"+document.location.host),"");}};Element.Properties.html={set:function(){return this.innerHTML=Array.flatten(arguments).join("");}};Native.implement([Element,Window,Document],{addListener:function(c,b){if(this.addEventListener){this.addEventListener(c,b,false);}else{this.attachEvent("on"+c,b);}return this;},removeListener:function(c,b){if(this.removeEventListener){this.removeEventListener(c,b,false);}else{this.detachEvent("on"+c,b);}return this;},retrieve:function(c,b){var e=Element.Storage.get(this.uid);var d=e[c];if($defined(b)&&!$defined(d)){d=e[c]=b;}return $pick(d);},store:function(c,b){var d=Element.Storage.get(this.uid);d[c]=b;return this;},eliminate:function(b){var c=Element.Storage.get(this.uid);delete c[b];return this;}});Element.Attributes=new Hash({Props:{html:"innerHTML","class":"className","for":"htmlFor",text:(Browser.Engine.trident)?"innerText":"textContent"},Bools:["compact","nowrap","ismap","declare","noshade","checked","disabled","readonly","multiple","selected","noresize","defer"],Camels:["value","accessKey","cellPadding","cellSpacing","colSpan","frameBorder","maxLength","readOnly","rowSpan","tabIndex","useMap"]});Browser.freeMem=function(b){if(!b){return;}if(Browser.Engine.trident&&(/object/i).test(b.tagName)){for(var c in b){if(typeof b[c]=="function"){b[c]=$empty;}}Element.dispose(b);}if(b.uid&&b.removeEvents){b.removeEvents();}};(function(c){var d=c.Bools,b=c.Camels;c.Bools=d=d.associate(d);Hash.extend(Hash.combine(c.Props,d),b.associate(b.map(function(e){return e.toLowerCase();})));c.erase("Camels");})(Element.Attributes);window.addListener("unload",function(){window.removeListener("unload",arguments.callee);document.purge();if(Browser.Engine.trident){CollectGarbage();}});Element.Properties.events={set:function(b){this.addEvents(b);}};Native.implement([Element,Window,Document],{addEvent:function(f,h){var j=this.retrieve("events",{});j[f]=j[f]||{keys:[],values:[]};if(j[f].keys.contains(h)){return this;}j[f].keys.push(h);var g=f,b=Element.Events.get(f),d=h,k=this;if(b){if(b.onAdd){b.onAdd.call(this,h);}if(b.condition){d=function(l){if(b.condition.call(this,l)){return h.call(this,l);}return false;};}g=b.base||g;}var e=function(){return h.call(k);};var c=Element.NativeEvents[g]||0;if(c){if(c==2){e=function(l){l=new Event(l,k.getWindow());if(d.call(k,l)===false){l.stop();}};}this.addListener(g,e);}j[f].values.push(e);return this;},removeEvent:function(e,d){var c=this.retrieve("events");if(!c||!c[e]){return this;}var h=c[e].keys.indexOf(d);if(h==-1){return this;}var b=c[e].keys.splice(h,1)[0];var g=c[e].values.splice(h,1)[0];var f=Element.Events.get(e);if(f){if(f.onRemove){f.onRemove.call(this,d);}e=f.base||e;}return(Element.NativeEvents[e])?this.removeListener(e,g):this;},addEvents:function(b){for(var c in b){this.addEvent(c,b[c]);}return this;},removeEvents:function(c){var b=this.retrieve("events");if(!b){return this;}if(!c){for(var d in b){this.removeEvents(d);}b=null;}else{if(b[c]){while(b[c].keys[0]){this.removeEvent(c,b[c].keys[0]);}b[c]=null;}}return this;},fireEvent:function(e,c,b){var d=this.retrieve("events");if(!d||!d[e]){return this;}d[e].keys.each(function(f){f.create({bind:this,delay:b,"arguments":c})();},this);return this;},cloneEvents:function(e,b){e=$(e);var d=e.retrieve("events");if(!d){return this;}if(!b){for(var c in d){this.cloneEvents(e,c);}}else{if(d[b]){d[b].keys.each(function(f){this.addEvent(b,f);},this);}}return this;}});Element.NativeEvents={click:2,dblclick:2,mouseup:2,mousedown:2,contextmenu:2,mousewheel:2,DOMMouseScroll:2,mouseover:2,mouseout:2,mousemove:2,selectstart:2,selectend:2,keydown:2,keypress:2,keyup:2,focus:2,blur:2,change:2,reset:2,select:2,submit:2,load:1,unload:1,beforeunload:2,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1,scroll:1};(function(){var b=function(c){var d=c.relatedTarget;if(d==undefined){return true;}if(d===false){return false;}return($type(this)!="document"&&d!=this&&d.prefix!="xul"&&!this.hasChild(d));};Element.Events=new Hash({mouseenter:{base:"mouseover",condition:b},mouseleave:{base:"mouseout",condition:b},mousewheel:{base:(Browser.Engine.gecko)?"DOMMouseScroll":"mousewheel"}});})();Element.Properties.styles={set:function(b){this.setStyles(b);}};Element.Properties.opacity={set:function(b,c){if(!c){if(b==0){if(this.style.visibility!="hidden"){this.style.visibility="hidden";}}else{if(this.style.visibility!="visible"){this.style.visibility="visible";}}}if(!this.currentStyle||!this.currentStyle.hasLayout){this.style.zoom=1;}if(Browser.Engine.trident){this.style.filter=(b==1)?"":"alpha(opacity="+b*100+")";}this.style.opacity=b;this.store("opacity",b);},get:function(){return this.retrieve("opacity",1);}};Element.implement({setOpacity:function(b){return this.set("opacity",b,true);},getOpacity:function(){return this.get("opacity");},setStyle:function(c,b){switch(c){case"opacity":return this.set("opacity",parseFloat(b));case"float":c=(Browser.Engine.trident)?"styleFloat":"cssFloat";}c=c.camelCase();if($type(b)!="string"){var d=(Element.Styles.get(c)||"@").split(" ");b=$splat(b).map(function(f,e){if(!d[e]){return"";}return($type(f)=="number")?d[e].replace("@",Math.round(f)):f;}).join(" ");}else{if(b==String(Number(b))){b=Math.round(b);}}this.style[c]=b;return this;},getStyle:function(h){switch(h){case"opacity":return this.get("opacity");case"float":h=(Browser.Engine.trident)?"styleFloat":"cssFloat";}h=h.camelCase();var b=this.style[h];if(!$chk(b)){b=[];for(var g in Element.ShortStyles){if(h!=g){continue;}for(var f in Element.ShortStyles[g]){b.push(this.getStyle(f));}return b.join(" ");}b=this.getComputedStyle(h);}if(b){b=String(b);var d=b.match(/rgba?\([\d\s,]+\)/);if(d){b=b.replace(d[0],d[0].rgbToHex());}}if(Browser.Engine.presto||(Browser.Engine.trident&&!$chk(parseInt(b)))){if(h.test(/^(height|width)$/)){var c=(h=="width")?["left","right"]:["top","bottom"],e=0;c.each(function(j){e+=this.getStyle("border-"+j+"-width").toInt()+this.getStyle("padding-"+j).toInt();},this);return this["offset"+h.capitalize()]-e+"px";}if(Browser.Engine.presto&&String(b).test("px")){return b;}if(h.test(/(border(.+)Width|margin|padding)/)){return"0px";}}return b;},setStyles:function(c){for(var b in c){this.setStyle(b,c[b]);}return this;},getStyles:function(){var b={};Array.each(arguments,function(c){b[c]=this.getStyle(c);},this);return b;}});Element.Styles=new Hash({left:"@px",top:"@px",bottom:"@px",right:"@px",width:"@px",height:"@px",maxWidth:"@px",maxHeight:"@px",minWidth:"@px",minHeight:"@px",backgroundColor:"rgb(@, @, @)",backgroundPosition:"@px @px",color:"rgb(@, @, @)",fontSize:"@px",letterSpacing:"@px",lineHeight:"@px",clip:"rect(@px @px @px @px)",margin:"@px @px @px @px",padding:"@px @px @px @px",border:"@px @ rgb(@, @, @) @px @ rgb(@, @, @) @px @ rgb(@, @, @)",borderWidth:"@px @px @px @px",borderStyle:"@ @ @ @",borderColor:"rgb(@, @, @) rgb(@, @, @) rgb(@, @, @) rgb(@, @, @)",zIndex:"@",zoom:"@",fontWeight:"@",textIndent:"@px",opacity:"@"});Element.ShortStyles={margin:{},padding:{},border:{},borderWidth:{},borderStyle:{},borderColor:{}};["Top","Right","Bottom","Left"].each(function(h){var g=Element.ShortStyles;var c=Element.Styles;["margin","padding"].each(function(j){var k=j+h;g[j][k]=c[k]="@px";});var f="border"+h;g.border[f]=c[f]="@px @ rgb(@, @, @)";var e=f+"Width",b=f+"Style",d=f+"Color";g[f]={};g.borderWidth[e]=g[f][e]=c[e]="@px";g.borderStyle[b]=g[f][b]=c[b]="@";g.borderColor[d]=g[f][d]=c[d]="rgb(@, @, @)";});(function(){Element.implement({scrollTo:function(j,k){if(c(this)){this.getWindow().scrollTo(j,k);}else{this.scrollLeft=j;this.scrollTop=k;}return this;},getSize:function(){if(c(this)){return this.getWindow().getSize();}return{x:this.offsetWidth,y:this.offsetHeight};},getScrollSize:function(){if(c(this)){return this.getWindow().getScrollSize();}return{x:this.scrollWidth,y:this.scrollHeight};},getScroll:function(){if(c(this)){return this.getWindow().getScroll();}return{x:this.scrollLeft,y:this.scrollTop};},getScrolls:function(){var k=this,j={x:0,y:0};while(k&&!c(k)){j.x+=k.scrollLeft;j.y+=k.scrollTop;k=k.parentNode;}return j;},getOffsetParent:function(){var j=this;if(c(j)){return null;}if(!Browser.Engine.trident){return j.offsetParent;}while((j=j.parentNode)&&!c(j)){if(e(j,"position")!="static"){return j;}}return null;},getOffsets:function(){var k=this,j={x:0,y:0};if(c(this)){return j;}while(k&&!c(k)){j.x+=k.offsetLeft;j.y+=k.offsetTop;if(Browser.Engine.gecko){if(!g(k)){j.x+=d(k);j.y+=h(k);}var l=k.parentNode;if(l&&e(l,"overflow")!="visible"){j.x+=d(l);j.y+=h(l);}}else{if(k!=this&&(Browser.Engine.trident||Browser.Engine.webkit)){j.x+=d(k);j.y+=h(k);}}k=k.offsetParent;if(Browser.Engine.trident){while(k&&!k.currentStyle.hasLayout){k=k.offsetParent;}}}if(Browser.Engine.gecko&&!g(this)){j.x-=d(this);j.y-=h(this);}return j;},getPosition:function(n){if(c(this)){return{x:0,y:0};}var o=this.getOffsets(),k=this.getScrolls();var j={x:o.x-k.x,y:o.y-k.y};var l=(n&&(n=$(n)))?n.getPosition():{x:0,y:0};return{x:j.x-l.x,y:j.y-l.y};},getCoordinates:function(l){if(c(this)){return this.getWindow().getCoordinates();}var j=this.getPosition(l),k=this.getSize();var n={left:j.x,top:j.y,width:k.x,height:k.y};n.right=n.left+n.width;n.bottom=n.top+n.height;return n;},computePosition:function(j){return{left:j.x-f(this,"margin-left"),top:j.y-f(this,"margin-top")};},position:function(j){return this.setStyles(this.computePosition(j));}});Native.implement([Document,Window],{getSize:function(){var k=this.getWindow();if(Browser.Engine.presto||Browser.Engine.webkit){return{x:k.innerWidth,y:k.innerHeight};}var j=b(this);return{x:j.clientWidth,y:j.clientHeight};},getScroll:function(){var k=this.getWindow();var j=b(this);return{x:k.pageXOffset||j.scrollLeft,y:k.pageYOffset||j.scrollTop};},getScrollSize:function(){var k=b(this);var j=this.getSize();return{x:Math.max(k.scrollWidth,j.x),y:Math.max(k.scrollHeight,j.y)};},getPosition:function(){return{x:0,y:0};},getCoordinates:function(){var j=this.getSize();return{top:0,left:0,bottom:j.y,right:j.x,height:j.y,width:j.x};}});var e=Element.getComputedStyle;function f(j,k){return e(j,k).toInt()||0;}function g(j){return e(j,"-moz-box-sizing")=="border-box";}function h(j){return f(j,"border-top-width");}function d(j){return f(j,"border-left-width");}function c(j){return(/^(?:body|html)$/i).test(j.tagName);}function b(j){var k=j.getDocument();return(!k.compatMode||k.compatMode=="CSS1Compat")?k.html:k.body;}})();Native.implement([Window,Document,Element],{getHeight:function(){return this.getSize().y;},getWidth:function(){return this.getSize().x;},getScrollTop:function(){return this.getScroll().y;},getScrollLeft:function(){return this.getScroll().x;},getScrollHeight:function(){return this.getScrollSize().y;},getScrollWidth:function(){return this.getScrollSize().x;},getTop:function(){return this.getPosition().y;},getLeft:function(){return this.getPosition().x;}});Native.implement([Document,Element],{getElements:function(j,h){j=j.split(",");var d,f={};for(var e=0,c=j.length;e<c;e++){var b=j[e],g=Selectors.Utils.search(this,b,f);if(e!=0&&g.item){g=$A(g);}d=(e==0)?g:(d.item)?$A(d).concat(g):d.concat(g);}return new Elements(d,{ddup:(j.length>1),cash:!h});}});Element.implement({match:function(c){if(!c){return true;}var e=Selectors.Utils.parseTagAndID(c);var b=e[0],f=e[1];if(!Selectors.Filters.byID(this,f)||!Selectors.Filters.byTag(this,b)){return false;}var d=Selectors.Utils.parseSelector(c);return(d)?Selectors.Utils.filter(this,d,{}):true;}});var Selectors={Cache:{nth:{},parsed:{}}};Selectors.RegExps={id:(/#([\w-]+)/),tag:(/^(\w+|\*)/),quick:(/^(\w+|\*)$/),splitter:(/\s*([+>~\s])\s*([a-zA-Z#.*:\[])/g),combined:(/\.([\w-]+)|\[(\w+)(?:([!*^$~|]?=)["']?(.*?)["']?)?\]|:([\w-]+)(?:\(["']?(.*?)?["']?\)|$)/g)};Selectors.Utils={chk:function(c,d){if(!d){return true;}var b=$uid(c);if(!d[b]){return d[b]=true;}return false;},parseNthArgument:function(h){if(Selectors.Cache.nth[h]){return Selectors.Cache.nth[h];}var e=h.match(/^([+-]?\d*)?([a-z]+)?([+-]?\d*)?$/);if(!e){return false;}var g=parseInt(e[1]);var d=(g||g===0)?g:1;var f=e[2]||false;var c=parseInt(e[3])||0;if(d!=0){c--;while(c<1){c+=d;}while(c>=d){c-=d;}}else{d=c;f="index";}switch(f){case"n":e={a:d,b:c,special:"n"};break;case"odd":e={a:2,b:0,special:"n"};break;case"even":e={a:2,b:1,special:"n"};break;case"first":e={a:0,special:"index"};break;case"last":e={special:"last-child"};break;case"only":e={special:"only-child"};break;default:e={a:(d-1),special:"index"};}return Selectors.Cache.nth[h]=e;},parseSelector:function(f){if(Selectors.Cache.parsed[f]){return Selectors.Cache.parsed[f];}var e,j={classes:[],pseudos:[],attributes:[]};while((e=Selectors.RegExps.combined.exec(f))){var k=e[1],h=e[2],g=e[3],c=e[4],d=e[5],l=e[6];if(k){j.classes.push(k);}else{if(d){var b=Selectors.Pseudo.get(d);if(b){j.pseudos.push({parser:b,argument:l});}else{j.attributes.push({name:d,operator:"=",value:l});}}else{if(h){j.attributes.push({name:h,operator:g,value:c});}}}}if(!j.classes.length){delete j.classes;}if(!j.attributes.length){delete j.attributes;}if(!j.pseudos.length){delete j.pseudos;}if(!j.classes&&!j.attributes&&!j.pseudos){j=null;}return Selectors.Cache.parsed[f]=j;},parseTagAndID:function(c){var b=c.match(Selectors.RegExps.tag);var d=c.match(Selectors.RegExps.id);return[(b)?b[1]:"*",(d)?d[1]:false];},filter:function(g,d,f){var e;if(d.classes){for(e=d.classes.length;e--;e){var h=d.classes[e];if(!Selectors.Filters.byClass(g,h)){return false;}}}if(d.attributes){for(e=d.attributes.length;e--;e){var c=d.attributes[e];if(!Selectors.Filters.byAttribute(g,c.name,c.operator,c.value)){return false;}}}if(d.pseudos){for(e=d.pseudos.length;e--;e){var b=d.pseudos[e];if(!Selectors.Filters.byPseudo(g,b.parser,b.argument,f)){return false;}}}return true;},getByTagAndID:function(c,b,e){if(e){var d=(c.getElementById)?c.getElementById(e,true):Element.getElementById(c,e,true);return(d&&Selectors.Filters.byTag(d,b))?[d]:[];}else{return c.getElementsByTagName(b);}},search:function(q,p,v){var c=[];var d=p.trim().replace(Selectors.RegExps.splitter,function(l,k,j){c.push(k);return":)"+j;}).split(":)");var r,g,f,E;for(var D=0,z=d.length;D<z;D++){var C=d[D];if(D==0&&Selectors.RegExps.quick.test(C)){r=q.getElementsByTagName(C);continue;}var b=c[D-1];var s=Selectors.Utils.parseTagAndID(C);var F=s[0],t=s[1];if(D==0){r=Selectors.Utils.getByTagAndID(q,F,t);}else{var e={},o=[];for(var B=0,A=r.length;B<A;B++){o=Selectors.Getters[b](o,r[B],F,t,e);}r=o;}var h=Selectors.Utils.parseSelector(C);if(h){f=[];for(var w=0,u=r.length;w<u;w++){E=r[w];if(Selectors.Utils.filter(E,h,v)){f.push(E);}}r=f;}}return r;}};Selectors.Getters={" ":function(j,h,k,b,f){var e=Selectors.Utils.getByTagAndID(h,k,b);for(var d=0,c=e.length;d<c;d++){var g=e[d];if(Selectors.Utils.chk(g,f)){j.push(g);}}return j;},">":function(j,h,k,b,g){var d=Selectors.Utils.getByTagAndID(h,k,b);for(var f=0,e=d.length;f<e;f++){var c=d[f];if(c.parentNode==h&&Selectors.Utils.chk(c,g)){j.push(c);}}return j;},"+":function(d,c,b,f,e){while((c=c.nextSibling)){if(c.nodeType==1){if(Selectors.Utils.chk(c,e)&&Selectors.Filters.byTag(c,b)&&Selectors.Filters.byID(c,f)){d.push(c);}break;}}return d;},"~":function(d,c,b,f,e){while((c=c.nextSibling)){if(c.nodeType==1){if(!Selectors.Utils.chk(c,e)){break;}if(Selectors.Filters.byTag(c,b)&&Selectors.Filters.byID(c,f)){d.push(c);}}}return d;}};Selectors.Filters={byTag:function(c,b){return(b=="*"||(c.tagName&&c.tagName.toLowerCase()==b));},byID:function(b,c){return(!c||(b.id&&b.id==c));},byClass:function(c,b){return(c.className&&c.className.contains(b," "));},byPseudo:function(b,e,d,c){return e.call(b,d,c);},byAttribute:function(d,e,c,f){var b=Element.prototype.getProperty.call(d,e);if(!b){return false;}if(!c||f==undefined){return true;}switch(c){case"=":return(b==f);case"*=":return(b.contains(f));case"^=":return(b.substr(0,f.length)==f);case"$=":return(b.substr(b.length-f.length)==f);case"!=":return(b!=f);case"~=":return b.contains(f," ");case"|=":return b.contains(f,"-");}return false;}};Selectors.Pseudo=new Hash({empty:function(){return !(this.innerText||this.textContent||"").length;},not:function(b){return !Element.match(this,b);},contains:function(b){return(this.innerText||this.textContent||"").contains(b);},"first-child":function(){return Selectors.Pseudo.index.call(this,0);},"last-child":function(){var b=this;while((b=b.nextSibling)){if(b.nodeType==1){return false;}}return true;},"only-child":function(){var c=this;while((c=c.previousSibling)){if(c.nodeType==1){return false;}}var b=this;while((b=b.nextSibling)){if(b.nodeType==1){return false;}}return true;},"nth-child":function(h,f){h=(h==undefined)?"n":h;var d=Selectors.Utils.parseNthArgument(h);if(d.special!="n"){return Selectors.Pseudo[d.special].call(this,d.a,f);}var g=0;f.positions=f.positions||{};var e=$uid(this);if(!f.positions[e]){var c=this;while((c=c.previousSibling)){if(c.nodeType!=1){continue;}g++;var b=f.positions[$uid(c)];if(b!=undefined){g=b+g;break;}}f.positions[e]=g;}return(f.positions[e]%d.a==d.b);},index:function(b){var c=this,d=0;while((c=c.previousSibling)){if(c.nodeType==1&&++d>b){return false;}}return(d==b);},even:function(c,b){return Selectors.Pseudo["nth-child"].call(this,"2n+1",b);},odd:function(c,b){return Selectors.Pseudo["nth-child"].call(this,"2n",b);}});Element.Events.domready={onAdd:function(b){if(Browser.loaded){b.call(this);}}};(function(){var c=function(){if(Browser.loaded){return;}Browser.loaded=true;window.fireEvent("domready");document.fireEvent("domready");};switch(Browser.Engine.name){case"webkit":(function(){(["loaded","complete"].contains(document.readyState))?c():arguments.callee.delay(50);})();break;case"trident":var b=document.createElement("div");(function(){($try(function(){b.doScroll("left");return $(b).inject(document.body).set("html","temp").dispose();}))?c():arguments.callee.delay(50);})();break;default:window.addEvent("load",c);document.addEvent("DOMContentLoaded",c);}})();var JSON=new Hash({encode:function(c){switch($type(c)){case"string":return'"'+c.replace(/[\x00-\x1f\\"]/g,JSON.$replaceChars)+'"';case"array":return"["+String(c.map(JSON.encode).filter($defined))+"]";case"object":case"hash":var b=[];Hash.each(c,function(f,e){var d=JSON.encode(f);if(d){b.push(JSON.encode(e)+":"+d);}});return"{"+b+"}";case"number":case"boolean":return String(c);case false:return"null";}return null;},$specialChars:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},$replaceChars:function(b){return JSON.$specialChars[b]||"\\u00"+Math.floor(b.charCodeAt()/16).toString(16)+(b.charCodeAt()%16).toString(16);},decode:function(string,secure){if($type(string)!="string"||!string.length){return null;}if(secure&&!(/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/).test(string.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,""))){return null;}return eval("("+string+")");}});Native.implement([Hash,Array,String,Number],{toJSON:function(){return JSON.encode(this);}});var Cookie=new Class({Implements:Options,options:{path:false,domain:false,duration:false,secure:false,document:document},initialize:function(c,b){this.key=c;this.setOptions(b);},write:function(c){c=encodeURIComponent(c);if(this.options.domain){c+="; domain="+this.options.domain;}if(this.options.path){c+="; path="+this.options.path;}if(this.options.duration){var b=new Date();b.setTime(b.getTime()+this.options.duration*24*60*60*1000);c+="; expires="+b.toGMTString();}if(this.options.secure){c+="; secure";}this.options.document.cookie=this.key+"="+c;return this;},read:function(){var b=this.options.document.cookie.match("(?:^|;)\\s*"+this.key.escapeRegExp()+"=([^;]*)");return(b)?decodeURIComponent(b[1]):null;},dispose:function(){new Cookie(this.key,$merge(this.options,{duration:-1})).write("");return this;}});Cookie.write=function(c,d,b){return new Cookie(c,b).write(d);};Cookie.read=function(b){return new Cookie(b).read();};Cookie.dispose=function(c,b){return new Cookie(c,b).dispose();};var Swiff=new Class({Implements:[Options],options:{id:null,height:1,width:1,container:null,properties:{},params:{quality:"high",allowScriptAccess:"always",wMode:"transparent",swLiveConnect:true},callBacks:{},vars:{}},toElement:function(){return this.object;},initialize:function(o,p){this.instance="Swiff_"+$time();this.setOptions(p);p=this.options;var c=this.id=p.id||this.instance;var b=$(p.container);Swiff.CallBacks[this.instance]={};var f=p.params,h=p.vars,g=p.callBacks;var j=$extend({height:p.height,width:p.width},p.properties);var n=this;for(var e in g){Swiff.CallBacks[this.instance][e]=(function(q){return function(){return q.apply(n.object,arguments);};})(g[e]);h[e]="Swiff.CallBacks."+this.instance+"."+e;}f.flashVars=Hash.toQueryString(h);if(Browser.Engine.trident){j.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000";f.movie=o;}else{j.type="application/x-shockwave-flash";j.data=o;}var l='<object id="'+c+'"';for(var k in j){l+=" "+k+'="'+j[k]+'"';}l+=">";for(var d in f){if(f[d]){l+='<param name="'+d+'" value="'+f[d]+'" />';}}l+="</object>";this.object=((b)?b.empty():new Element("div")).set("html",l).firstChild;},replaces:function(b){b=$(b,true);b.parentNode.replaceChild(this.toElement(),b);return this;},inject:function(b){$(b,true).appendChild(this.toElement());return this;},remote:function(){return Swiff.remote.apply(Swiff,[this.toElement()].extend(arguments));}});Swiff.CallBacks={};Swiff.remote=function(obj,fn){var rs=obj.CallFunction('<invoke name="'+fn+'" returntype="javascript">'+__flash__argumentsToXML(arguments,2)+"</invoke>");return eval(rs);};var Fx=new Class({Implements:[Chain,Events,Options],options:{fps:50,unit:false,duration:500,link:"ignore",transition:function(b){return -(Math.cos(Math.PI*b)-1)/2;}},initialize:function(b){this.subject=this.subject||this;this.setOptions(b);this.options.duration=Fx.Durations[this.options.duration]||this.options.duration.toInt();var c=this.options.wait;if(c===false){this.options.link="cancel";}},step:function(){var b=$time();if(b<this.time+this.options.duration){var c=this.options.transition((b-this.time)/this.options.duration);this.set(this.compute(this.from,this.to,c));}else{this.set(this.compute(this.from,this.to,1));this.complete();}},set:function(b){return b;},compute:function(d,c,b){return Fx.compute(d,c,b);},check:function(b){if(!this.timer){return true;}switch(this.options.link){case"cancel":this.cancel();return true;case"chain":this.chain(b.bind(this,Array.slice(arguments,1)));return false;}return false;},start:function(c,b){if(!this.check(arguments.callee,c,b)){return this;}this.from=c;this.to=b;this.time=0;this.startTimer();this.onStart();return this;},complete:function(){if(this.stopTimer()){this.onComplete();}return this;},cancel:function(){if(this.stopTimer()){this.onCancel();}return this;},onStart:function(){this.fireEvent("start",this.subject);},onComplete:function(){this.fireEvent("complete",this.subject);if(!this.callChain()){this.fireEvent("chainComplete",this.subject);}},onCancel:function(){this.fireEvent("cancel",this.subject).clearChain();},pause:function(){this.stopTimer();return this;},resume:function(){this.startTimer();return this;},stopTimer:function(){if(!this.timer){return false;}this.time=$time()-this.time;this.timer=$clear(this.timer);return true;},startTimer:function(){if(this.timer){return false;}this.time=$time()-this.time;this.timer=this.step.periodical(Math.round(1000/this.options.fps),this);return true;}});Fx.compute=function(d,c,b){return(c-d)*b+d;};Fx.Durations={"short":250,normal:500,"long":1000};Fx.CSS=new Class({Extends:Fx,prepare:function(e,f,c){c=$splat(c);var d=c[1];if(!$chk(d)){c[1]=c[0];c[0]=e.getStyle(f);}var b=c.map(this.parse);return{from:b[0],to:b[1]};},parse:function(b){b=$lambda(b)();b=(typeof b=="string")?b.split(" "):$splat(b);return b.map(function(d){d=String(d);var c=false;Fx.CSS.Parsers.each(function(g,f){if(c){return;}var e=g.parse(d);if($chk(e)){c={value:e,parser:g};}});c=c||{value:d,parser:Fx.CSS.Parsers.String};return c;});},compute:function(e,d,c){var b=[];(Math.min(e.length,d.length)).times(function(f){b.push({value:e[f].parser.compute(e[f].value,d[f].value,c),parser:e[f].parser});});b.$family={name:"fx:css:value"};return b;},serve:function(d,c){if($type(d)!="fx:css:value"){d=this.parse(d);}var b=[];d.each(function(e){b=b.concat(e.parser.serve(e.value,c));});return b;},render:function(b,e,d,c){b.setStyle(e,this.serve(d,c));},search:function(b){if(Fx.CSS.Cache[b]){return Fx.CSS.Cache[b];}var c={};Array.each(document.styleSheets,function(f,e){var d=f.href;if(d&&d.contains("://")&&!d.contains(document.domain)){return;}var g=f.rules||f.cssRules;Array.each(g,function(k,h){if(!k.style){return;}var j=(k.selectorText)?k.selectorText.replace(/^\w+/,function(l){return l.toLowerCase();}):null;if(!j||!j.test("^"+b+"$")){return;}Element.Styles.each(function(n,l){if(!k.style[l]||Element.ShortStyles[l]){return;}n=String(k.style[l]);c[l]=(n.test(/^rgb/))?n.rgbToHex():n;});});});return Fx.CSS.Cache[b]=c;}});Fx.CSS.Cache={};Fx.CSS.Parsers=new Hash({Color:{parse:function(b){if(b.match(/^#[0-9a-f]{3,6}$/i)){return b.hexToRgb(true);}return((b=b.match(/(\d+),\s*(\d+),\s*(\d+)/)))?[b[1],b[2],b[3]]:false;},compute:function(d,c,b){return d.map(function(f,e){return Math.round(Fx.compute(d[e],c[e],b));});},serve:function(b){return b.map(Number);}},Number:{parse:parseFloat,compute:Fx.compute,serve:function(c,b){return(b)?c+b:c;}},String:{parse:$lambda(false),compute:$arguments(1),serve:$arguments(0)}});Fx.Tween=new Class({Extends:Fx.CSS,initialize:function(c,b){this.element=this.subject=$(c);this.parent(b);},set:function(c,b){if(arguments.length==1){b=c;c=this.property||this.options.property;}this.render(this.element,c,b,this.options.unit);return this;},start:function(d,f,e){if(!this.check(arguments.callee,d,f,e)){return this;}var c=Array.flatten(arguments);this.property=this.options.property||c.shift();var b=this.prepare(this.element,this.property,c);return this.parent(b.from,b.to);}});Element.Properties.tween={set:function(b){var c=this.retrieve("tween");if(c){c.cancel();}return this.eliminate("tween").store("tween:options",$extend({link:"cancel"},b));},get:function(b){if(b||!this.retrieve("tween")){if(b||!this.retrieve("tween:options")){this.set("tween",b);}this.store("tween",new Fx.Tween(this,this.retrieve("tween:options")));}return this.retrieve("tween");}};Element.implement({tween:function(b,d,c){this.get("tween").start(arguments);return this;},fade:function(d){var f=this.get("tween"),e="opacity",b;d=$pick(d,"toggle");switch(d){case"in":f.start(e,1);break;case"out":f.start(e,0);break;case"show":f.set(e,1);break;case"hide":f.set(e,0);break;case"toggle":var c=this.retrieve("fade:flag",this.get("opacity")==1);f.start(e,(c)?0:1);this.store("fade:flag",!c);b=true;break;default:f.start(e,arguments);}if(!b){this.eliminate("fade:flag");}return this;},highlight:function(d,b){if(!b){b=this.retrieve("highlight:original",this.getStyle("background-color"));b=(b=="transparent")?"#fff":b;}var c=this.get("tween");c.start("background-color",d||"#ffff88",b).chain(function(){this.setStyle("background-color",this.retrieve("highlight:original"));c.callChain();}.bind(this));return this;}});Fx.Morph=new Class({Extends:Fx.CSS,initialize:function(c,b){this.element=this.subject=$(c);this.parent(b);},set:function(b){if(typeof b=="string"){b=this.search(b);}for(var c in b){this.render(this.element,c,b[c],this.options.unit);}return this;},compute:function(f,e,d){var b={};for(var c in f){b[c]=this.parent(f[c],e[c],d);}return b;},start:function(c){if(!this.check(arguments.callee,c)){return this;}if(typeof c=="string"){c=this.search(c);}var f={},e={};for(var d in c){var b=this.prepare(this.element,d,c[d]);f[d]=b.from;e[d]=b.to;}return this.parent(f,e);}});Element.Properties.morph={set:function(b){var c=this.retrieve("morph");if(c){c.cancel();}return this.eliminate("morph").store("morph:options",$extend({link:"cancel"},b));},get:function(b){if(b||!this.retrieve("morph")){if(b||!this.retrieve("morph:options")){this.set("morph",b);}this.store("morph",new Fx.Morph(this,this.retrieve("morph:options")));}return this.retrieve("morph");}};Element.implement({morph:function(b){this.get("morph").start(b);return this;}});(function(){var b=Fx.prototype.initialize;Fx.prototype.initialize=function(c){b.call(this,c);var d=this.options.transition;if(typeof d=="string"&&(d=d.split(":"))){var e=Fx.Transitions;e=e[d[0]]||e[d[0].capitalize()];if(d[1]){e=e["ease"+d[1].capitalize()+(d[2]?d[2].capitalize():"")];}this.options.transition=e;}};})();Fx.Transition=function(c,b){b=$splat(b);return $extend(c,{easeIn:function(d){return c(d,b);},easeOut:function(d){return 1-c(1-d,b);},easeInOut:function(d){return(d<=0.5)?c(2*d,b)/2:(2-c(2*(1-d),b))/2;}});};Fx.Transitions=new Hash({linear:$arguments(0)});Fx.Transitions.extend=function(b){for(var c in b){Fx.Transitions[c]=new Fx.Transition(b[c]);}};Fx.Transitions.extend({Pow:function(c,b){return Math.pow(c,b[0]||6);},Expo:function(b){return Math.pow(2,8*(b-1));},Circ:function(b){return 1-Math.sin(Math.acos(b));},Sine:function(b){return 1-Math.sin((1-b)*Math.PI/2);},Back:function(c,b){b=b[0]||1.618;return Math.pow(c,2)*((b+1)*c-b);},Bounce:function(f){var e;for(var d=0,c=1;1;d+=c,c/=2){if(f>=(7-4*d)/11){e=-Math.pow((11-6*d-11*f)/4,2)+c*c;break;}}return e;},Elastic:function(c,b){return Math.pow(2,10*--c)*Math.cos(20*c*Math.PI*(b[0]||1)/3);}});["Quad","Cubic","Quart","Quint"].each(function(c,b){Fx.Transitions[c]=new Fx.Transition(function(d){return Math.pow(d,[b+2]);});});var Request=new Class({Implements:[Chain,Events,Options],options:{url:"",data:"",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*"},async:true,format:false,method:"post",link:"ignore",isSuccess:null,emulation:true,urlEncoded:true,encoding:"utf-8",evalScripts:false,evalResponse:false},initialize:function(b){this.xhr=new Browser.Request();this.setOptions(b);this.options.isSuccess=this.options.isSuccess||this.isSuccess;this.headers=new Hash(this.options.headers);},onStateChange:function(){if(this.xhr.readyState!=4||!this.running){return;}this.running=false;this.status=0;$try(function(){this.status=this.xhr.status;}.bind(this));if(this.options.isSuccess.call(this,this.status)){this.response={text:this.xhr.responseText,xml:this.xhr.responseXML};this.success(this.response.text,this.response.xml);}else{this.response={text:null,xml:null};this.failure();}this.xhr.onreadystatechange=$empty;},isSuccess:function(){return((this.status>=200)&&(this.status<300));},processScripts:function(b){if(this.options.evalResponse||(/(ecma|java)script/).test(this.getHeader("Content-type"))){return $exec(b);}return b.stripScripts(this.options.evalScripts);},success:function(c,b){this.onSuccess(this.processScripts(c),b);},onSuccess:function(){this.fireEvent("complete",arguments).fireEvent("success",arguments).callChain();},failure:function(){this.onFailure();},onFailure:function(){this.fireEvent("complete").fireEvent("failure",this.xhr);},setHeader:function(b,c){this.headers.set(b,c);return this;},getHeader:function(b){return $try(function(){return this.xhr.getResponseHeader(b);}.bind(this));},check:function(b){if(!this.running){return true;}switch(this.options.link){case"cancel":this.cancel();return true;case"chain":this.chain(b.bind(this,Array.slice(arguments,1)));return false;}return false;},send:function(k){if(!this.check(arguments.callee,k)){return this;}this.running=true;var h=$type(k);if(h=="string"||h=="element"){k={data:k};}var e=this.options;k=$extend({data:e.data,url:e.url,method:e.method},k);var f=k.data,c=k.url,b=k.method;switch($type(f)){case"element":f=$(f).toQueryString();break;case"object":case"hash":f=Hash.toQueryString(f);}if(this.options.format){var j="format="+this.options.format;f=(f)?j+"&"+f:j;}if(this.options.emulation&&["put","delete"].contains(b)){var g="_method="+b;f=(f)?g+"&"+f:g;b="post";}if(this.options.urlEncoded&&b=="post"){var d=(this.options.encoding)?"; charset="+this.options.encoding:"";this.headers.set("Content-type","application/x-www-form-urlencoded"+d);}if(f&&b=="get"){c=c+(c.contains("?")?"&":"?")+f;f=null;}this.xhr.open(b.toUpperCase(),c,this.options.async);this.xhr.onreadystatechange=this.onStateChange.bind(this);this.headers.each(function(n,l){if(!$try(function(){this.xhr.setRequestHeader(l,n);return true;}.bind(this))){this.fireEvent("exception",[l,n]);}},this);this.fireEvent("request");this.xhr.send(f);if(!this.options.async){this.onStateChange();}return this;},cancel:function(){if(!this.running){return this;}this.running=false;this.xhr.abort();this.xhr.onreadystatechange=$empty;this.xhr=new Browser.Request();this.fireEvent("cancel");return this;}});(function(){var b={};["get","post","put","delete","GET","POST","PUT","DELETE"].each(function(c){b[c]=function(){var d=Array.link(arguments,{url:String.type,data:$defined});return this.send($extend(d,{method:c.toLowerCase()}));};});Request.implement(b);})();Element.Properties.send={set:function(b){var c=this.retrieve("send");if(c){c.cancel();}return this.eliminate("send").store("send:options",$extend({data:this,link:"cancel",method:this.get("method")||"post",url:this.get("action")},b));},get:function(b){if(b||!this.retrieve("send")){if(b||!this.retrieve("send:options")){this.set("send",b);}this.store("send",new Request(this.retrieve("send:options")));}return this.retrieve("send");}};Element.implement({send:function(b){var c=this.get("send");c.send({data:this,url:b||c.options.url});return this;}});Request.HTML=new Class({Extends:Request,options:{update:false,evalScripts:true,filter:false},processHTML:function(d){var c=d.match(/<body[^>]*>([\s\S]*?)<\/body>/i);d=(c)?c[1]:d;var b=new Element("div");return $try(function(){var e="<root>"+d+"</root>",h;if(Browser.Engine.trident){h=new ActiveXObject("Microsoft.XMLDOM");h.async=false;h.loadXML(e);}else{h=new DOMParser().parseFromString(e,"text/xml");}e=h.getElementsByTagName("root")[0];for(var g=0,f=e.childNodes.length;g<f;g++){var j=Element.clone(e.childNodes[g],true,true);if(j){b.grab(j);}}return b;})||b.set("html",d);},success:function(e){var d=this.options,c=this.response;c.html=e.stripScripts(function(f){c.javascript=f;});var b=this.processHTML(c.html);c.tree=b.childNodes;c.elements=b.getElements("*");if(d.filter){c.tree=c.elements.filter(d.filter);}if(d.update){$(d.update).empty().adopt(c.tree);}if(d.evalScripts){$exec(c.javascript);}this.onSuccess(c.tree,c.elements,c.html,c.javascript);}});Element.Properties.load={set:function(b){var c=this.retrieve("load");if(c){send.cancel();}return this.eliminate("load").store("load:options",$extend({data:this,link:"cancel",update:this,method:"get"},b));},get:function(b){if(b||!this.retrieve("load")){if(b||!this.retrieve("load:options")){this.set("load",b);}this.store("load",new Request.HTML(this.retrieve("load:options")));}return this.retrieve("load");}};Element.implement({load:function(){this.get("load").send(Array.link(arguments,{data:Object.type,url:String.type}));return this;}});Request.JSON=new Class({Extends:Request,options:{secure:true},initialize:function(b){this.parent(b);this.headers.extend({Accept:"application/json","X-Request":"JSON"});},success:function(b){this.response.json=JSON.decode(b,this.options.secure);this.onSuccess(this.response.json,b);}});Fx.Slide=new Class({Extends:Fx,options:{mode:"vertical"},initialize:function(c,b){this.addEvent("complete",function(){this.open=(this.wrapper["offset"+this.layout.capitalize()]!=0);if(this.open&&Browser.Engine.webkit419){this.element.dispose().inject(this.wrapper);}},true);this.element=this.subject=$(c);this.parent(b);var d=this.element.retrieve("wrapper");this.wrapper=d||new Element("div",{styles:$extend(this.element.getStyles("margin","position"),{overflow:"hidden"})}).wraps(this.element);this.element.store("wrapper",this.wrapper).setStyle("margin",0);this.now=[];this.open=true;},vertical:function(){this.margin="margin-top";this.layout="height";this.offset=this.element.offsetHeight;},horizontal:function(){this.margin="margin-left";this.layout="width";this.offset=this.element.offsetWidth;},set:function(b){this.element.setStyle(this.margin,b[0]);this.wrapper.setStyle(this.layout,b[1]);return this;},compute:function(f,e,d){var c=[];var b=2;b.times(function(g){c[g]=Fx.compute(f[g],e[g],d);});return c;},start:function(c,f){if(!this.check(arguments.callee,c,f)){return this;}this[f||this.options.mode]();var e=this.element.getStyle(this.margin).toInt();var d=this.wrapper.getStyle(this.layout).toInt();var b=[[e,d],[0,this.offset]];var h=[[e,d],[-this.offset,0]];var g;switch(c){case"in":g=b;break;case"out":g=h;break;case"toggle":g=(this.wrapper["offset"+this.layout.capitalize()]==0)?b:h;}return this.parent(g[0],g[1]);},slideIn:function(b){return this.start("in",b);},slideOut:function(b){return this.start("out",b);},hide:function(b){this[b||this.options.mode]();this.open=false;return this.set([-this.offset,0]);},show:function(b){this[b||this.options.mode]();this.open=true;return this.set([0,this.offset]);},toggle:function(b){return this.start("toggle",b);}});Element.Properties.slide={set:function(c){var b=this.retrieve("slide");if(b){b.cancel();}return this.eliminate("slide").store("slide:options",$extend({link:"cancel"},c));},get:function(b){if(b||!this.retrieve("slide")){if(b||!this.retrieve("slide:options")){this.set("slide",b);}this.store("slide",new Fx.Slide(this,this.retrieve("slide:options")));}return this.retrieve("slide");}};Element.implement({slide:function(e,f){e=e||"toggle";var c=this.get("slide"),b;switch(e){case"hide":c.hide(f);break;case"show":c.show(f);break;case"toggle":var d=this.retrieve("slide:flag",c.open);c[(d)?"slideOut":"slideIn"](f);this.store("slide:flag",!d);b=true;break;default:c.start(e,f);}if(!b){this.eliminate("slide:flag");}return this;}});Fx.Scroll=new Class({Extends:Fx,options:{offset:{x:0,y:0},wheelStops:true},initialize:function(c,b){this.element=this.subject=$(c);this.parent(b);var e=this.cancel.bind(this,false);if($type(this.element)!="element"){this.element=$(this.element.getDocument().body);}var d=this.element;if(this.options.wheelStops){this.addEvent("start",function(){d.addEvent("mousewheel",e);},true);this.addEvent("complete",function(){d.removeEvent("mousewheel",e);},true);}},set:function(){var b=Array.flatten(arguments);this.element.scrollTo(b[0],b[1]);},compute:function(f,e,d){var c=[];var b=2;b.times(function(g){c.push(Fx.compute(f[g],e[g],d));});return c;},start:function(d,j){if(!this.check(arguments.callee,d,j)){return this;}var f=this.element.getSize(),g=this.element.getScrollSize();var c=this.element.getScroll(),e={x:d,y:j};for(var h in e){var b=g[h]-f[h];if($chk(e[h])){e[h]=($type(e[h])=="number")?e[h].limit(0,b):b;}else{e[h]=c[h];}e[h]+=this.options.offset[h];}return this.parent([c.x,c.y],[e.x,e.y]);},toTop:function(){return this.start(false,0);},toLeft:function(){return this.start(0,false);},toRight:function(){return this.start("right",false);},toBottom:function(){return this.start(false,"bottom");},toElement:function(c){var b=$(c).getPosition(this.element);return this.start(b.x,b.y);}});Fx.Elements=new Class({Extends:Fx.CSS,initialize:function(c,b){this.elements=this.subject=$$(c);this.parent(b);},compute:function(h,j,k){var d={};for(var e in h){var b=h[e],f=j[e],g=d[e]={};for(var c in b){g[c]=this.parent(b[c],f[c],k);}}return d;},set:function(c){for(var d in c){var b=c[d];for(var e in b){this.render(this.elements[d],e,b[e],this.options.unit);}}return this;},start:function(d){if(!this.check(arguments.callee,d)){return this;}var j={},k={};for(var e in d){var g=d[e],b=j[e]={},h=k[e]={};for(var c in g){var f=this.prepare(this.elements[e],c,g[c]);b[c]=f.from;h[c]=f.to;}}return this.parent(j,k);}});var Drag=new Class({Implements:[Events,Options],options:{snap:6,unit:"px",grid:false,style:true,limit:false,handle:false,invert:false,preventDefault:false,modifiers:{x:"left",y:"top"}},initialize:function(){var c=Array.link(arguments,{options:Object.type,element:$defined});this.element=$(c.element);this.document=this.element.getDocument();this.setOptions(c.options||{});var b=$type(this.options.handle);this.handles=(b=="array"||b=="collection")?$$(this.options.handle):$(this.options.handle)||this.element;this.mouse={now:{},pos:{}};this.value={start:{},now:{}};this.selection=(Browser.Engine.trident)?"selectstart":"mousedown";this.bound={start:this.start.bind(this),check:this.check.bind(this),drag:this.drag.bind(this),stop:this.stop.bind(this),cancel:this.cancel.bind(this),eventStop:$lambda(false)};this.attach();},attach:function(){this.handles.addEvent("mousedown",this.bound.start);return this;},detach:function(){this.handles.removeEvent("mousedown",this.bound.start);return this;},start:function(d){if(this.options.preventDefault){d.preventDefault();}this.fireEvent("beforeStart",this.element);this.mouse.start=d.page;var b=this.options.limit;this.limit={x:[],y:[]};for(var e in this.options.modifiers){if(!this.options.modifiers[e]){continue;}if(this.options.style){this.value.now[e]=this.element.getStyle(this.options.modifiers[e]).toInt();}else{this.value.now[e]=this.element[this.options.modifiers[e]];}if(this.options.invert){this.value.now[e]*=-1;}this.mouse.pos[e]=d.page[e]-this.value.now[e];if(b&&b[e]){for(var c=2;c--;c){if($chk(b[e][c])){this.limit[e][c]=$lambda(b[e][c])();}}}}if($type(this.options.grid)=="number"){this.options.grid={x:this.options.grid,y:this.options.grid};}this.document.addEvents({mousemove:this.bound.check,mouseup:this.bound.cancel});this.document.addEvent(this.selection,this.bound.eventStop);},check:function(b){if(this.options.preventDefault){b.preventDefault();}var c=Math.round(Math.sqrt(Math.pow(b.page.x-this.mouse.start.x,2)+Math.pow(b.page.y-this.mouse.start.y,2)));if(c>this.options.snap){this.cancel();this.document.addEvents({mousemove:this.bound.drag,mouseup:this.bound.stop});this.fireEvent("start",this.element).fireEvent("snap",this.element);}},drag:function(b){if(this.options.preventDefault){b.preventDefault();}this.mouse.now=b.page;for(var c in this.options.modifiers){if(!this.options.modifiers[c]){continue;}this.value.now[c]=this.mouse.now[c]-this.mouse.pos[c];if(this.options.invert){this.value.now[c]*=-1;}if(this.options.limit&&this.limit[c]){if($chk(this.limit[c][1])&&(this.value.now[c]>this.limit[c][1])){this.value.now[c]=this.limit[c][1];}else{if($chk(this.limit[c][0])&&(this.value.now[c]<this.limit[c][0])){this.value.now[c]=this.limit[c][0];}}}if(this.options.grid[c]){this.value.now[c]-=(this.value.now[c]%this.options.grid[c]);}if(this.options.style){this.element.setStyle(this.options.modifiers[c],this.value.now[c]+this.options.unit);}else{this.element[this.options.modifiers[c]]=this.value.now[c];}}this.fireEvent("drag",this.element);},cancel:function(b){this.document.removeEvent("mousemove",this.bound.check);this.document.removeEvent("mouseup",this.bound.cancel);if(b){this.document.removeEvent(this.selection,this.bound.eventStop);this.fireEvent("cancel",this.element);}},stop:function(b){this.document.removeEvent(this.selection,this.bound.eventStop);this.document.removeEvent("mousemove",this.bound.drag);this.document.removeEvent("mouseup",this.bound.stop);if(b){this.fireEvent("complete",this.element);}}});Element.implement({makeResizable:function(b){return new Drag(this,$merge({modifiers:{x:"width",y:"height"}},b));}});Drag.Move=new Class({Extends:Drag,options:{droppables:[],container:false},initialize:function(d,c){this.parent(d,c);this.droppables=$$(this.options.droppables);this.container=$(this.options.container);if(this.container&&$type(this.container)!="element"){this.container=$(this.container.getDocument().body);}d=this.element;var e=d.getStyle("position");var b=(e!="static")?e:"absolute";if(d.getStyle("left")=="auto"||d.getStyle("top")=="auto"){d.position(d.getPosition(d.offsetParent));}d.setStyle("position",b);this.addEvent("start",function(){this.checkDroppables();},true);},start:function(c){if(this.container){var e=this.element,l=this.container,f=l.getCoordinates(e.offsetParent),g={},b={};["top","right","bottom","left"].each(function(n){g[n]=l.getStyle("padding-"+n).toInt();b[n]=e.getStyle("margin-"+n).toInt();},this);var d=e.offsetWidth+b.left+b.right,k=e.offsetHeight+b.top+b.bottom;var j=[f.left+g.left,f.right-g.right-d];var h=[f.top+g.top,f.bottom-g.bottom-k];this.options.limit={x:j,y:h};}this.parent(c);},checkAgainst:function(c){c=c.getCoordinates();var b=this.mouse.now;return(b.x>c.left&&b.x<c.right&&b.y<c.bottom&&b.y>c.top);},checkDroppables:function(){var b=this.droppables.filter(this.checkAgainst,this).getLast();if(this.overed!=b){if(this.overed){this.fireEvent("leave",[this.element,this.overed]);}if(b){this.overed=b;this.fireEvent("enter",[this.element,b]);}else{this.overed=null;}}},drag:function(b){this.parent(b);if(this.droppables.length){this.checkDroppables();}},stop:function(b){this.checkDroppables();this.fireEvent("drop",[this.element,this.overed]);this.overed=null;return this.parent(b);}});Element.implement({makeDraggable:function(b){return new Drag.Move(this,b);}});Hash.Cookie=new Class({Extends:Cookie,options:{autoSave:true},initialize:function(c,b){this.parent(c,b);this.load();},save:function(){var b=JSON.encode(this.hash);if(!b||b.length>4096){return false;}if(b=="{}"){this.dispose();}else{this.write(b);}return true;},load:function(){this.hash=new Hash(JSON.decode(this.read(),true));return this;}});Hash.Cookie.implement((function(){var b={};Hash.each(Hash.prototype,function(d,c){b[c]=function(){var e=d.apply(this.hash,arguments);if(this.options.autoSave){this.save();}return e;};});return b;})());var Color=new Native({initialize:function(c,d){if(arguments.length>=3){d="rgb";c=Array.slice(arguments,0,3);}else{if(typeof c=="string"){if(c.match(/rgb/)){c=c.rgbToHex().hexToRgb(true);}else{if(c.match(/hsb/)){c=c.hsbToRgb();}else{c=c.hexToRgb(true);}}}}d=d||"rgb";switch(d){case"hsb":var b=c;c=c.hsbToRgb();c.hsb=b;break;case"hex":c=c.hexToRgb(true);break;}c.rgb=c.slice(0,3);c.hsb=c.hsb||c.rgbToHsb();c.hex=c.rgbToHex();return $extend(c,this);}});Color.implement({mix:function(){var b=Array.slice(arguments);var d=($type(b.getLast())=="number")?b.pop():50;var c=this.slice();b.each(function(e){e=new Color(e);for(var f=0;f<3;f++){c[f]=Math.round((c[f]/100*(100-d))+(e[f]/100*d));}});return new Color(c,"rgb");},invert:function(){return new Color(this.map(function(b){return 255-b;}));},setHue:function(b){return new Color([b,this.hsb[1],this.hsb[2]],"hsb");},setSaturation:function(b){return new Color([this.hsb[0],b,this.hsb[2]],"hsb");},setBrightness:function(b){return new Color([this.hsb[0],this.hsb[1],b],"hsb");}});function $RGB(e,d,c){return new Color([e,d,c],"rgb");}function $HSB(e,d,c){return new Color([e,d,c],"hsb");}function $HEX(b){return new Color(b,"hex");}Array.implement({rgbToHsb:function(){var c=this[0],d=this[1],l=this[2];var h,g,j;var k=Math.max(c,d,l),f=Math.min(c,d,l);var n=k-f;j=k/255;g=(k!=0)?n/k:0;if(g==0){h=0;}else{var e=(k-c)/n;var b=(k-d)/n;var o=(k-l)/n;if(c==k){h=o-b;}else{if(d==k){h=2+e-o;}else{h=4+b-e;}}h/=6;if(h<0){h++;}}return[Math.round(h*360),Math.round(g*100),Math.round(j*100)];},hsbToRgb:function(){var d=Math.round(this[2]/100*255);if(this[1]==0){return[d,d,d];}else{var b=this[0]%360;var g=b%60;var h=Math.round((this[2]*(100-this[1]))/10000*255);var e=Math.round((this[2]*(6000-this[1]*g))/600000*255);var c=Math.round((this[2]*(6000-this[1]*(60-g)))/600000*255);switch(Math.floor(b/60)){case 0:return[d,c,h];case 1:return[e,d,h];case 2:return[h,d,c];case 3:return[h,e,d];case 4:return[c,h,d];case 5:return[d,h,e];}}return false;}});String.implement({rgbToHsb:function(){var b=this.match(/\d{1,3}/g);return(b)?hsb.rgbToHsb():null;},hsbToRgb:function(){var b=this.match(/\d{1,3}/g);return(b)?b.hsbToRgb():null;}});var Group=new Class({initialize:function(){this.instances=Array.flatten(arguments);this.events={};this.checker={};},addEvent:function(c,b){this.checker[c]=this.checker[c]||{};this.events[c]=this.events[c]||[];if(this.events[c].contains(b)){return false;}else{this.events[c].push(b);}this.instances.each(function(d,e){d.addEvent(c,this.check.bind(this,[c,d,e]));},this);return this;},check:function(d,b,c){this.checker[d][c]=true;var e=this.instances.every(function(g,f){return this.checker[d][f]||false;},this);if(!e){return;}this.checker[d]={};this.events[d].each(function(f){f.call(this,this.instances,b);},this);}});var Asset=new Hash({javascript:function(g,e){e=$extend({onload:$empty,document:document,check:$lambda(true)},e);var c=new Element("script",{src:g,type:"text/javascript"});var f=e.onload.bind(c),b=e.check,h=e.document;delete e.onload;delete e.check;delete e.document;c.addEvents({load:f,readystatechange:function(){if(["loaded","complete"].contains(this.readyState)){f();}}}).setProperties(e);if(Browser.Engine.webkit419){var d=(function(){if(!$try(b)){return;}$clear(d);f();}).periodical(50);}return c.inject(h.head);},css:function(c,b){return new Element("link",$merge({rel:"stylesheet",media:"screen",type:"text/css",href:c},b)).inject(document.head);},image:function(d,c){c=$merge({onload:$empty,onabort:$empty,onerror:$empty},c);var e=new Image();var b=$(e)||new Element("img");["load","abort","error"].each(function(f){var g="on"+f;var h=c[g];delete c[g];e[g]=function(){if(!e){return;}if(!b.parentNode){b.width=e.width;b.height=e.height;}e=e.onload=e.onabort=e.onerror=null;h.delay(1,b,b);b.fireEvent(f,b,1);};});e.src=b.src=d;if(e&&e.complete){e.onload.delay(1);}return b.setProperties(c);},images:function(e,d){d=$merge({onComplete:$empty,onProgress:$empty},d);if(!e.push){e=[e];}var b=[];var c=0;e.each(function(g){var f=new Asset.image(g,{onload:function(){d.onProgress.call(this,c,e.indexOf(g));c++;if(c==e.length){d.onComplete();}}});b.push(f);});return new Elements(b);}});var Sortables=new Class({Implements:[Events,Options],options:{snap:4,opacity:1,clone:false,revert:false,handle:false,constrain:false},initialize:function(b,c){this.setOptions(c);this.elements=[];this.lists=[];this.idle=true;this.addLists($$($(b)||b));if(!this.options.clone){this.options.revert=false;}if(this.options.revert){this.effect=new Fx.Morph(null,$merge({duration:250,link:"cancel"},this.options.revert));}},attach:function(){this.addLists(this.lists);return this;},detach:function(){this.lists=this.removeLists(this.lists);return this;},addItems:function(){Array.flatten(arguments).each(function(b){this.elements.push(b);var c=b.retrieve("sortables:start",this.start.bindWithEvent(this,b));(this.options.handle?b.getElement(this.options.handle)||b:b).addEvent("mousedown",c);},this);return this;},addLists:function(){Array.flatten(arguments).each(function(b){this.lists.push(b);this.addItems(b.getChildren());},this);return this;},removeItems:function(){var b=[];Array.flatten(arguments).each(function(c){b.push(c);this.elements.erase(c);var d=c.retrieve("sortables:start");(this.options.handle?c.getElement(this.options.handle)||c:c).removeEvent("mousedown",d);},this);return $$(b);},removeLists:function(){var b=[];Array.flatten(arguments).each(function(c){b.push(c);this.lists.erase(c);this.removeItems(c.getChildren());},this);return $$(b);},getClone:function(c,b){if(!this.options.clone){return new Element("div").inject(document.body);}if($type(this.options.clone)=="function"){return this.options.clone.call(this,c,b,this.list);}return b.clone(true).setStyles({margin:"0px",position:"absolute",visibility:"hidden",width:b.getStyle("width")}).inject(this.list).position(b.getPosition(b.getOffsetParent()));},getDroppables:function(){var b=this.list.getChildren();if(!this.options.constrain){b=this.lists.concat(b).erase(this.list);}return b.erase(this.clone).erase(this.element);},insert:function(d,c){var b="inside";if(this.lists.contains(c)){this.list=c;this.drag.droppables=this.getDroppables();}else{b=this.element.getAllPrevious().contains(c)?"before":"after";}this.element.inject(c,b);this.fireEvent("sort",[this.element,this.clone]);},start:function(c,b){if(!this.idle){return;}this.idle=false;this.element=b;this.opacity=b.get("opacity");this.list=b.getParent();this.clone=this.getClone(c,b);this.drag=new Drag.Move(this.clone,{snap:this.options.snap,container:this.options.constrain&&this.element.getParent(),droppables:this.getDroppables(),onSnap:function(){c.stop();this.clone.setStyle("visibility","visible");this.element.set("opacity",this.options.opacity||0);this.fireEvent("start",[this.element,this.clone]);}.bind(this),onEnter:this.insert.bind(this),onCancel:this.reset.bind(this),onComplete:this.end.bind(this)});this.clone.inject(this.element,"before");this.drag.start(c);},end:function(){this.drag.detach();this.element.set("opacity",this.opacity);if(this.effect){var b=this.element.getStyles("width","height");var c=this.clone.computePosition(this.element.getPosition(this.clone.offsetParent));this.effect.element=this.clone;this.effect.start({top:c.top,left:c.left,width:b.width,height:b.height,opacity:0.25}).chain(this.reset.bind(this));}else{this.reset();}},reset:function(){this.idle=true;this.clone.destroy();this.fireEvent("complete",this.element);},serialize:function(){var d=Array.link(arguments,{modifier:Function.type,index:$defined});var c=this.lists.map(function(e){return e.getChildren().map(d.modifier||function(f){return f.get("id");},this);},this);var b=d.index;if(this.lists.length==1){b=0;}return $chk(b)&&b>=0&&b<this.lists.length?c[b]:c;}});var Tips=new Class({Implements:[Events,Options],options:{onShow:function(b){b.setStyle("visibility","visible");},onHide:function(b){b.setStyle("visibility","hidden");},showDelay:100,hideDelay:100,className:null,offsets:{x:16,y:16},fixed:false},initialize:function(){var d=Array.link(arguments,{options:Object.type,elements:$defined});this.setOptions(d.options||null);this.tip=new Element("div").inject(document.body);if(this.options.className){this.tip.addClass(this.options.className);}var c=new Element("div",{"class":"tip-top"}).inject(this.tip);this.container=new Element("div",{"class":"tip"}).inject(this.tip);var b=new Element("div",{"class":"tip-bottom"}).inject(this.tip);this.tip.setStyles({position:"absolute",top:0,left:0,visibility:"hidden"});if(d.elements){this.attach(d.elements);}},attach:function(b){$$(b).each(function(e){var h=e.retrieve("tip:title",e.get("title"));var g=e.retrieve("tip:text",e.get("rel")||e.get("href"));var f=e.retrieve("tip:enter",this.elementEnter.bindWithEvent(this,e));var d=e.retrieve("tip:leave",this.elementLeave.bindWithEvent(this,e));e.addEvents({mouseenter:f,mouseleave:d});if(!this.options.fixed){var c=e.retrieve("tip:move",this.elementMove.bindWithEvent(this,e));e.addEvent("mousemove",c);}e.store("tip:native",e.get("title"));e.erase("title");},this);return this;},detach:function(b){$$(b).each(function(d){d.removeEvent("mouseenter",d.retrieve("tip:enter")||$empty);d.removeEvent("mouseleave",d.retrieve("tip:leave")||$empty);d.removeEvent("mousemove",d.retrieve("tip:move")||$empty);d.eliminate("tip:enter").eliminate("tip:leave").eliminate("tip:move");var c=d.retrieve("tip:native");if(c){d.set("title",c);}});return this;},elementEnter:function(c,b){$A(this.container.childNodes).each(Element.dispose);var e=b.retrieve("tip:title");if(e){this.titleElement=new Element("div",{"class":"tip-title"}).inject(this.container);this.fill(this.titleElement,e);}var d=b.retrieve("tip:text");if(d){this.textElement=new Element("div",{"class":"tip-text"}).inject(this.container);this.fill(this.textElement,d);}this.timer=$clear(this.timer);this.timer=this.show.delay(this.options.showDelay,this);this.position((!this.options.fixed)?c:{page:b.getPosition()});},elementLeave:function(b){$clear(this.timer);this.timer=this.hide.delay(this.options.hideDelay,this);},elementMove:function(b){this.position(b);},position:function(e){var c=window.getSize(),b=window.getScroll();var f={x:this.tip.offsetWidth,y:this.tip.offsetHeight};var d={x:"left",y:"top"};for(var g in d){var h=e.page[g]+this.options.offsets[g];if((h+f[g]-b[g])>c[g]){h=e.page[g]-this.options.offsets[g]-f[g];}this.tip.setStyle(d[g],h);}},fill:function(b,c){(typeof c=="string")?b.set("html",c):b.adopt(c);},show:function(){this.fireEvent("show",this.tip);},hide:function(){this.fireEvent("hide",this.tip);}});var SmoothScroll=new Class({Extends:Fx.Scroll,initialize:function(c,d){d=d||document;var f=d.getDocument(),e=d.getWindow();this.parent(f,c);this.links=(this.options.links)?$$(this.options.links):$$(f.links);var b=e.location.href.match(/^[^#]*/)[0]+"#";this.links.each(function(h){if(h.href.indexOf(b)!=0){return;}var g=h.href.substr(b.length);if(g&&$(g)){this.useLink(h,g);}},this);if(!Browser.Engine.webkit419){this.addEvent("complete",function(){e.location.hash=this.anchor;},true);}},useLink:function(c,b){c.addEvent("click",function(d){this.anchor=b;this.toElement(b);d.stop();}.bind(this));}});var Slider=new Class({Implements:[Events,Options],options:{onTick:function(b){if(this.options.snap){b=this.toPosition(this.step);}this.knob.setStyle(this.property,b);},snap:false,offset:0,range:false,wheel:false,steps:100,mode:"horizontal"},initialize:function(f,b,e){this.setOptions(e);this.element=$(f);this.knob=$(b);this.previousChange=this.previousEnd=this.step=-1;this.element.addEvent("mousedown",this.clickedElement.bind(this));if(this.options.wheel){this.element.addEvent("mousewheel",this.scrolledElement.bindWithEvent(this));}var g,c={},d={x:false,y:false};switch(this.options.mode){case"vertical":this.axis="y";this.property="top";g="offsetHeight";break;case"horizontal":this.axis="x";this.property="left";g="offsetWidth";}this.half=this.knob[g]/2;this.full=this.element[g]-this.knob[g]+(this.options.offset*2);this.min=$chk(this.options.range[0])?this.options.range[0]:0;this.max=$chk(this.options.range[1])?this.options.range[1]:this.options.steps;this.range=this.max-this.min;this.steps=this.options.steps||this.full;this.stepSize=Math.abs(this.range)/this.steps;this.stepWidth=this.stepSize*this.full/Math.abs(this.range);this.knob.setStyle("position","relative").setStyle(this.property,-this.options.offset);d[this.axis]=this.property;c[this.axis]=[-this.options.offset,this.full-this.options.offset];this.drag=new Drag(this.knob,{snap:0,limit:c,modifiers:d,onDrag:this.draggedKnob.bind(this),onStart:this.draggedKnob.bind(this),onComplete:function(){this.draggedKnob();this.end();}.bind(this)});if(this.options.snap){this.drag.options.grid=Math.ceil(this.stepWidth);this.drag.options.limit[this.axis][1]=this.full;}},set:function(b){if(!((this.range>0)^(b<this.min))){b=this.min;}if(!((this.range>0)^(b>this.max))){b=this.max;}this.step=Math.round(b);this.checkStep();this.end();this.fireEvent("tick",this.toPosition(this.step));return this;},clickedElement:function(d){var c=this.range<0?-1:1;var b=d.page[this.axis]-this.element.getPosition()[this.axis]-this.half;b=b.limit(-this.options.offset,this.full-this.options.offset);this.step=Math.round(this.min+c*this.toStep(b));this.checkStep();this.end();this.fireEvent("tick",b);},scrolledElement:function(b){var c=(this.options.mode=="horizontal")?(b.wheel<0):(b.wheel>0);this.set(c?this.step-this.stepSize:this.step+this.stepSize);b.stop();},draggedKnob:function(){var c=this.range<0?-1:1;var b=this.drag.value.now[this.axis];b=b.limit(-this.options.offset,this.full-this.options.offset);this.step=Math.round(this.min+c*this.toStep(b));this.checkStep();},checkStep:function(){if(this.previousChange!=this.step){this.previousChange=this.step;this.fireEvent("change",this.step);}},end:function(){if(this.previousEnd!==this.step){this.previousEnd=this.step;this.fireEvent("complete",this.step+"");}},toStep:function(b){var c=(b+this.options.offset)*this.stepSize/this.full*this.steps;return this.options.steps?Math.round(c-=c%this.stepSize):c;},toPosition:function(b){return(this.full*Math.abs(this.min-b))/(this.steps*this.stepSize)-this.options.offset;}});var Scroller=new Class({Implements:[Events,Options],options:{area:20,velocity:1,onChange:function(b,c){this.element.scrollTo(b,c);}},initialize:function(c,b){this.setOptions(b);this.element=$(c);this.listener=($type(this.element)!="element")?$(this.element.getDocument().body):this.element;this.timer=null;this.coord=this.getCoords.bind(this);},start:function(){this.listener.addEvent("mousemove",this.coord);},stop:function(){this.listener.removeEvent("mousemove",this.coord);this.timer=$clear(this.timer);},getCoords:function(b){this.page=(this.listener.get("tag")=="body")?b.client:b.page;if(!this.timer){this.timer=this.scroll.periodical(50,this);}},scroll:function(){var c=this.element.getSize(),b=this.element.getScroll(),f=this.element.getPosition(),e={x:0,y:0};for(var d in this.page){if(this.page[d]<(this.options.area+f[d])&&b[d]!=0){e[d]=(this.page[d]-this.options.area-f[d])*this.options.velocity;}else{if(this.page[d]+this.options.area>(c[d]+f[d])&&c[d]+c[d]!=b[d]){e[d]=(this.page[d]-c[d]+this.options.area-f[d])*this.options.velocity;}}}if(e.y||e.x){this.fireEvent("change",[b.x+e.x,b.y+e.y]);}}});var Accordion=new Class({Extends:Fx.Elements,options:{display:0,show:false,height:true,width:false,opacity:true,fixedHeight:false,fixedWidth:false,wait:false,alwaysHide:false},initialize:function(){var d=Array.link(arguments,{container:Element.type,options:Object.type,togglers:$defined,elements:$defined});this.parent(d.elements,d.options);this.togglers=$$(d.togglers);this.container=$(d.container);this.previous=-1;if(this.options.alwaysHide){this.options.wait=true;}if($chk(this.options.show)){this.options.display=false;this.previous=this.options.show;}if(this.options.start){this.options.display=false;this.options.show=false;}this.effects={};if(this.options.opacity){this.effects.opacity="fullOpacity";}if(this.options.width){this.effects.width=this.options.fixedWidth?"fullWidth":"offsetWidth";}if(this.options.height){this.effects.height=this.options.fixedHeight?"fullHeight":"scrollHeight";}for(var c=0,b=this.togglers.length;c<b;c++){this.addSection(this.togglers[c],this.elements[c]);}this.elements.each(function(f,e){if(this.options.show===e){this.fireEvent("active",[this.togglers[e],f]);}else{for(var g in this.effects){f.setStyle(g,0);}}},this);if($chk(this.options.display)){this.display(this.options.display);}},addSection:function(f,d,h){f=$(f);d=$(d);var g=this.togglers.contains(f);var c=this.togglers.length;this.togglers.include(f);this.elements.include(d);if(c&&(!g||h)){h=$pick(h,c-1);f.inject(this.togglers[h],"before");d.inject(f,"after");}else{if(this.container&&!g){f.inject(this.container);d.inject(this.container);}}var b=this.togglers.indexOf(f);f.addEvent("click",this.display.bind(this,b));if(this.options.height){d.setStyles({"padding-top":0,"border-top":"none","padding-bottom":0,"border-bottom":"none"});}if(this.options.width){d.setStyles({"padding-left":0,"border-left":"none","padding-right":0,"border-right":"none"});}d.fullOpacity=1;if(this.options.fixedWidth){d.fullWidth=this.options.fixedWidth;}if(this.options.fixedHeight){d.fullHeight=this.options.fixedHeight;}d.setStyle("overflow","hidden");if(!g){for(var e in this.effects){d.setStyle(e,0);}}return this;},display:function(b){b=($type(b)=="element")?this.elements.indexOf(b):b;if((this.timer&&this.options.wait)||(b===this.previous&&!this.options.alwaysHide)){return this;}this.previous=b;var c={};this.elements.each(function(f,e){c[e]={};var d=(e!=b)||(this.options.alwaysHide&&(f.offsetHeight>0));this.fireEvent(d?"background":"active",[this.togglers[e],f]);for(var g in this.effects){c[e][g]=d?0:f[this.effects[g]];}},this);return this.start(c);}});(function(){var NAMESPACE="log";var IE6_POSITION_FIXED=true;var bbird;var outputList;var cache=[];var state=getState();var classes={};var profiler={};var IDs={blackbird:"blackbird",checkbox:"bbVis",filters:"bbFilters",controls:"bbControls",size:"bbSize"};var messageTypes={debug:true,info:true,warn:true,error:true,profile:true};function generateMarkup(){var spans=[];for(type in messageTypes){spans.push(['<span class="',type,'" type="',type,'"></span>'].join(""));}var newNode=document.createElement("DIV");newNode.id=IDs.blackbird;newNode.style.display="none";newNode.innerHTML=['<div class="header">','<div class="left">','<div id="',IDs.filters,'" class="filters" title="click to filter by message type">',spans.join(""),"</div>","</div>",'<div class="right">','<div id="',IDs.controls,'" class="controls">','<span id="',IDs.size,'" title="contract" op="resize"></span>','<span class="clear" title="clear" op="clear"></span>','<span class="close" title="close" op="close"></span>',"</div>","</div>","</div>",'<div class="main">','<div class="left"></div><div class="mainBody">',"<ol>",cache.join(""),"</ol>",'</div><div class="right"></div>',"</div>",'<div class="footer">','<div class="left"><label for="',IDs.checkbox,'"><input type="checkbox" id="',IDs.checkbox,'" />Visible on page load</label></div>','<div class="right"></div>',"</div>"].join("");return newNode;}function backgroundImage(){var bodyTag=document.getElementsByTagName("BODY")[0];if(bodyTag.currentStyle&&IE6_POSITION_FIXED){if(bodyTag.currentStyle.backgroundImage=="none"){bodyTag.style.backgroundImage="url(about:blank)";}if(bodyTag.currentStyle.backgroundAttachment=="scroll"){bodyTag.style.backgroundAttachment="fixed";}}}function addMessage(type,content){content=(content.constructor==Array)?content.join(""):content;if(outputList){var newMsg=document.createElement("LI");newMsg.className=type;newMsg.innerHTML=['<span class="icon"></span>',content].join("");outputList.appendChild(newMsg);scrollToBottom();}else{cache.push(['<li class="',type,'"><span class="icon"></span>',content,"</li>"].join(""));}}function clear(){outputList.innerHTML="";}function clickControl(evt){if(!evt){evt=window.event;}var el=(evt.target)?evt.target:evt.srcElement;if(el.tagName=="SPAN"){switch(el.getAttributeNode("op").nodeValue){case"resize":resize();break;case"clear":clear();break;case"close":hide();break;}}}function clickFilter(evt){if(!evt){evt=window.event;}var span=(evt.target)?evt.target:evt.srcElement;if(span&&span.tagName=="SPAN"){var type=span.getAttributeNode("type").nodeValue;if(evt.altKey){var filters=document.getElementById(IDs.filters).getElementsByTagName("SPAN");var active=0;for(entry in messageTypes){if(messageTypes[entry]){active++;}}var oneActiveFilter=(active==1&&messageTypes[type]);for(var i=0;filters[i];i++){var spanType=filters[i].getAttributeNode("type").nodeValue;filters[i].className=(oneActiveFilter||(spanType==type))?spanType:spanType+"Disabled";messageTypes[spanType]=oneActiveFilter||(spanType==type);}}else{messageTypes[type]=!messageTypes[type];span.className=(messageTypes[type])?type:type+"Disabled";}var disabledTypes=[];for(type in messageTypes){if(!messageTypes[type]){disabledTypes.push(type);}}disabledTypes.push("");outputList.className=disabledTypes.join("Hidden ");scrollToBottom();}}function clickVis(evt){if(!evt){evt=window.event;}var el=(evt.target)?evt.target:evt.srcElement;state.load=el.checked;setState();}function scrollToBottom(){if(outputList){outputList.scrollTop=outputList.scrollHeight;}}function isVisible(){return(bbird.style.display=="block");}function hide(){bbird.style.display="none";}function show(){var body=document.getElementsByTagName("BODY")[0];body.removeChild(bbird);body.appendChild(bbird);bbird.style.display="block";}function reposition(position){if(position===undefined||position==null){position=(state&&state.pos===null)?1:(state.pos+1)%4;}switch(position){case 0:classes[0]="bbTopLeft";break;case 1:classes[0]="bbTopRight";break;case 2:classes[0]="bbBottomLeft";break;case 3:classes[0]="bbBottomRight";break;}state.pos=position;setState();}function resize(size){if(size===undefined||size===null){size=(state&&state.size==null)?0:(state.size+1)%2;}classes[1]=(size===0)?"bbSmall":"bbLarge";var span=document.getElementById(IDs.size);if(span!=null){span.title=(size===1)?"small":"large";span.className=span.title;}state.size=size;setState();scrollToBottom();}function setState(){var props=[];for(entry in state){var value=(state[entry]&&state[entry].constructor===String)?'"'+state[entry]+'"':state[entry];props.push(entry+":"+value);}props=props.join(",");var expiration=new Date();expiration.setDate(expiration.getDate()+14);document.cookie=["blackbird={",props,"}; expires=",expiration.toUTCString(),";"].join("");var newClass=[];for(word in classes){newClass.push(classes[word]);}if(bbird){bbird.className=newClass.join(" ");}}function getState(){var re=new RegExp(/blackbird=({[^;]+})(;|\b|$)/);var match=re.exec(document.cookie);return(match&&match[1])?eval("("+match[1]+")"):{pos:null,size:null,load:null};}function readKey(evt){if(!evt){evt=window.event;}var code=113;if(evt&&evt.keyCode==code){var visible=isVisible();if(visible&&evt.shiftKey&&evt.altKey){clear();}else{if(visible&&evt.shiftKey){reposition();}else{if(!evt.shiftKey&&!evt.altKey){(visible)?hide():show();}}}}}function addEvent(obj,type,fn){var obj=(obj.constructor===String)?document.getElementById(obj):obj;if(obj.attachEvent){obj["e"+type+fn]=fn;obj[type+fn]=function(){obj["e"+type+fn](window.event);};obj.attachEvent("on"+type,obj[type+fn]);}else{obj.addEventListener(type,fn,false);}}function removeEvent(obj,type,fn){var obj=(obj.constructor===String)?document.getElementById(obj):obj;if(obj.detachEvent){obj.detachEvent("on"+type,obj[type+fn]);obj[type+fn]=null;}else{obj.removeEventListener(type,fn,false);}}window[NAMESPACE]={toggle:function(){(isVisible())?hide():show();},resize:function(){resize();},clear:function(){clear();},move:function(){reposition();},debug:function(msg){addMessage("debug",msg);},warn:function(msg){addMessage("warn",msg);},info:function(msg){addMessage("info",msg);},error:function(msg){addMessage("error",msg);},profile:function(label){var currentTime=new Date();if(label==undefined||label==""){addMessage("error","<b>ERROR:</b> Please specify a label for your profile statement");}else{if(profiler[label]){addMessage("profile",[label,": ",currentTime-profiler[label],"ms"].join(""));delete profiler[label];}else{profiler[label]=currentTime;addMessage("profile",label);}}return currentTime;}};addEvent(window,"load",function(){var body=document.getElementsByTagName("BODY")[0];bbird=body.appendChild(generateMarkup());outputList=bbird.getElementsByTagName("OL")[0];backgroundImage();addEvent(IDs.checkbox,"click",clickVis);addEvent(IDs.filters,"click",clickFilter);addEvent(IDs.controls,"click",clickControl);addEvent(document,"keyup",readKey);resize(state.size);reposition(state.pos);if(state.load){show();document.getElementById(IDs.checkbox).checked=true;}scrollToBottom();window[NAMESPACE].init=function(){show();window[NAMESPACE].error(["<b>",NAMESPACE,"</b> can only be initialized once"]);};addEvent(window,"unload",function(){removeEvent(IDs.checkbox,"click",clickVis);removeEvent(IDs.filters,"click",clickFilter);removeEvent(IDs.controls,"click",clickControl);removeEvent(document,"keyup",readKey);});});})();var HistoryManager=(function(){var b=new Class({initialize:function(){this._currentLocation=this._getHash();var d=this;if(window.ie){this.addState=this._addStateIE;this._iframe=new Element("iframe",{src:"javascript:'<html></html>'",styles:{position:"absolute",top:"-1000px"}}).inject(document.body).contentWindow;$justForIE=function(f){d._getHash=function(){return f;};d._monitorDefault.call(d);location.hash=f;};function e(){if(d._iframe&&d._iframe.document&&d._iframe.document.body){if(!d._iframe.document.body.innerHTML){d.addState(d._currentLocation,true);}}else{setTimeout(e,50);}}e();}else{if(window.webkit419){this._form=new Element("form",{method:"get"}).inject(document.body);this._historyCounter=history.length;this._stateHistory=[];this._stateHistory[history.length]=this._getHash();this.addState=this._addStateSafari;this._monitorSafari.periodical(250,this);}else{if(window.opera){this.addState=this._addStateDefault;$justForOpera=function(){d._monitorDefault.call(d);};new Element("img",{src:"javascript:location.href='javascript:$justForOpera();';",style:"position: absolute; top: -1000px;"}).inject(document.body);}else{this.addState=this._addStateDefault;this._monitorDefault.periodical(250,this);}}}},getCurrentLocation:function(){return this._currentLocation;},_getHash:function(){return location.href.split("#")[1]||"";},_addStateIE:function(e,d){if(this._currentLocation==e&&!d){return;}this._currentLocation=e;this._iframe.document.write("<html><body onload=\"top.$justForIE('",e,"');\">Loaded</body></html>");this._iframe.document.close();},_addStateSafari:function(d){if(this._currentLocation==d){return;}this._form.setProperty("action","#"+d).submit();this._currentLocation=d;this._stateHistory[history.length]=this._getHash();this._historyCounter=history.length;},_monitorSafari:function(){if(history.length!=this._historyCounter){this._historyCounter=history.length;this._currentLocation=this._stateHistory[history.length];this.fireEvent("onHistoryChange",[this._stateHistory[history.length]]);}},_addStateDefault:function(d){if(this._currentLocation==d){return;}location.hash="#"+d;this._currentLocation=d;},_monitorDefault:function(){var d=this._getHash();if(d!=this._currentLocation){this._currentLocation=d;this.fireEvent("onHistoryChange",[d]);}}});b.implement(new Events);var c;return function(){return c?c:c=new b();};})();var Site={appPath:$("path").value,start:function(){Site.prepareFriendlies();Site.prepareTickCountdown();Site.prepareHistoryManager();log.resize();},startPlanet:function(){Site.HistoryManager.addEvent("onHistoryChange",Planet.onHistoryChanged);Planet.addTooltips();Planet.start();},prepareHistoryManager:function(){Site.HistoryManager=new HistoryManager();},onHistoryChanged:function(b){alert(b);},tickUpdateTime:1000,decrementTick:function(){var b=$("tickCountdown");var c=b.getAttribute("start");b.innerHTML=Site.parseMillis(c);b.setAttribute("start",c-Site.tickUpdateTime);},parseMillis:function(d){var f=Math.round(d/1000);var c=Math.floor(f/60);if(c>0){f=f-c*60;}if(f<=0&&c<=0){return"00:00";}var e=f;if(f<10){e="0"+f;}var b=c;if(c<10){b="0"+c;}return b+":"+e;},prepareTickCountdown:function(){if($("tickCountdown")){Site.decrementTick.periodical(Site.tickUpdateTime);Site.decrementTick();}},prepareFriendlies:function(){var b=$("searchOpponent");if(b){Site.friendlyStart(b);}},friendlyStart:function(c){var b=$("opponentId").value;var d=$(b).value;if(d!=""){Site.getPrincipalFriendlyList(d);}},logout:function(){var b=Site.appPath+"Ajax/Logout.aspx";var c=new Request.HTML({url:b,method:"get",onComplete:function(d){window.location=Site.appPath+"Login.aspx";}});if(window.ie){c.setHeader("If-Modified-Since","Sat, 1 Jan 2000 00:00:00 GMT");}c.send();},getPrincipalFriendlyList:function(c){var b=Site.appPath+"Ajax/SearchPlayer.ashx?type="+$("searchType").value+"&name="+c;Utils.ajaxRequest("get",b,$("results"),Site.searchOpponentCallBack);},searchOpponent:function(){var b=$("opponentId").value;var c=$(b).value;Site.getPrincipalFriendlyList(c);},searchOpponentCallBack:function(){var b=$("opponent");$("opponentUser").value=b.options[b.selectedIndex].value;b.addEvent("change",function(c){Site.opponentChanged();});Custom.initSelect(b);},opponentChanged:function(){var b=$("opponent");$("opponentUser").value=b.options[b.selectedIndex].value;},botOpponentChanged:function(){var b=$("botOpponent");$("opponentUser").value=b.options[b.selectedIndex].value;},selectTab:function(d){var c=$(d);var b=c.getParent();b.getElements("li").each(function(e){if(c==e){e.className="selected";$(e.id+"Content").className="visible";}else{e.className="";$(e.id+"Content").className="";}});},onUltimateChange:function(c){for(var b=0;b<selectedCheckBox.length;++b){var d=selectedCheckBox[b];if(c.id!=d){$(d).checked=false;}}},onOpponentUltimateChange:function(c){for(var b=0;b<selectedOpponentCheckBox.length;++b){var d=selectedOpponentCheckBox[b];if(c.id!=d){$(d).checked=false;}}},onBattleTypeChange:function(c){for(var b=0;b<selectedBattleTypeCheckBox.length;++b){var d=selectedBattleTypeCheckBox[b];if(c.id!=d){$(d).checked=false;}}},viewPlayer:function(){var b=$("opponentUser").value;if(b!=""){window.location=Site.appPath+"PlayerInfo.aspx?PlayerStorage="+b;}else{Message.raiseAlert("SelectPlayerFirst");}},changeCastState:function(c){var e=$(c+"HasVoted");var d=$(c+"CastVote");e.className="red";e.innerHTML=Language.getToken("Yes");d.dispose();var b=window.open("VotePage.aspx?vote="+c);},lores:["previewLightHumans","previewDarkHumans","previewBugs"],changeRace:function(d,b){var c=$(d+"Lore");if(b.indexOf("Hover")>-1){Site.lores.each(function(e){$(e).className=e;$(e+"Lore").removeClass("loreVisible");});$(d).className=b;c.addClass("loreVisible");}}};window.addEvent("domready",Site.start);var Tutorial={getPanel:function(){return $("tutorial");},show:function(b){if(window.overrideTutorial!=null){b=window.overrideTutorial;}if(this[b]!=null){Information.leftInfofixed=true;this[b]();}else{this.showNoTutorial();}},hide:function(){this.getPanel().setStyle("display","none");this.autoNext=null;Information.leftInfofixed=false;},start:function(){if(window.autoStartTutorial!=null){Tutorial.show(window.autoStartTutorial);}},advance:function(){var b=this.autoNext;this.autoNext=null;if(b!=null){window.tutorialEnabled=true;this[b]();}},CheckpointQuest:function(){this.showPanel({titleToken:"QuestsTutorial",contentToken:"QuestsTutorialContent",refElemId:$("quests"),offsetX:250,offsetY:-150,width:500,next:"End"});},TaskQuest:function(){this.showPanel({titleToken:"QuestsTutorial",contentToken:"QuestsTaskContent",refElemId:$("quests"),offsetX:250,offsetY:-150,width:500,next:"End"});},Home:function(){this.showPanel({titleToken:"HomeTutorial",contentToken:"HomeTutorialContent",refElemId:$("genericMessages"),offsetX:80,offsetY:0,width:500,arrow:"top",next:"HomeAH"});},HomeAH:function(){this.showPanel({titleToken:"HomeTutorial",contentToken:"HomeTutorialContent2",refElemId:$("ahAd"),offsetX:-300,offsetY:-90,width:250,arrow:"right",previous:"Home",next:"HomeCharts"});},HomeCharts:function(){this.showPanel({titleToken:"HomeTutorial",contentToken:"HomeTutorialContentCharts",refElemId:$("charts"),offsetX:-300,offsetY:-90,width:250,arrow:"right",previous:"HomeAH",next:"End"});},Battle:function(){this.showPanel({titleToken:"BattleTutorial",contentToken:"BattleContent",refElemId:$("battleField"),offsetX:40,offsetY:25,width:400,next:"BattleSelect"});},BattleSelect:function(){this.showPanel({titleToken:"BattleTutorial",contentToken:"BattleSelectContent",refElemId:$("battleField"),offsetX:40,offsetY:150,width:400,follow:false,arrow:"bottom"});this.autoNext="BattleUnitSelected";},BattleUnitSelected:function(){this.showPanel({titleToken:"BattleTutorial",contentToken:"BattleUnitSelectedContent",refElemId:$("battleField"),offsetX:-10,offsetY:-90,width:400,arrow:"left",next:"BattleUnitSelectedStrong"});},BattleUnitSelectedStrong:function(){this.showPanel({titleToken:"BattleTutorial",contentToken:"BattleUnitSelectedStrongContent",refElemId:$("battleField"),offsetX:-10,offsetY:40,width:400,follow:false,arrow:"left",previous:"BattleUnitSelected",next:"BattleUnitSelectedWeak"});},BattleUnitSelectedWeak:function(){this.showPanel({titleToken:"BattleTutorial",contentToken:"BattleUnitSelectedWeakContent",refElemId:$("battleField"),offsetX:-10,offsetY:155,width:400,follow:false,arrow:"left",previous:"BattleUnitSelectedStrong",next:"BattleUnitSelectedAttack"});},BattleUnitSelectedAttack:function(){this.showPanel({titleToken:"BattleTutorial",contentToken:"BattleUnitSelectedAttackContent",refElemId:$("battleField"),offsetX:-10,offsetY:250,width:400,arrow:"left",previous:"BattleUnitSelectedWeak",next:"BattleUnitSelectedMov"});},BattleUnitSelectedMov:function(){this.showPanel({titleToken:"BattleTutorial",contentToken:"BattleUnitSelectedMovContent",refElemId:$("battleField"),offsetX:-10,offsetY:375,width:400,arrow:"left",previous:"BattleUnitSelectedAttack",next:"BattleUnitSelectedMovPoints"});},BattleUnitSelectedMovPoints:function(){this.showPanel({titleToken:"BattleTutorial",contentToken:"BattleUnitSelectedMovPointsContent",refElemId:$("battleField"),offsetX:50,offsetY:15,width:400,arrow:"right"});this.autoNext="BattleUnitSelectedMovPoints2";},BattleUnitSelectedMovPoints2:function(){this.showPanel({titleToken:"BattleTutorial",contentToken:"BattleUnitSelectedMovPoints2Content",refElemId:$("battleField"),offsetX:50,offsetY:15,width:400,arrow:"right",next:"BattleUnitSplit"});},BattleUnitSplit:function(){this.showPanel({titleToken:"BattleTutorial",contentToken:"BattleUnitSplitContent",refElemId:$("battleField"),offsetX:50,offsetY:75,width:400,arrow:"right",previous:"BattleUnitSelectedMovPoints2",next:"BattleUnitDirection"});},BattleUnitDirection:function(){this.showPanel({titleToken:"BattleTutorial",contentToken:"BattleUnitDirectionContent",refElemId:$("battleField"),offsetX:50,offsetY:280,width:400,arrow:"right",previous:"BattleUnitSplit",next:"BattleCalculator"});},BattleCalculator:function(){this.showPanel({titleToken:"BattleTutorial",contentToken:"BattleCalculatorContent",refElemId:$("battleField"),offsetX:40,offsetY:250,width:400,arrow:"bottom",previous:"BattleUnitDirection",next:"BattleOptions"});},BattleOptions:function(){this.showPanel({titleToken:"BattleTutorial",contentToken:"BattleOptionsContent",refElemId:$("battleField"),offsetX:40,offsetY:-85,width:400,arrow:"right",previous:"BattleCalculator",next:"End"});},RegicideDeploy:function(){this.showPanel({titleToken:"BattleDeployTutorial",contentToken:"RegicideDeployContent",refElemId:$("battleField"),offsetX:40,offsetY:-90,width:400,next:"BattleDeploy"});},BattleDeploy:function(){this.showPanel({titleToken:"BattleDeployTutorial",contentToken:"BattleDeployContent",refElemId:$("battleField"),offsetX:40,offsetY:-90,width:400,next:"BattleDeploySelect"});},BattleDeploySelect:function(){this.showPanel({titleToken:"BattleDeployTutorial",contentToken:"BattleDeploySelectContent",refElemId:$("initialContainers"),offsetX:40,offsetY:-180,width:400,arrow:"bottom"});this.autoNext="BattleDeployDrop";},BattleDeployDrop:function(){this.showPanel({titleToken:"BattleDeployTutorial",contentToken:"BattleDeployDropContent",refElemId:$("battleField"),offsetX:40,offsetY:150,width:400,arrow:"bottom"});this.autoNext="BattleDeployDropNext";},BattleDeployDropNext:function(){this.showPanel({titleToken:"BattleDeployTutorial",contentToken:"BattleDeployDropNextContent",refElemId:$("battleField"),offsetX:40,offsetY:80,width:400,arrow:"right",next:"BattleDeployFinish"});},BattleDeployFinish:function(){this.showPanel({titleToken:"BattleDeployTutorial",contentToken:"BattleDeployFinishContent",refElemId:$("battleField"),offsetX:40,offsetY:-50,width:400,arrow:"right",next:"End"});},PrivateZone:function(){this.showPanel({titleToken:"PrivateZoneTutorial",contentToken:"PrivateZoneTutorialContent",refElemId:$("universe"),offsetX:180,offsetY:0,width:400,next:"HomePlanet"});},HomePlanet:function(){this.showPanel({titleToken:"PrivateZoneTutorial",contentToken:"HomePlanetContent",refElemId:$("universe"),offsetX:225,offsetY:-55,arrow:"left",width:300,previous:"PrivateZone",next:"YourFirstFleet"});},YourFirstFleet:function(){this.showPanel({titleToken:"PrivateZoneTutorial",contentToken:"YourFirstFleetContent",refElemId:$("universe"),offsetX:80,offsetY:-60,arrow:"top",width:300,previous:"HomePlanet",next:"MoveFleet"});},MoveFleet:function(){this.showPanel({titleToken:"PrivateZoneTutorial",contentToken:"MoveFleetContent",refElemId:$("universe"),offsetX:280,offsetY:0,width:300,previous:"YourFirstFleet",next:"End"});},BugsPlanets:function(){this.LightHumansPlanets();this["LHMainFacilityPanelX"]=0;this["LHBuildPanelX"]=185;this["LHBuildPanelY"]=220;this["LHBuildingInConstructionX"]=150;},DarkHumansPlanets:function(){this.LightHumansPlanets();this["LHMainFacilityPanelX"]=0;this["LHBuildPanelX"]=135;this["LHBuildPanelY"]=270;this["LHBuildingInConstructionX"]=150;},LightHumansPlanets:function(){this.showPanel({titleToken:"PlanetsTutorial",contentToken:"PlanetsTutorialContent",refElemId:$("tutRef"),offsetX:135,offsetY:0,width:400,next:"LHResourcesPanel"});},LHResourcesPanel:function(){this.showPanel({titleToken:"PlanetsTutorial",contentToken:"ResourcesPanelContent",refElemId:$("playerResources"),offsetX:296,offsetY:-80,arrow:"top",width:400,previous:"LightHumansPlanets",next:"LHIncomePanel"});},LHIncomePanel:function(){this.showPanel({titleToken:"PlanetsTutorial",contentToken:"IncomeContent",refElemId:$("tutRef"),offsetX:225,offsetY:115,arrow:"right",width:400,previous:"LHResourcesPanel",next:"LHMainFacilityPanel"});},LHMainFacilityPanel:function(){var b=this["LHMainFacilityPanelX"]!=null?this["LHMainFacilityPanelX"]:-74;this.showPanel({titleToken:"PlanetsTutorial",contentToken:"MainFacilityContent",refElemId:$("tutRef"),offsetX:b,offsetY:0,arrow:"right",width:200,previous:"LHIncomePanel",next:"LHBuildPanel"});},LHBuildPanel:function(){var b=this["LHBuildPanelX"]!=null?this["LHBuildPanelX"]:15;var c=this["LHBuildPanelY"]!=null?this["LHBuildPanelY"]:200;this.showPanel({titleToken:"PlanetsTutorial",contentToken:"BuildFacilityContent",refElemId:$("tutRef"),offsetX:b,offsetY:c,arrow:"right",follow:false,width:200});this.autoNext="LHBuildUpgradeScreen";},LHBuildUpgradeScreen:function(){this.showPanel({titleToken:"PlanetsTutorial",contentToken:"BuildFacilityScreenContent",refElemId:$("tutRef"),offsetX:138,offsetY:0,width:400,next:"LHBuildUpgradeAction"});},LHBuildUpgradeAction:function(){this.showPanel({titleToken:"PlanetsTutorial",contentToken:"BuildFacilityActionContent",refElemId:$("tutRef"),offsetX:215,offsetY:75,arrow:"right",follow:false,width:200});this.autoNext="LHBuildingInConstruction";},LHBuildingInConstruction:function(){var b=this["LHBuildingInConstructionX"]!=null?this["LHBuildingInConstructionX"]:15;this.showPanel({titleToken:"PlanetsTutorial",contentToken:"LHBuildingInConstructionContent",refElemId:$("tutRef"),offsetX:b,offsetY:200,width:200,next:"LHGoToFleets"});},LHGoToFleets:function(){this.showPanel({titleToken:"PlanetsTutorial",contentToken:"LHGoToFleetsContent",refElemId:$("tutRef"),arrow:"left",offsetX:530,offsetY:-125,width:200});this.autoNext="OnFleetsScreen";},OnFleetsScreen:function(){this.showPanel({titleToken:"PlanetsTutorial",contentToken:"OnFleetsScreenContent",refElemId:$("tutRef"),offsetX:138,offsetY:0,width:400,next:"MoveUnitsFromFleets"});},MoveUnitsFromFleets:function(){this.showPanel({titleToken:"PlanetsTutorial",contentToken:"MoveUnitsFromFleetsContent",refElemId:$("tutRef"),offsetX:138,offsetY:0,width:400,next:"End"});},End:function(){this.showPanel({titleToken:"TutorialEnd",contentToken:"TutorialEndContent",refElemId:$("siteFooter"),offsetX:600,offsetY:-170});Information.leftInfofixed=false;},showNoTutorial:function(){this.showPanel({titleToken:"NoTutorial",contentToken:"NoTutorialContent",refElemId:$("siteFooter"),offsetX:600,offsetY:-170,follow:false});},showPanel:function(k){if(window.tutorialEnabled!=null&&!window.tutorialEnabled){return;}var c=this.getPanel();var j=$("tutorialContent");var q=$("middlet");var l="followtutorial_"+k.contentToken;var f=c.getFirst();f.id=l;f.name=l;j.innerHTML=Language.getToken(k.contentToken);$("tutorialTitle").innerHTML=Language.getToken(k.titleToken);$("left").setStyle("display","none");$("right").setStyle("display","none");$("top").setStyle("display","none");$("bottom").setStyle("display","none");if(k.arrow!=null){$(k.arrow).setStyle("display","block");}var h=$(k.refElemId);var n=h.getPosition();var g=k.offsetX?k.offsetX:0;var e=k.offsetY?k.offsetY:0;var d=k.width?k.width:300;var p=d+66;var o=k.height?k.height:"auto";c.setStyles({display:"block",top:n.y+e,left:n.x+g,width:p,height:o});q.setStyles({width:d,height:o});if(k.next!=null||k.previous!=null){var b="<div class='nav'>";if(k.previous!=null){b+="<a class='nav' href='javascript:Tutorial."+k.previous+"();'>"+Language.getToken("Previous")+"</a>";}if(k.next!=null){b+="<a class='nav' href='javascript:Tutorial."+k.next+"();'>"+Language.getToken("Next")+"</a>";}b+="</div>";j.innerHTML+=b;}if((k.follow!=null&&k.follow)||k.follow==null){window.location.hash="#"+l;}}};window.addEvent("domready",Tutorial.start);var AttackUtils={attack:function(){if(globalCounter==1){RaiseError.attackFirstMove();return;}var b=lastSelection.isUltimateUnit();if(b&&!movesObj.hasValidMoves(6)){RaiseError.ultimateUnitAttack();Information.fixed=false;return;}if(!lastSelection.hasAttacked){lastSelection.hasAttacked=true;Utils.registerAttack(lastSelection,currentEnemy);$("enemy").className="invisible";movesObj.decrementMoves(lastSelection.unit().attackCost);lastSelection.setClass("");lastSelection=null;Information.eraseAttackInfo();Information.fixed=false;}},canAttack:function(g){if(lastSelection!=null&&!lastSelection.hasAttacked){var d=lastSelection.unit();if(!d.canAttack){return false;}var e=lastSelection.id.split("_");var c=d.range;var f=new Attack(e,g,c,d);var b=f[lastSelection.getPosition()]();if(b){Information.fillAttackInfo(e,g);}return b;}return false;},calculatePenalty:function(b,d,f){var e=AttackUtils.penalty(d,f);if(e<4){return b;}var c=(7-e)*0.25;return Math.round((c*b)+0.5);},calculatePenaltyByDistance:function(b,d){if(d<4){return b;}var c=(7-d)*0.25;return Math.round((c*b)+0.5);},penalty:function(e,g){var c=Number(e[0]);var b=Number(e[1]);var f=Number(g[0]);var d=Number(g[1]);if(c==9){return Math.abs(c-f);}if(b==d){return Math.abs(c-f);}return Math.abs(b-d);},addBonusAttack:function(b,e,d,c){e+=AttackUtils.addUp(b.attackTargets,d.name);e+=AttackUtils.addUp(b.attackTargets,d.category);e+=AttackUtils.addUp(b.attackTargets,c);e+=AttackUtils.addUp(b.attackTargets,d.level);e+=AttackUtils.addUp(b.attackTargets,d.type);return e;},addBonusDefense:function(b,c,e,d){c+=AttackUtils.addUp(b.defenseTargets,e.name);c+=AttackUtils.addUp(b.defenseTargets,e.category);c+=AttackUtils.addUp(b.defenseTargets,d);c+=AttackUtils.addUp(b.defenseTargets,e.level);c+=AttackUtils.addUp(b.defenseTargets,e.type);return c;},addBonusRange:function(c,b,e,d){b+=AttackUtils.addUp(c.rangeTargets,e.name);b+=AttackUtils.addUp(c.rangeTargets,e.category);b+=AttackUtils.addUp(c.rangeTargets,d);b+=AttackUtils.addUp(c.rangeTargets,e.level);b+=AttackUtils.addUp(c.rangeTargets,e.type);return b;},getAttack:function(c,b){return AttackUtils.addBonusAttack(this,this.baseAttack,c,b);},getDefense:function(c,b){return AttackUtils.addBonusDefense(this,this.baseDefense,c,b);},getRange:function(c,b){return AttackUtils.addBonusRange(this,this.range,c,b);},addUp:function(d,c){if(d==null){return 0;}var b=d[c];if(b==null){return 0;}return b;},ultimateUnitAttackCoord:function(){if(Utils.numberOfPlayers()==2){return 9;}return 13;}};var Information={fixed:false,leftInfofixed:false,fillAll:function(e){var b=e.unitName();var c=e.unit();var d=e.getQuantity();if($("battleCalculator")&&!Information.fixed){Information.fillCalculator(c,d,c.range);}if(!this.fillEnabled()||Information.leftInfofixed){return;}Information.fill("shipType",c.name);Information.fill("baseAttack",c.baseAttack);Information.fill("baseDefense",c.baseDefense);Information.fill("movementCost",c.movementCost);Information.fill("range",c.range);Information.fillRemainDefense(e,c);if(c.category=="Ultimate"){Information.fill("unitQuant",1);}else{Information.fill("unitQuant",d);}if(Utils.numberOfPlayers()==2){Information.fillSpecials(e,c);Information.fillStrongAgainst(c);Information.fillWeakerAgainst(c);HowTo.resolveHowToMove(c);HowTo.resolveHowToAttack(c);}},fillRemainDefense:function(d,c){var b=BattleElements[d.id];if(b!=null){Information.fill("hitPoints",b.remainingDefense);}else{Information.fill("hitPoints",c.baseDefense);}},fillByElement:function(b){if(!this.fillEnabled()){return;}if(Utils.hasChilds(b)){Information.fillAll(Utils.getItem(b));}},fill:function(d,c){var b=$(d);if(b!=null){if(b.hasChildNodes()){b.empty();}b.appendText(c);}},fillEnabled:function(){return $("leftBattleMenu")!=null;},fillSpecials:function(d,c){var b=$("specials");if(b!=null&&b.hasChildNodes()){b.empty();}if(d.hasAttacked){Information.insertIcon(b,"cantAttack");}else{Information.insertIcon(b,"attack");}Information.fillAbilities(b,c);},fillAbilities:function(c,b){if(b.strikeBack){Information.insertIcon(c,"strikeBack");}if(b.catapult){Information.insertIcon(c,"catapult");}if(b.triple){Information.insertIcon(c,"triple");}if(b.replicator){Information.insertIcon(c,"replicator");}if(b.rebound){Information.insertIcon(c,"rebound");}if(b.removeAbility){Information.insertIcon(c,"removeAbility");}if(b.bomb){Information.insertIcon(c,"bomb");}if(b.infestation){Information.insertIcon(c,"infestation");}if(b.paralyse){Information.insertIcon(c,"paralyse");}},fillAttackInfo:function(n,f){var g=$(n[0]+"_"+n[1]).firstChild;var b=lastSelection.unit();var c=boardInformation.terrain;var j=Number(lastSelection.getQuantity());var k=Utils.getItem($(f[0]+"_"+f[1]));var e=k.unit();var o=k.getQuantity();var h=j*b.getAttack(e,c);h=AttackUtils.calculatePenalty(Math.round(h),n,f);var l=h/e.getDefense(b,c)-0.5;Information.fill("damage",Math.round(l));},eraseAttackInfo:function(){Information.fill("damage","");},insertIcon:function(e,c){if(e==null){return;}var d=$("imagePath").value+"/Icons/"+c+".gif";var b=new Element("img",{src:d,alt:"",title:""});e.appendChild(b);},fillStrongAgainst:function(c){var d=Information.getStrongElements(c);var b=Information.findWeakerUnits(d);Information.renderImages(b,"strongAgainst");},fillWeakerAgainst:function(c){var d=[c.level,c.type,c.category];var b=Information.findStrongerUnits(d);Information.renderImages(b,"weakerAgainst");},findWeakerUnits:function(d){var c=[];var b=["level","type","category"];boardInformation.enemyUnits.each(function(e,f){b.each(function(j,g){var h=Unit[e][j];if(d.contains(h)){c.include(e);}});});return c;},findStrongerUnits:function(b){var c=[];boardInformation.enemyUnits.each(function(d,e){for(var f in Unit[d].attackTargets){if(b.contains(f)){c.include(d);break;}}});return c;},getStrongElements:function(b){var d=[];for(var c in b.attackTargets){d.include(c);}return d;},renderImages:function(d,c){var b=$(c);b.empty();d.each(function(f,e){Information.renderUnitImage(f,b);});},renderUnitImage:function(j,c){var b=Unit[j].name;var f=$("imagePath").value;var g=f+"/Units/"+b.toLowerCase()+".png";var h=new Element("img",{src:g,title:name,alt:name,"class":"unitSmall"});var e="../Manual.aspx?path=Unit/"+b+".aspx";var d=new Element("a",{href:e});d.adopt(h);c.adopt(d);},renderUnitImageForManual:function(j,c){var b=Unit[j].name;var f=$("imagePath").value;var g=f+"/Units/"+b.toLowerCase()+".png";var h=new Element("img",{src:g,title:name,alt:name,"class":"unitSmall"});var e="../Manual.aspx?path=Unit/"+b+".aspx";var d=new Element("a",{href:e});d.adopt(h);c.adopt(d);},renderImage:function(c,b,g,h){var d=$("imagePath").value;if(h.length==0){h="/";}else{h="/"+h+"/";}var e=d+h+c.toLowerCase()+"."+g;var f=new Element("img",{src:e,title:c,"class":"unitSmall"});b.adopt(f);},fillCalculator:function(d,e,b){if(b<0||b>d.range){b=d.range;}var c=$("elementSelectedImg");c.empty();Information.renderImage(d.name,c,"png","Units");$("elementSelectedQuantInput").value=e;$("elementSelectedRangeInput").value=b;$("enemyElements").getElements("div").each(function(g){var f=g.childNodes;if(f.length==2){Information.fillElementDestroyed(f,g,d,e,b);}});},fillElementDestroyed:function(c,n,l,e,g){var j=c[0].getAttribute("type");var h=Unit[j];var d=l.getAttack(h,boardInformation.terrain)*e;var f=h.getDefense(l,boardInformation.terrain);d=AttackUtils.calculatePenaltyByDistance(Math.round(d),g);var k=Math.round((d/f)-0.5);var b=c[1];b.empty();if(k>10000){b.appendText("9999+");}else{b.appendText(k);}},getCalculatorSelectElementUnit:function(){var b=$("elementSelectedImg").getFirst().getAttribute("title").toLowerCase();return Unit[b];},fillCalculatorEvent:function(c,g){g.stop();var h=parseInt(c.value);var b=$("elementSelectedRangeInput").value;var f=c.value.length;if(isNaN(h)||f>4){Information.eraseLastChar(c,f);}else{if(f!=0){var d=Information.getCalculatorSelectElementUnit();Information.fillCalculator(d,h,b);}}},fillCalculatorRangeEvent:function(c,g){g.stop();var h=$("elementSelectedQuantInput").value;var b=parseInt(c.value);var f=c.value.length;if(isNaN(b)||f>1){Information.eraseLastChar(c,f);}else{if(f!=0){var d=Information.getCalculatorSelectElementUnit();Information.fillCalculator(d,h,b);}}},eraseLastChar:function(b,c){if(c!=0){b.value=b.value.substring(0,c-1);}}};var HowTo={moveImg:"arrow",attackImg:"enemy",dummyUnit:"rain",renderCenter:function(b,d){var c=$(d);c.empty();Information.renderUnitImage(b,c,"Units");},renderGifImage:function(b,c){Information.renderImage(b,$(c),"gif","Battle");},front:function(b){HowTo.renderGifImage(HowTo.moveImg,b+"b");},clearAll:function(b){$(b+"a").empty();$(b+"b").empty();$(b+"c").empty();$(b+"d").empty();$(b+"e").empty();$(b+"f").empty();$(b+"g").empty();$(b+"h").empty();},none:function(b){},drop:function(b){},all:function(b){HowTo.renderGifImage(HowTo.moveImg,b+"a");HowTo.renderGifImage(HowTo.moveImg,b+"b");HowTo.renderGifImage(HowTo.moveImg,b+"c");HowTo.renderGifImage(HowTo.moveImg,b+"d");HowTo.renderGifImage(HowTo.moveImg,b+"e");HowTo.renderGifImage(HowTo.moveImg,b+"f");HowTo.renderGifImage(HowTo.moveImg,b+"g");HowTo.renderGifImage(HowTo.moveImg,b+"h");},diagonal:function(b){HowTo.renderGifImage(HowTo.moveImg,b+"a");HowTo.renderGifImage(HowTo.moveImg,b+"c");HowTo.renderGifImage(HowTo.moveImg,b+"f");HowTo.renderGifImage(HowTo.moveImg,b+"h");},normal:function(b){HowTo.renderGifImage(HowTo.moveImg,b+"b");HowTo.renderGifImage(HowTo.moveImg,b+"d");HowTo.renderGifImage(HowTo.moveImg,b+"e");HowTo.renderGifImage(HowTo.moveImg,b+"g");},resolveHowToMove:function(b){HowTo.clearAll("hm");HowTo.renderCenter(b.name.toLowerCase(),"hmcenter");HowTo[b.movementType]("hm");},resolveHowToAttack:function(b){HowTo.clearAll("ha");HowTo.renderCenter(b.name.toLowerCase(),"hag");if(b.canAttack){if(b.range==1){$("hacenter").empty();HowTo.renderGifImage(HowTo.attackImg,"hacenter");}else{HowTo.renderGifImage(HowTo.attackImg,"hab");HowTo.renderDummyUnit(b.catapult);}}},renderDummyUnit:function(b){if(b){HowTo.renderCenter(HowTo.dummyUnit,"hacenter");}else{$("hacenter").empty();}}};if(window.AttackUtils==null){window.AttackUtils={getAttack:null,getDefense:null};}var Unit={bozer:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Bozer",code:"bz",category:"Heavy",baseAttack:3200,attackCost:1,baseDefense:2800,strikeBack:true,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:5,movementCost:4,movementType:"front",level:"Ground",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{Air:4000},defenseTargets:{},rangeTargets:{}},bz:function(){return Unit.bozer;},commanderfox:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"CommanderFox",code:"cf",category:"Heavy",baseAttack:50000,attackCost:1,baseDefense:100000,strikeBack:false,catapult:true,triple:true,replicator:false,removeAbility:false,rebound:true,infestation:false,paralyse:false,bomb:false,range:5,movementCost:4,movementType:"normal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},cf:function(){return Unit.commanderfox;},hiveprotector:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"HiveProtector",code:"hp",category:"Medium",baseAttack:1000,attackCost:1,baseDefense:4500,strikeBack:true,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:3,movementCost:2,movementType:"normal",level:"Air",type:"Organic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},hp:function(){return Unit.hiveprotector;},doomer:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Doomer",code:"doo",category:"Heavy",baseAttack:6000,attackCost:1,baseDefense:500,strikeBack:false,catapult:true,triple:false,replicator:false,removeAbility:false,rebound:true,infestation:false,paralyse:false,bomb:false,range:3,movementCost:3,movementType:"diagonal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},doo:function(){return Unit.doomer;},cypher:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Cypher",code:"cp",category:"Light",baseAttack:1500,attackCost:1,baseDefense:1500,strikeBack:false,catapult:false,triple:true,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:2,movementCost:2,movementType:"all",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},cp:function(){return Unit.cypher;},stinger:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Stinger",code:"sg",category:"Medium",baseAttack:500,attackCost:1,baseDefense:1000,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:2,movementCost:2,movementType:"all",level:"Air",type:"Organic",canAttack:true,coolDown:"0",attackTargets:{Light:1000},defenseTargets:{},rangeTargets:{}},sg:function(){return Unit.stinger;},captainwolf:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"CaptainWolf",code:"cw",category:"Heavy",baseAttack:100000,attackCost:1,baseDefense:1000000,strikeBack:false,catapult:true,triple:true,replicator:false,removeAbility:false,rebound:true,infestation:false,paralyse:false,bomb:false,range:6,movementCost:4,movementType:"normal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},cw:function(){return Unit.captainwolf;},destroyer:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Destroyer",code:"dy",category:"Medium",baseAttack:1100,attackCost:1,baseDefense:500,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:true,range:1,movementCost:2,movementType:"all",level:"Air",type:"Organic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},dy:function(){return Unit.destroyer;},myst:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Myst",code:"mt",category:"Medium",baseAttack:300,attackCost:1,baseDefense:200,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:true,infestation:false,paralyse:false,bomb:false,range:2,movementCost:1,movementType:"diagonal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},mt:function(){return Unit.myst;},scarab:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Scarab",code:"sc",category:"Medium",baseAttack:1900,attackCost:1,baseDefense:2300,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:2,movementCost:1,movementType:"front",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},sc:function(){return Unit.scarab;},toxic:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Toxic",code:"tx",category:"Light",baseAttack:450,attackCost:1,baseDefense:600,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:2,movementCost:1,movementType:"normal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{Organic:1000},defenseTargets:{},rangeTargets:{}},tx:function(){return Unit.toxic;},fist:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Fist",code:"ft",category:"Heavy",baseAttack:4200,attackCost:1,baseDefense:1800,strikeBack:false,catapult:false,triple:true,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:4,movementCost:3,movementType:"normal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},ft:function(){return Unit.fist;},flag:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Flag",code:"fg",category:"Special",baseAttack:1,attackCost:1,baseDefense:10000,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:1,movementCost:1,movementType:"all",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},fg:function(){return Unit.flag;},darktaurus:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"DarkTaurus",code:"dt",category:"Heavy",baseAttack:6800,attackCost:1,baseDefense:3500,strikeBack:false,catapult:false,triple:true,replicator:false,removeAbility:false,rebound:true,infestation:false,paralyse:false,bomb:false,range:3,movementCost:4,movementType:"front",level:"Ground",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},dt:function(){return Unit.darktaurus;},egg:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Egg",code:"eg",category:"Light",baseAttack:0,attackCost:1,baseDefense:1,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:0,movementCost:0,movementType:"none",level:"Ground",type:"Organic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},eg:function(){return Unit.egg;},jumper:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Jumper",code:"jp",category:"Light",baseAttack:200,attackCost:1,baseDefense:100,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:true,rebound:false,infestation:false,paralyse:false,bomb:false,range:1,movementCost:1,movementType:"all",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},jp:function(){return Unit.jumper;},battlemoon:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"BattleMoon",code:"bm",category:"Ultimate",baseAttack:1000000,attackCost:6,baseDefense:1000000,strikeBack:false,catapult:true,triple:false,replicator:false,removeAbility:false,rebound:true,infestation:false,paralyse:false,bomb:false,range:5,movementCost:6,movementType:"none",level:"Air",type:"Mechanic",canAttack:true,coolDown:"9",attackTargets:{},defenseTargets:{},rangeTargets:{}},bm:function(){return Unit.battlemoon;},metallicbeard:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"MetallicBeard",code:"mb",category:"Heavy",baseAttack:100000,attackCost:1,baseDefense:1000000,strikeBack:false,catapult:true,triple:true,replicator:false,removeAbility:false,rebound:true,infestation:false,paralyse:false,bomb:false,range:6,movementCost:4,movementType:"normal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},mb:function(){return Unit.metallicbeard;},darkcrusader:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"DarkCrusader",code:"dc",category:"Heavy",baseAttack:2800,attackCost:1,baseDefense:2000,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:6,movementCost:4,movementType:"front",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},dc:function(){return Unit.darkcrusader;},scourge:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Scourge",code:"so",category:"Medium",baseAttack:1450,attackCost:1,baseDefense:2000,strikeBack:false,catapult:true,triple:false,replicator:false,removeAbility:false,rebound:true,infestation:false,paralyse:false,bomb:false,range:3,movementCost:2,movementType:"diagonal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},so:function(){return Unit.scourge;},crawler:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Crawler",code:"cr",category:"Medium",baseAttack:2000,attackCost:1,baseDefense:1800,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:true,paralyse:true,bomb:false,range:3,movementCost:3,movementType:"all",level:"Ground",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{Medium:2000},defenseTargets:{},rangeTargets:{}},cr:function(){return Unit.crawler;},rain:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Rain",code:"r",category:"Light",baseAttack:120,attackCost:1,baseDefense:70,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:1,movementCost:1,movementType:"all",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{Heavy:1200},defenseTargets:{},rangeTargets:{}},r:function(){return Unit.rain;},samurai:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Samurai",code:"s",category:"Light",baseAttack:150,attackCost:1,baseDefense:450,strikeBack:false,catapult:true,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:2,movementCost:1,movementType:"all",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},s:function(){return Unit.samurai;},panther:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Panther",code:"p",category:"Light",baseAttack:300,attackCost:1,baseDefense:300,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:true,infestation:false,paralyse:false,bomb:false,range:1,movementCost:1,movementType:"all",level:"Ground",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},p:function(){return Unit.panther;},queen:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Queen",code:"q",category:"Ultimate",baseAttack:1000000,attackCost:4,baseDefense:1000000,strikeBack:true,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:4,movementCost:4,movementType:"drop",level:"Air",type:"Organic",canAttack:false,coolDown:"9",attackTargets:{},defenseTargets:{},rangeTargets:{}},q:function(){return Unit.queen;},darkrain:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"DarkRain",code:"dr",category:"Light",baseAttack:190,attackCost:1,baseDefense:20,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:1,movementCost:1,movementType:"all",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{Heavy:600},defenseTargets:{},rangeTargets:{}},dr:function(){return Unit.darkrain;},worm:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Worm",code:"w",category:"Medium",baseAttack:1200,attackCost:1,baseDefense:1200,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:3,movementCost:2,movementType:"all",level:"Ground",type:"Organic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},w:function(){return Unit.worm;},taurus:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Taurus",code:"t",category:"Heavy",baseAttack:5000,attackCost:1,baseDefense:6800,strikeBack:false,catapult:false,triple:true,replicator:false,removeAbility:false,rebound:true,infestation:false,paralyse:false,bomb:false,range:3,movementCost:4,movementType:"front",level:"Ground",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},t:function(){return Unit.taurus;},kamikaze:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Kamikaze",code:"k",category:"Medium",baseAttack:4000,attackCost:1,baseDefense:1,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:1,movementCost:1,movementType:"all",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},k:function(){return Unit.kamikaze;},pretorian:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Pretorian",code:"h",category:"Medium",baseAttack:450,attackCost:1,baseDefense:5550,strikeBack:true,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:3,movementCost:2,movementType:"diagonal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},h:function(){return Unit.pretorian;},seeker:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Seeker",code:"sk",category:"Light",baseAttack:100,attackCost:1,baseDefense:40,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:1,movementCost:1,movementType:"all",level:"Air",type:"Organic",canAttack:true,coolDown:"0",attackTargets:{Medium:500},defenseTargets:{},rangeTargets:{}},sk:function(){return Unit.seeker;},nova:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Nova",code:"n",category:"Heavy",baseAttack:2700,attackCost:1,baseDefense:1900,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:5,movementCost:4,movementType:"normal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{Organic:4000},defenseTargets:{},rangeTargets:{}},n:function(){return Unit.nova;},maggot:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Maggot",code:"m",category:"Light",baseAttack:500,attackCost:1,baseDefense:1000,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:true,range:1,movementCost:1,movementType:"all",level:"Ground",type:"Organic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},m:function(){return Unit.maggot;},blackwidow:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"BlackWidow",code:"b",category:"Heavy",baseAttack:2500,attackCost:1,baseDefense:2100,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:true,paralyse:true,bomb:false,range:4,movementCost:3,movementType:"all",level:"Ground",type:"Organic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},b:function(){return Unit.blackwidow;},crusader:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Crusader",code:"c",category:"Heavy",baseAttack:2400,attackCost:1,baseDefense:2200,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:6,movementCost:4,movementType:"front",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},c:function(){return Unit.crusader;},anubis:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Anubis",code:"a",category:"Light",baseAttack:200,attackCost:1,baseDefense:500,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:1,movementCost:1,movementType:"all",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{Heavy:1600},rangeTargets:{}},a:function(){return Unit.anubis;},hiveking:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"HiveKing",code:"hk",category:"Heavy",baseAttack:4000,attackCost:1,baseDefense:3200,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:true,rebound:false,infestation:true,paralyse:false,bomb:false,range:4,movementCost:3,movementType:"normal",level:"Ground",type:"Organic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},hk:function(){return Unit.hiveking;},kahuna:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Kahuna",code:"kh",category:"Medium",baseAttack:1000,attackCost:1,baseDefense:1300,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:true,infestation:false,paralyse:false,bomb:false,range:2,movementCost:2,movementType:"all",level:"Ground",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{Terrest:400,Air:400},rangeTargets:{}},kh:function(){return Unit.kahuna;},driller:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Driller",code:"d",category:"Medium",baseAttack:1500,attackCost:1,baseDefense:1500,strikeBack:false,catapult:false,triple:true,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:1,movementCost:2,movementType:"all",level:"Ground",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},d:function(){return Unit.driller;},eagle:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Eagle",code:"e",category:"Medium",baseAttack:1100,attackCost:1,baseDefense:1200,strikeBack:false,catapult:true,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:3,movementCost:2,movementType:"diagonal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{Medium:400},defenseTargets:{Heavy:400},rangeTargets:{}},e:function(){return Unit.eagle;},blinker:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Blinker",code:"bk",category:"Ultimate",baseAttack:1000000,attackCost:6,baseDefense:1000000,strikeBack:true,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:4,movementCost:5,movementType:"none",level:"Air",type:"Mechanic",canAttack:false,coolDown:"9",attackTargets:{},defenseTargets:{},rangeTargets:{}},bk:function(){return Unit.blinker;},sentry:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Sentry",code:"st",category:"Light",baseAttack:200,attackCost:1,baseDefense:100,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:true,rebound:false,infestation:false,paralyse:false,bomb:false,range:1,movementCost:1,movementType:"all",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},st:function(){return Unit.sentry;},vector:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Vector",code:"v",category:"Medium",baseAttack:2000,attackCost:1,baseDefense:1200,strikeBack:false,catapult:true,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:4,movementCost:3,movementType:"normal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},v:function(){return Unit.vector;},walker:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Walker",code:"wk",category:"Medium",baseAttack:2200,attackCost:1,baseDefense:1500,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:true,paralyse:false,bomb:false,range:3,movementCost:3,movementType:"all",level:"Ground",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{Heavy:2000},defenseTargets:{},rangeTargets:{}},wk:function(){return Unit.walker;},titan:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Titan",code:"tt",category:"Heavy",baseAttack:3500,attackCost:1,baseDefense:2250,strikeBack:true,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:5,movementCost:4,movementType:"normal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},tt:function(){return Unit.titan;},silverbeard:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"SilverBeard",code:"sb",category:"Heavy",baseAttack:50000,attackCost:1,baseDefense:100000,strikeBack:false,catapult:true,triple:true,replicator:false,removeAbility:false,rebound:true,infestation:false,paralyse:false,bomb:false,range:5,movementCost:4,movementType:"normal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},sb:function(){return Unit.silverbeard;},fenix:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Fenix",code:"f",category:"Heavy",baseAttack:2500,attackCost:1,baseDefense:2950,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:true,infestation:false,paralyse:false,bomb:false,range:4,movementCost:3,movementType:"normal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},f:function(){return Unit.fenix;},interceptor:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Interceptor",code:"it",category:"Light",baseAttack:100,attackCost:1,baseDefense:100,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:true,bomb:false,range:1,movementCost:1,movementType:"diagonal",level:"Air",type:"Organic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},it:function(){return Unit.interceptor;},reaper:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Reaper",code:"re",category:"Light",baseAttack:500,attackCost:1,baseDefense:250,strikeBack:false,catapult:false,triple:true,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:2,movementCost:1,movementType:"diagonal",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},re:function(){return Unit.reaper;},raptor:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Raptor",code:"rp",category:"Light",baseAttack:280,attackCost:1,baseDefense:400,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:2,movementCost:1,movementType:"all",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{Light:1000},defenseTargets:{},rangeTargets:{}},rp:function(){return Unit.raptor;},spider:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Spider",code:"sp",category:"Medium",baseAttack:1800,attackCost:1,baseDefense:2200,strikeBack:true,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:true,bomb:false,range:3,movementCost:2,movementType:"all",level:"Ground",type:"Organic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},sp:function(){return Unit.spider;},krill:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"Krill",code:"kr",category:"Medium",baseAttack:1500,attackCost:1,baseDefense:1000,strikeBack:true,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:3,movementCost:2,movementType:"all",level:"Air",type:"Mechanic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},kr:function(){return Unit.krill;},heavyseeker:{getAttack:AttackUtils.getAttack,getDefense:AttackUtils.getDefense,name:"HeavySeeker",code:"hr",category:"Heavy",baseAttack:2500,attackCost:1,baseDefense:2200,strikeBack:false,catapult:false,triple:false,replicator:false,removeAbility:false,rebound:false,infestation:false,paralyse:false,bomb:false,range:5,movementCost:4,movementType:"diagonal",level:"Air",type:"Organic",canAttack:true,coolDown:"0",attackTargets:{},defenseTargets:{},rangeTargets:{}},hr:function(){return Unit.heavyseeker;},dummy:function(){}};String.prototype.replaceAll=function(e,b){var c=this;var d=c.indexOf(e);while(d>-1){c=c.replace(e,b);d=c.indexOf(e);}return(c);};var mouseOverElement;var currentEnemy;var Utils={numberOfPlayers:function(){return $("numberOfPlayers").value;},getTdElements:function(){if(Utils.numberOfPlayers()==2){return $("board2").getElements("td");}return $("board4").getElements("td");},getBattleDiv:function(){if(Utils.numberOfPlayers()==2){return $("battle");}return $("battle4");},hasMoves:function(){return $("moves").getText()==0;},getQuantityElement:function(){return $("quantity");},getQuantity:function(){return Number($("quantity").value);},isSrcShip:function(b){if(b.hasChildNodes()){if(b.id.indexOf("_")==-1){return true;}}return false;},canMoveOverPositioning:function(e,c){Utils.hideImage("cannotMove");if(lastSelection!=null){if(lastSelection.id==e){return false;}mouseOverElement=Utils.getItem($(e));if(!Utils.coordinateValid(e)){return false;}if(mouseOverElement.isSource()){if(lastSelection.getImageName()==mouseOverElement.id){return true;}}else{var b=e.split("_");var d;if(Utils.numberOfPlayers()==2){d=b[0]==7||b[0]==8;}else{d=b[0]==11||b[0]==12;}if(d){if(mouseOverElement.hasChildNodes()){if(!lastSelection.equals(mouseOverElement)){mouseOverElement.setClass("cannotMoveAbove");return false;}mouseOverElement.setClass("canMoveAbove");}else{mouseOverElement.setClass("canMove");}return true;}}}return false;},coordinateValid:function(b){if(b=="1_1"||b=="1_2"||b=="1_11"||b=="1_12"||b=="2_1"||b=="2_2"||b=="2_11"||b=="2_12"||b=="11_1"||b=="11_2"||b=="11_11"||b=="11_12"||b=="12_1"||b=="12_2"||b=="12_11"||b=="12_12"){return false;}return true;},systemCoordinateValid:function(b){return b!=NaN&&b>=1&&b<=37;},sectorCoordinateXValid:function(b){return b!=NaN&&b>=1&&b<=7;},sectorCoordinateYValid:function(b){return b!=NaN&&b>=1&&b<=10;},canMoveOver:function(f,d){Utils.hideImage("enemy");Utils.hideImage("cannotMove");Information.eraseAttackInfo();Information.fillByElement(f.node);if(lastSelection!=null){if(lastSelection.id==f.id){return false;}mouseOverElement=f;var b=f.id.split("_");var e=mouseOverElement.isEnemyUnit();if(e&&AttackUtils.canAttack(b)){currentEnemy=mouseOverElement;Utils.showImage(mouseOverElement,"enemy",d);return false;}if(Utils.invalidBlink(f)){return false;}if(Utils.canBlink(b)||Utils.canMove(b)||lastSelection.isQueen()){var c=mouseOverElement.isFriendlyUnit();if(e||c){Utils.showImage(mouseOverElement,"cannotMove",d);return false;}if(mouseOverElement.hasChildNodes()&&!lastSelection.equals(mouseOverElement)){Utils.showImage(mouseOverElement,"cannotMove",d);return false;}if(lastSelection.isQueen()){if(f.canDeployEgg()){mouseOverElement.setClass("canMove");return true;}Utils.showImage(mouseOverElement,"cannotMove",d);return false;}mouseOverElement.setClass("canMove");return true;}}return false;},canMoveOut:function(){if(mouseOverElement!=null){if(Utils.numberOfPlayers()==2||(Utils.numberOfPlayers()==4&&Utils.coordinateValid(mouseOverElement.id))){if(!mouseOverElement.isEnemyUnit()&&!mouseOverElement.isFriendlyUnit()&&!Utils.overCurrentElement()){mouseOverElement.setClass("");}mouseOverElement=null;}}},overCurrentElement:function(){if(lastSelection!=null&&lastSelection.id==mouseOverElement.id){return true;}if(blinkSelection!=null&&blinkSelection.id==mouseOverElement.id){return true;}return false;},canMove:function(e){if(blinkSelection!=null){return false;}var c=lastSelection.unit().movementType;if(c==""){return false;}var d=lastSelection.id.split("_");var b=movesObj[c](d,e);if(Utils.numberOfPlayers()==4){return b&&Utils.coordinateValid(mouseOverElement.id);}return b;},canBlink:function(c){var b=lastSelection.id.split("_");return blinkSelection!=null&&movesObj.blink(b,c);},invalidBlink:function(b){return blinkSelection!=null&&Utils.numberOfPlayers()==2&&b.id=="9_9";},registerMove:function(d,e,c,b){$("movesMade").value+="m:"+d.id+"-"+e.id+"-"+c+"-"+b+";";},registerBlink:function(d,e,c,b){$("movesMade").value+="bk:"+d.id+"-"+e.id+"-"+c+"-"+b+";";},registerEgg:function(b){$("movesMade").value+="e:"+b.id+";";},registerAttack:function(b,c){$("movesMade").value+="b:"+b.id+"-"+c.id+";";},registerRotation:function(d,c,b){$("movesMade").value+="r:"+d.id+"-"+c+"-"+b+";";},createSpecialMoveImage:function(f,c,e){var d=f.node.getFirst().title;var b=new Element("img",{id:c,src:e,title:d});b.inject($("battle"));Utils.showImage(f,c);return b;},initSpecialMoveImages:function(d){var g=$("battle");if(g==null||$("battle").hasClass("preview")){return;}for(var b in BattleElements){var c=Utils.getItem($(b));var f=BattleElements[b];if(f.paralysed!=null){Utils.createParalyseImage(b,c,d);}if(f.infestated==true){Utils.createInfestationImage(b,c);}}},createParalyseImage:function(c,e,d){var b=Utils.createSpecialMoveImage(e,c+"paralysed",Utils.resolveBattleImage("Paralyse"));if(!Battle.isSpectator()){b.addEvent("click",function(f){if(lastSelection!=null){Battle.selected($(this.parentId),f);return;}if(d){RaiseError.paralysed();}});}},createInfestationImage:function(c,d){var b=Utils.createSpecialMoveImage(d,c+"infestated",Utils.resolveBattleImage("Infestation"));if(!Battle.isSpectator()){b.parentId=c;b.addEvent("click",function(f){Battle.selected($(this.parentId),f);});}},updateSpecialEffectsImages:function(b,d){var c=BattleElements[d.id];if(c.infestated==true){$(b.id+"infestated").dispose();Utils.createInfestationImage(d.id,d);}},getAbsX:function(b){return parseInt(b.x)?b.x:Utils.getAbsPos(b,"Left");},getAbsY:function(b){return parseInt(b.y)?b.y:Utils.getAbsPos(b,"Top");},getAbsPos:function(b,c){iPos=0;while(b!=null){iPos+=b["offset"+c];b=b.offsetParent;}return iPos;},hideImage:function(b){$(b).className="invisible";},showImage:function(e,d,c){var f=e.node;var b=$(d);x=Utils.getAbsX(f);y=Utils.getAbsY(f);b.style.left=x+2+"px";b.style.top=y+2+"px";b.className="visible";if(c!=null){c.cancelBubble=true;}},getItem:function(b){var c=b.item;if(c==null){c=new Item(b);b.item=c;}return c;},hasChilds:function(b){return b.hasChildNodes()&&b.getFirst().get("tag")!="span";},queryString:function(c){c=c.toLowerCase();var b=window.location.search.substring(1).toLowerCase();var f=b.split("&");for(var e=0;e<f.length;++e){var d=f[e].split("=");if(d[0]==c){return d[1];}}},resetSelection:function(b){if(b!=null){b.setClass("");}if(lastSelection!=null){lastSelection.setClass("");lastSelection=null;}},ajaxRequest:function(f,b,c,e){if(c){Utils.setLoadingElement(c);}var d=new Request.HTML({url:b,method:f,update:c,onComplete:e,cache:false});if(Browser.Engine.trident){d.setHeader("If-Modified-Since","Sat, 1 Jan 2000 00:00:00 GMT");}d.send();},simpleLoadAjaxGet:function(b,c,e){if(c){Utils.setSimpleLoadingElement(c);}var d=new Request.HTML({url:b,method:"get",update:c,onComplete:e,cache:false});if(Browser.Engine.trident){d.setHeader("If-Modified-Since","Sat, 1 Jan 2000 00:00:00 GMT");}d.send();},simpleLoadAjaxPost:function(b,c,f,e){if(c){Utils.setSimpleLoadingElement(c);}var d=new Request.HTML({url:b,method:"post",update:c,onComplete:f,cache:false});if(Browser.Engine.trident){d.setHeader("If-Modified-Since","Sat, 1 Jan 2000 00:00:00 GMT");}d.send(e);},setLoadingElement:function(d){var b=d.offsetWidth;var e=d.offsetHeight;var f=d.getCoordinates();var j=new Element("div",{id:"loading",styles:{width:b,height:e,left:f.left,top:f.top}});j.inject(d);var c=new Element("div",{classname:"loadingBck"});var g=new Element("div",{classname:"loadingImg"});g.inject(c);c.inject(j);},setSimpleLoadingElement:function(b){var c=new Element("div",{id:"simpleLoader"});b.empty();c.inject(b);},insertTip:function(c,e,d){var b=new Tips(c,{initialize:function(){},onShow:function(f){Utils.hideAllTips();f.set({styles:{opacity:1}});},onHide:function(f){f.set({styles:{opacity:0}});}});c.store(e,d);c.store("tip:title",e);c.store("tip:text",d);c.tip=b;},updateTip:function(b,c){b.store("tip:text",c);},insertFixedTip:function(c,e,d){var b=new Tips(c);c.store(e,d);c.store("tip:title",e);c.store("tip:text",d);},hideAllTips:function(){$$(".tip-top").each(function(b){b.getParent().set({styles:{opacity:0}});});},getForm:function(){var b=$(document.forms[0]);if(b==null){throw ("No Form Found!");}return b;},doAction:function(c,f,e,b){var d=Utils.getForm();if(true==b&&!Message.raiseConfirm("AreYouSure")){return;}d.doAction_type.value=c;d.doAction_action.value=f;d.doAction_data.value=e;d.submit();},checkAndNotifyStringNotEmpty:function(b){if(b==null||b==""){Message.raiseAlert("NoInputProvided");return false;}return true;},resolveUnitImage:function(b){return $("imagePath").value+"/Units/"+b.toLowerCase()+".png";},resolveBattleImage:function(b){return $("imagePath").value+"/Battle/"+b+".png";},resolveResourceImage:function(b){return $("imagePath").value+"/Resources/"+b+".png";},resolveFacilitiesImage:function(c,b){return $("imagePath").value+"/Planets/"+c+"/"+b+"R.png";},resolveEtcImage:function(b,c){return $("imagePath").value+"/Etc/"+b+"."+c;},resolveImage:function(b){var c=Unit[b.toLowerCase()];if(c!=null){return Utils.resolveUnitImage(b);}return Utils.resolveResourceImage(b);},deleteAllMessages:function(){if(!Message.raiseConfirm("AreYouSure")){return;}var d="Ajax/Utils/Messages.ashx?Action=DeleteAll";var h=$("deleteAllMessages");h.oldColor=h.getStyle("color");h.oldHref=h.href;h.setStyle("color","#ADADAD");h.href="#";Utils.ajaxRequest("get",d,null,Utils.afterDeleteAllMessages);var j=$(document.body).getElements(".message");var g=null;for(var e=0;e<j.length;++e){g=j[e].getParent();j[e].dispose();}if(g==null){return;}var b=new Element("tr",{styles:{opacity:0}});var c=new Element("td",{html:Language.getToken("NoMessages")});b.inject(g);c.inject(b);var f=new Fx.Tween(b,{property:"opacity",duration:1000});f.start(1);},afterDeleteAllMessages:function(){var b=$("deleteAllMessages");b.setStyle("color",b.oldColor);b.href=b.oldHref;},redirectToPlayerPage:function(b){window.location=$("path").value+"PlayerInfo.aspx?PlayerStorage="+b;},createFrame:function(e,g,f,b,k){var c=new Element("div",{id:e});if(b.className!=null){c.addClass(b.className);}var d=new Fx.Tween(c,{property:"opacity",duration:1000});if(b.top!=null){c.setStyles({left:0,top:b.top,opacity:0});}else{var n=window.getSize();var l=(n.y-600)/2;if(l<0){l=100;}c.setStyles({left:0,top:l,opacity:0});}var h;if(b.closeEvent!=null){h=b.closeEvent;}else{h='Utils.closeFrame("'+e+'");';}c.callback=k;var j="<table id='informationTable' class='frame'>";j+="<tr><th class='frameTopLeft'></th><th class='frameTopCenter'>"+Language.getToken(g)+"</th><th class='frameTopRightCross' onclick='"+h+"'></th></tr>";j+="<tr><td class='frameMiddleLeft'></td>";j+="<td class='frameMiddleCenter messageContent'>";j+=f;j+="<td class='frameMiddleRight'></td></tr>";j+="<tr><td class='frameBottomLeft'></td><td class='frameBottomCenter'></td><td class='frameBottomRight'></td></tr></table>";c.innerHTML=j;c.inject($(document.body));d.start(1);return c;},createBorder:function(e,f,b,h){var c=new Element("div",{id:e});if(b.className!=null){c.addClass(b.className);}var d=new Fx.Tween(c,{property:"opacity",duration:1000});var g;if(b.top!=null){g=b.top;}else{var k=window.getSize();var j=(k.y-600)/2;if(j<0){j=100;}g=j;}c.setStyles({left:0,top:0,opacity:0,height:document.body.offsetHeight});c.callback=h;c.innerHTML=f;c.inject($(document.body));d.start(1);return c;},closeFrame:function(b){var c=$(b);if(c.callback!=null){c.callback();}c.dispose();},createIFrame:function(c,d,g,f,j,h){var e={className:"iframeWindow"};var b="<iframe id='iframe' src='"+d+"' frameborder='0' marginheight='0' marginwidth='0' width='"+f+"' height='"+j+"'></iframe>";Utils.createFrame(c,g,b,e,h);},changeOrionsPlan:function(e,c){var d=e.options[e.selectedIndex];var g=d.value;var b=$("scale");if(b!=null){b.value=g;}if(window.shopItemsScale!=null){var f=window.shopItemsScale[c];if(g==1){f=Math.ceil(f/3+f/10);f=Math.round(f/10)*10;}$(c+"Cost").innerHTML=f;}},getTimeFromTicks:function(g){var e=$("millisPerTick").value*g;var c=new Date(e);var k=c.getDay();var j=e/86400000;var b=c.getHours();var f=c.getMinutes();var h="";if(j>1){h+=Math.floor(j)+"d ";}if(b>0){h+=b+"h ";}if(f>0){h+=f+" m";}return h;},showAddUserMedals:function(){var b=$("userMedals");b.getElements("dd").each(function(c){c.setStyle("display","block");});},searchPlayer:function(b){var d="/";var c=$("path");if(c!=null){d=c.value;}window.location=d+"SearchPlayers.aspx?Name="+escape(b);},showHidePayment:function(){var c=$("plusSign");var b=$("bonusTable");if(c.className=="plus"){c.className="minus";$(b).removeClass("hidden");$(b).addClass("visibleRelative");}else{c.className="plus";$(b).removeClass("visibleRelative");$(b).addClass("hidden");}}};if($("imagePath")){var unitPath=$("imagePath").value+"/Units/";}function Item(b){this.id=b.id;this.node=b;this.hasAttacked=false;this.space="span";this.x=function(){return this.id.split("_")[0];};this.y=function(){return this.id.split("_")[1];};this.isSpace=function(){return this.node.firstChild.nodeName.toLowerCase()==this.space;};this.insertSpace=function(){var c=document.createElement(this.space);this.node.appendChild(c);};this.getChildId=function(){return this.node.firstChild.id;};this.getQuantity=function(){return Number(this.node.firstChild.title);};this.setQuantity=function(c){this.node.firstChild.title=c;};this.unitName=function(){return this.node.firstChild.alt;};this.unit=function(){return Unit[this.unitName()];};this.movementCost=function(){return Unit[this.node.firstChild.alt].movementCost;};this.insert=function(d,h,g){this.setClass("");if(!this.hasChildNodes()){this.node.empty();var c=d.getImageElement();var f=document.createElement("img");f.src=d.getImage();f.id=d.getChildId();f.title=h;f.alt=d.unitName();this.resolveEnemy(f,c);this.resolveFriendly(f,c);this.resolveInfestation(f,c);this.node.appendChild(f);}else{this.setQuantity(Number(this.getQuantity())+Number(h));}};this.insertSpecific=function(d,h,g){this.setClass("");if(!this.hasChildNodes()){this.node.empty();var c=d.name.toLowerCase();var f=new Element("img");f.src=Utils.resolveUnitImage(c);f.title=h;f.alt=c;this.node.appendChild(f);}};this.resolveEnemy=function(d,e){var c=e.getAttribute("isEnemy");if(c!=null){d.setAttribute("isEnemy",c);if(c=="true"){this.node.addClass("enemyBorder");}}};this.resolveFriendly=function(d,e){var c=e.getAttribute("isFriendly");if(c!=null){d.setAttribute("isFriendly",c);}};this.resolveInfestation=function(d,e){var c=e.getAttribute("isInfestated");if(c!=null){d.setAttribute("isInfestated",c);}};this.setClass=function(c){this.node.className=c;};this.getClass=function(){return this.node.className;};this.removeAll=function(){this.node.empty();this.setClass("");this.insertSpace();};this.hasChildNodes=function(){return this.node.hasChildNodes()&&!this.isSpace();};this.getImage=function(){return this.getImageElement().src;};this.getImageElement=function(){return this.node.firstChild;};this.getImageName=function(){var c=this.getImage();var e=c.split("/");var d=e[e.length-1].split(".");return d[0];};this.getCleanImageName=function(){var c=this.getImageName();var d=c.split("_");return d[0].toLowerCase();};this.getPosition=function(){var c=this.getImageName();var d=c.split("_");return d[1];};this.setPosition=function(d){var e=this.getCleanImageName();var c=unitPath+e+"_"+d+".png";this.node.firstChild.src=c;};this.equals=function(c){return c.unitName()==this.unitName();};this.isUltimateUnit=function(){var c=b.getFirst().getAttribute("isUltimate");return c=="true";};this.isSource=function(){return this.id.split("_").length==1;};this.parseBollAttr=function(c){if(this.hasChildNodes()){var d=this.node.firstChild;return d.getAttribute(c)=="true";}return false;};this.isEnemyUnit=function(){return this.parseBollAttr("isEnemy");};this.isFriendlyUnit=function(){return this.parseBollAttr("isFriendly");};this.isInfestated=function(){return this.parseBollAttr("isinfestated");};this.checkEffects=function(){var c=BattleElements[this.id];if(c){if(c.paralysed){RaiseError.paralysed();return true;}}return false;};this.isBlinker=function(){return this.unitName()=="blinker";};this.isQueen=function(){return this.unitName()=="queen";};this.canDeployEgg=function(){var c=this.id.split("_");return c[0]==7||c[0]==8;};}var Message={raiseAlert:function(c){var b=Language.getToken(c);var d=b;alert(d);},raiseConfirm:function(c){var b=Language.getToken(c);return confirm(b);},messageCallBack:function(d,b,e,c){if(e!=""){Message.raiseAlert(e);}}};var RaiseError={alreadyAttacked:function(){Message.raiseAlert("AlreadyAttacked");},invalidQuantity:function(){Message.raiseAlert("QuantityError");},attackFirstMove:function(){Message.raiseAlert("AttackFirstMove");},moves:function(){Message.raiseAlert("Moves");},ultimateUnitAttack:function(){Message.raiseAlert("UltimateUnitAttack");},unitsNotPositioned:function(b){Message.raiseAlert("UnitsNotPositioned");},minimumMove:function(c,b,d){Message.raiseAlert("MinimumMove");},minimumRest:function(d,b,c){Message.raiseAlert("MinimumRest");},noMovesToSplit:function(d){var c=Language.getToken("NoMovesToSplit");var b=Language.getToken("NoMovesToSplit2");},paralysed:function(){Message.raiseAlert("Paralysed");},coolDown:function(){Message.raiseAlert("CoolDown");},fleetInBattle:function(){Message.raiseAlert("FleetInBattle");},cantPassWormHoles:function(){Message.raiseAlert("FleetCantPassWormHole");},deploySaved:function(){Message.raiseAlert("DeploySaved");},deployLoaded:function(){Message.raiseAlert("DeployLoaded");},noDeploySaved:function(){Message.raiseAlert("NoDeploySaved");},unloadCargoFleetInBattle:function(){Message.raiseAlert("UnloadCargoFleetInBattle");},dropCargoFleetInBattle:function(){Message.raiseAlert("DropCargoFleetInBattle");},invalidCoordinate:function(){Message.raiseAlert("InvalidCoordinate");},needToSelectAFleetFirst:function(){Message.raiseAlert("NeedToSelectAFleetFirst");},notDiscoveredCoordinate:function(){Message.raiseAlert("NotDiscoveredCoordinate");},fleetIsMoving:function(){Message.raiseAlert("FleetIsMoving");},fleetAtMaximum:function(){Message.raiseAlert("FleetAtMaximum");}};var undo=new Undo();function Undo(){this.undo=function(){var c=$("movesMade");if($("movesMade").value==""){return;}var b=c.value.split(";");c.value="";for(var d=0;d<b.length-2;++d){c.value+=b[d]+";";}this.parseMove(b[b.length-2]);};this.reset=function(){var c=$("movesMade");if(c.value==""){return;}var b=c.value.split(";");c.value="";for(var d=b.length-2;d>=0;--d){this.parseMove(b[d]);}};this.parseMove=function(c){var b=c.split(":");params=b[1].split("-");undo[b[0]](params);};this.m=function(f){var e=Utils.getItem($(f[0]));var j=Utils.getItem($(f[1]));var d=Number(f[2]);var b=f[3];var c=Number(j.getQuantity());var h=1;if(e.hasChildNodes()){e.setQuantity(e.getQuantity()+d);h=2;}else{e.removeAll();e.insert(j,d);}e.setPosition(b);var g=e.unit().movementCost*h;movesObj.incrementMoves(g);e.hasAttacked=j.hasAttacked;BattleElements[e.id]=BattleElements[j.id];Utils.updateSpecialEffectsImages(j,e);if(lastSelection!=null){lastSelection.setClass("");lastSelection=null;}if(c>d){j.setQuantity(c-d);}else{if(c==d||c<d){j.removeAll();j.insertSpace();j.node.item=null;delete BattleElements[j.id];}}};this.bk=function(f){var e=Utils.getItem($(f[0]));var g=Utils.getItem($(f[1]));var d=Number(f[2]);var b=f[3];var c=Number(g.getQuantity());if(e.hasChildNodes()){e.setQuantity(e.getQuantity()+d);}else{e.removeAll();e.insert(g,d);}e.setPosition(b);movesObj.incrementMoves(Unit.blinker.movementCost);e.hasAttacked=g.hasAttacked;if(lastSelection!=null){lastSelection.setClass("");lastSelection=null;}BattleElements[e.id]=BattleElements[g.id];if(c>d){g.setQuantity(c-d);}else{if(c==d||c<d){g.removeAll();g.insertSpace();g.node.item=null;delete BattleElements[g.id];}}};this.e=function(b){var c=Utils.getItem($(b[0]));c.removeAll();movesObj.incrementMoves(Unit.queen.movementCost);};this.r=function(e){var d=Utils.getItem($(e[0]));var b=e[1];var c=e[2];d.setPosition(b);movesObj.incrementMoves(1);};this.b=function(c){var b=Utils.getItem($(c[0]));b.hasAttacked=false;movesObj.incrementMoves(b.unit().attackCost);};}var PositioningReset={reset:function(){if($("numberOfPlayers").value=="2"){PositioningReset.reset2();}else{PositioningReset.reset4();}},reset2:function(){Positioning.cleanSelected();for(var b=1;b<9;++b){PositioningReset.resetSector("7_"+b);PositioningReset.resetSector("8_"+b);}},reset4:function(){Positioning.cleanSelected();for(var b=3;b<11;++b){PositioningReset.resetSector("11_"+b);PositioningReset.resetSector("12_"+b);}},resetSector:function(f){var d=$(f);if(Utils.hasChilds(d)){var c=Utils.getItem(d);var b=new Item($(c.unit().name.toLowerCase()));b.insert(c,c.getQuantity(),null);c.removeAll();c.node.item=null;}}};var Planet={start:function(){try{if(window.location.href.indexOf("#")>=0){Planet.onHistoryChanged(window.location.hash);}}catch(b){log.error(b);}},sendRequest:function(c){if($("hub").value=="1"){Message.raiseAlert("YouHaveBattlesToPlay");return false;}var b="../Ajax/Planets/Renderer.ashx?t="+new Date().getTime().toString();var e="/";for(var d in c){if(d!="CallBack"){b+="&"+d+"="+c[d];e+=d+"_"+c[d]+"/";}}if(c.CallBack==null){c.CallBack=Planet.planetInfoUpdater;}Site.HistoryManager.addState(e);Utils.ajaxRequest("get",b,$("planetContent"),c.CallBack);log.info(c.Panel);},onHistoryChanged:function(e){if($("planetContent")==null){return;}if(e.indexOf("tutorial")>=0||e.indexOf("topView")>=0){return;}e=e.replace("#","");log.debug("Hash: "+e);if(e==""||e=="/"){if(window.redirectToPlanet&&window.redirectToPlanet!=null){window.location="Default.aspx?Id="+window.redirectToPlanet;}else{window.location="Default.aspx?Id="+window.planetInfo.PlanetId;}return;}var g=e.split("/");var d={};for(var c=0;c<g.length;++c){var f=g[c];if(f==""){continue;}var b=f.split("_");if(b[0]!="Action"){d[b[0]]=b[1];}}Planet.sendRequest(d);},destroyFacility:function(c,b){if(Message.raiseConfirm("ReallyDestroyFacility")){Planet.sendRequest({Planet:c,Panel:"Facilities",SlotName:b,Action:"Destroy"});}},upgradeFacility:function(c,b){Planet.sendRequest({Planet:c,Panel:"Facilities",SlotName:b,Action:"Upgrade"});},startBuildUnit:function(d,b){var c=$(b+"_Quantity").value;var e=parseInt(c);if(isNaN(e)){Message.raiseAlert("NaN");return;}if(e<=0){Message.raiseAlert("MustBePositiveQuantity");return;}Planet.sendRequest({Planet:d,Panel:"Units",Resource:b,Quantity:e,Action:"Build"});},startBuildFacility:function(d,b,c){Planet.sendRequest({Planet:d,Panel:"Facilities",SlotName:b,Resource:c,Action:"Build"});},createFleet:function(b){Fleet.sendRequest({Type:"change",Changes:Fleet.changeLog,CallBack:Planet.createFleetCallBack});},createFleetCallBack:function(){var b=$("fleetName").value;Planet.sendRequest({Planet:window.planetInfo.PlanetId,Panel:"Fleets",FleetName:b,CallBack:Planet.fleetCallBack,Action:"CreateFleet"});},cancelFacilityQueue:function(b,c){Planet.sendRequest({Planet:b,Panel:"Facilities",ResourceId:c,Action:"RemoveQueue"});},cancelUnitQueue:function(b,c){Planet.sendRequest({Planet:b,Panel:"Units",ResourceId:c,Action:"RemoveQueue"});},cancelFacilityProduction:function(b,c){if(!Message.raiseConfirm("YouWillLooseResources")){return;}Planet.sendRequest({Planet:b,Panel:"Facilities",ResourceId:c,Action:"RemoveProduction"});},cancelUnitProduction:function(b,c){if(!Message.raiseConfirm("YouWillLooseResources")){return;}Planet.sendRequest({Planet:b,Panel:"Units",ResourceId:c,Action:"RemoveProduction"});},changeName:function(c){var b=$("newPlanetName").value;log.debug("New Name:"+b);if(Utils.checkAndNotifyStringNotEmpty(b)){Planet.sendRequest({Planet:c,Panel:"Manage",Action:"ChangeName",NewName:b});}},abandonPlanet:function(b){if(Message.raiseConfirm("ReallyAbandonPlanet")){Planet.sendRequest({Planet:b,Panel:"Manage",Action:"AbandonPlanet"});}},getQueue:function(b){Planet.sendRequest({Planet:b,Panel:"Queue"});},toHome:function(b){Planet.sendRequest({Planet:b,Panel:"Facilities"});},toUnits:function(b){Planet.sendRequest({Planet:b,Panel:"Units"});},toPanel:function(b,c){if(c=="Fleets"){Planet.toFleets(b);return;}Planet.sendRequest({Planet:b,Panel:c});},toFleets:function(b){Planet.sendRequest({Planet:b,Panel:"Fleets",CallBack:Planet.fleetCallBack});},fleetCallBack:function(){Planet.planetInfoUpdater();},planetInfoUpdater:function(){if(window.redirectToPlanet&&window.redirectToPlanet!=null){window.location="Default.aspx?Id="+window.redirectToPlanet;return;}Planet.updatePlayerResources();var b=$("planetHeader");if(b!=null){b.innerHTML=window.planetInfo.PlanetName+" - "+window.planetInfo.PlanetLocation;b.href="javascript:Planet.toHome("+window.planetInfo.PlanetId+");";}var c=$("planetName"+window.planetInfo.PlanetId);if(c!=null){c.innerHTML=window.planetInfo.PlanetName;}UniverseUtils.removeAllToolTips();Planet.addTooltips();Tutorial.advance();Fleet.load();pageTracker._trackPageview(window.location);log.profile("ajaxRequest");},updatePlayerResources:function(){var d=window.resourceList;if(d!=null){for(var c in d){var b=$(c);if(b!=null){b.innerHTML=window.resourceList[c];Planet.showHideElem(b,c,window.resourceList[c]);}}}},modRegex:/\w+Mod$/,showHideElem:function(b,c,d){if(!Planet.modRegex.test(c)){return;}if(window.resourceList[c]==0){b.getParent().setStyles({display:"none"});}else{b.getParent().setStyles({display:"block"});}},build:function(c,b){Planet.sendRequest({Planet:c,Panel:"BuildFacility",SlotName:b});},upgrade:function(b,c){Planet.sendRequest({Planet:b,Panel:"UpgradeFacility",ResourceId:c});},unloadCargo:function(c,b,d){Planet.sendRequest({Planet:c,FleetId:b,Panel:"Fleets",Action:"UnloadFleet",CallBack:Fleet.load});},addTooltips:function(){var c=window.slotTips;if(c){for(var g in c){var e=$(g);var f=c[g];if(e!=null){if(f.b.l){var d="<ul>";d+="<li>"+Language.getToken("Level")+" "+f.b.l+"</li>";d+="<li>"+Language.getToken("State")+": "+Language.getToken(f.b.s)+"</li>";d+="</ul>";if(f.b.m!=""){d+="<p style='margin-top:10px;'>"+Language.getToken(f.b.m)+"</p>";}if(f.b.rm!=""){d+="<p style='margin-top:10px;'>"+f.b.rm+"</p>";}Utils.insertTip(e,Language.getToken(f.t),d);}else{var b=f.b;log.debug(f.l);if(f.l!=false){b=Language.getToken(f.b);}Utils.insertTip(e,Language.getToken(f.t),b);}}}}}};window.addEvent("domready",Site.startPlanet);function Attack(e,c,b,d){this.r=b;this.s_x=Number(e[0]);this.s_y=Number(e[1]);this.d_x=Number(c[0]);this.d_y=Number(c[1]);this.unit=d;this.checkPathVert=function(h,k,n){var g=BattleElements[this.s_x+"_"+this.s_y].hasAbility;var l=AttackUtils.ultimateUnitAttackCoord();if(h==l){h=l-1;}for(var f=k;f<n;++f){var j=Utils.getItem($(f+"_"+h));if(j.hasChildNodes()&&!(d.catapult&&g)){return false;}}return true;};this.checkPathHoriz=function(h,k,l){var g=BattleElements[this.s_x+"_"+this.s_y].hasAbility;for(var f=k;f<l;++f){var j=Utils.getItem($(h+"_"+f));if(j.hasChildNodes()&&!(d.catapult&&g)){return false;}}return true;};this.n=function(){var f=this.s_x-this.r;if(f<=0&&this.d_x==0&&this.d_y==0){return this.checkPathVert(this.s_y,this.d_x+1,this.s_x);}if(this.checkPathVert(this.s_y,this.d_x+1,this.s_x)){var g=this.d_x<this.s_x&&this.d_x>=f;if(this.s_y==AttackUtils.ultimateUnitAttackCoord()){return g;}return g&&this.s_y==this.d_y;}return false;};this.s=function(){var f=this.s_x+this.r;if(this.checkPathVert(this.s_y,this.s_x+1,this.d_x)){return this.d_x>this.s_x&&this.d_x<=f&&this.s_y==this.d_y;}return false;};this.w=function(){var f=this.s_y-this.r;if(this.checkPathHoriz(this.s_x,this.d_y+1,this.s_y)){return this.d_y<this.s_y&&this.d_y>=f&&this.s_x==this.d_x;}return false;};this.e=function(){var f=this.s_y+this.r;if(this.checkPathHoriz(this.s_x,this.s_y+1,this.d_y)){return this.d_y>this.s_y&&this.d_y<=f&&this.s_x==this.d_x;}return false;};}var Replay={currentTurn:0,currentMove:-1,space:"span",isTheEnd:function(){return movesList.length==Replay.currentTurn;},isTheBeginning:function(){return Replay.currentTurn<=0&&Replay.currentMove<0;},incrementTurn:function(){if(Replay.currentTurn<movesList.length){++Replay.currentTurn;}var b=$("turn");if(b!=null){b.innerHTML=Replay.currentTurn;}},decrementTurn:function(){if(Replay.currentTurn>0){--Replay.currentTurn;}$("turn").innerHTML=Replay.currentTurn;},forward:function(){Utils.hideImage("enemy");if(Replay.isTheEnd()){return;}var b=movesList[Replay.currentTurn];Replay.resolveForwarReplay(b);},resolveForwarReplay:function(d){var b=d.split(";");if(Replay.currentMove>=b.length-1){Replay.nextTurn();}else{var c=b[++Replay.currentMove];if(c!=""){Replay.parseMoveForward(c);}else{Replay.nextTurn();}}},backward:function(){Utils.hideImage("enemy");if(Replay.isTheBeginning()){return;}if(Replay.currentMove<0){if(Replay.currentTurn>-1){Replay.previousTurn();return;}}var c=movesList[Replay.currentTurn];if(c==""){Replay.decrementTurn();return;}var b=c.split(";");Replay.parseMoveBackward(b[Replay.currentMove]);--Replay.currentMove;},nextTurn:function(){Replay.incrementTurn();Replay.currentMove=-1;Replay.loadCurrentTurn(0);},previousTurn:function(){Replay.loadCurrentTurn(1);Replay.decrementTurn();var e=movesList[Replay.currentTurn];if(e!=""){var b=e.split(";");for(var d=0;d<b.length;++d){var c=b[d];if(c!=""){Utils.hideImage("enemy");Replay.parseMoveForward(c);}}Replay.currentMove=b.length-2;}else{Replay.currentMove=-1;}},loadLastTurn:function(){Replay.currentTurn=movesList.length;Replay.currentMove=-1;Replay.loadCurrentTurn(0);},loadFirstTurn:function(){Replay.currentTurn=0;Replay.currentMove=-1;Replay.loadCurrentTurn(1);},loadCurrentTurn:function(j){Utils.hideImage("enemy");Replay.cleanBoard();var g=Replay.currentTurn-j;if(g<0){g=0;}var e=$("turn");if(e!=null){e.innerHTML=g;}var c=finalState[g];var d=$("playerId").value;var b=c.split(";");for(var f=0;f<b.length;++f){var h=b[f];if(h!=""){Replay.insertElement(h,d);}}},cleanBoard:function(){var c;if(Utils.numberOfPlayers()==2){c=$("board2").getElements("td");}else{c=$("board4").getElements("td");}var b=Utils.numberOfPlayers()==4;c.each(function(e){if(!(b&&!Utils.coordinateValid(e.id))){e.empty();var d=document.createElement(Replay.space);e.appendChild(d);e.className="";}});},insertElement:function(b,d){var j=b.split(":");var g=j[1].split("-");var k=Unit[g[0]]();var c=$(g[1]);var f=g[2];var h=g[3].toLowerCase();var l=document.createElement("img");l.src=unitPath+k.name.toLowerCase()+"_"+h+".png";l.title=f;l.alt=k.name.toLowerCase();c.empty();c.appendChild(l);if(j[0]!=d){if(Utils.numberOfPlayers()==2){c.className="enemyBorder";}else{c.className="enemyBorder"+j[0];}}},parseMoveForward:function(c){var b=c.split(":");params=b[1].split("-");Replay[b[0]](params);},parseMoveBackward:function(c){var b=c.split(":");params=b[1].split("-");Replay[b[0]+"b"](params);},m:function(g){var f=Utils.getItem($(g[0]));var j=Utils.getItem($(g[1]));var e=Number(g[2]);var b=Number(j.getQuantity());var d=Number(f.getQuantity());var h=1;if(j.hasChildNodes()){j.setQuantity(b+e);var c=d-e;if(c==0){Replay.clearItem(f);}else{f.setQuantity(c);}}else{if(d==e){j.removeAll();j.insert(f,e);j.setClass(f.getClass());Replay.clearItem(f);}else{j.insert(f,e);j.setClass(f.getClass());f.setQuantity(d-e);h=2;}}},bk:function(b){m(b);},r:function(d){var c=Utils.getItem($(d[0]));var b=d[2];c.setPosition(b.toLowerCase());},b:function(c){var b=Utils.getItem($(c[0]));var d=Utils.getItem($(c[1]));b.hasAttacked=true;Utils.showImage(d,"enemy",null);},mb:function(g){var f=Utils.getItem($(g[0]));var j=Utils.getItem($(g[1]));var e=Number(g[2]);var d=Number(f.getQuantity());var b=Number(j.getQuantity());var h=1;if(f.hasChildNodes()){f.setQuantity(d+e);var c=b-e;if(c==0){Replay.clearItem(j);}else{j.setQuantity(c);}h=2;}else{if(b==e){f.removeAll();f.insert(j,e);f.setClass(j.getClass());Replay.clearItem(j);}else{f.insert(j,e);f.setClass(j.getClass());j.setQuantity(b-e);}}},rb:function(d){var c=Utils.getItem($(d[0]));var b=d[1];c.setPosition(b.toLowerCase());},bb:function(c){var b=Utils.getItem($(c[0]));b.hasAttacked=false;var d=Utils.getItem($(c[1]));Utils.showImage(d,"enemy",null);},clearItem:function(b){b.removeAll();b.setClass("");b.insertSpace();b.node.item=null;}};function Moves(){this.moveElement=$("moves");this.none=function(b,c){return false;};this.all=function(e,g){var c=Number(e[0]);var b=Number(e[1]);var f=Number(g[0]);var d=Number(g[1]);if(f<=c+1&&f>=c-1){if(d<=b+1&&d>=b-1){return true;}}return false;};this.normal=function(e,g){var c=Number(e[0]);var b=Number(e[1]);var f=Number(g[0]);var d=Number(g[1]);if(f<=c+1&&f>=c-1&&b==d){return true;}if(d<=b+1&&d>=b-1&&c==f){return true;}return false;};this.front=function(b,c){return this[lastSelection.getPosition()](b,c);};this.blink=function(b,d){var c=Number(d[0]);return c>4;};this.diagonal=function(e,g){var c=Number(e[0]);var b=Number(e[1]);var f=Number(g[0]);var d=Number(g[1]);return f==c+1&&d==b+1||f==c-1&&d==b-1||f==c+1&&d==b-1||f==c-1&&d==b+1;};this.drop=function(b,c){};this.n=function(e,g){var c=Number(e[0]);var f=Number(g[0]);var b=Number(e[1]);var d=Number(g[1]);return f==c-1&&b==d;};this.s=function(e,g){var c=Number(e[0]);var f=Number(g[0]);var b=Number(e[1]);var d=Number(g[1]);return f==c+1&&b==d;};this.w=function(e,g){var b=Number(e[1]);var d=Number(g[1]);var c=Number(e[0]);var f=Number(g[0]);return d==b-1&&c==f;};this.e=function(e,g){var b=Number(e[1]);var d=Number(g[1]);var c=Number(e[0]);var f=Number(g[0]);return d==b+1&&c==f;};this.incrementMoves=function(c){var b=Number(this.moveElement.innerHTML);this.moveElement.innerHTML=b+c;};this.decrementMoves=function(c){var b=Number(this.moveElement.innerHTML);this.moveElement.innerHTML=b-c;};this.hasMoves=function(c){var b=Number(this.moveElement.innerHTML);if(b<c){RaiseError.moves();return false;}return true;};this.silentHasMoves=function(c){var b=Number(this.moveElement.innerHTML);if(b<c){return false;}return true;};this.hasValidMoves=function(c){var b=Number(this.moveElement.innerHTML);if(b<c){return false;}return true;};this.decrementMoves=function(c){var b=Number(this.moveElement.innerHTML);this.moveElement.innerHTML=b-c;};}var movesObj=new Moves();var lastSelection;var blinkSelection;var Battle={isSpectator:function(){var b=$("isSpectator");if(b==null){return true;}return b.value!=0;},start:function(){if(!Battle.isSpectator()){Battle.initTDElements();}Utils.initSpecialMoveImages(true);},initTDElements:function(){Utils.getTdElements().each(function(c){Battle.initTd(c);});Battle.initUltimateUnits();var b=$("reset");if(b){b.addEvent("click",function(c){undo.reset();});$("undo").addEvent("click",function(c){undo.undo();});$("submit").addEvent("click",function(c){Battle.submit();});}b=$("giveUp");if(b){b.addEvent("click",function(c){Battle.giveUp();});}if($("battleCalculator")){$("elementSelectedQuantInput").addEvent("keyup",function(c){Information.fillCalculatorEvent(this,c);});$("elementSelectedRangeInput").addEvent("keyup",function(c){Information.fillCalculatorRangeEvent(this,c);});}$("b").addEvent("click",function(c){Battle.setPosition("n");});$("d").addEvent("click",function(c){Battle.setPosition("w");});$("e").addEvent("click",function(c){Battle.setPosition("e");});$("g").addEvent("click",function(c){Battle.setPosition("s");});},initTd:function(b){b.addEvent("click",function(c){Battle.selected(this,c);});b.addEvent("mouseout",function(c){Utils.canMoveOut();});b.addEvent("mouseover",function(d){var c=Utils.getItem(this);Utils.canMoveOver(c,d);});},initUltimateUnits:function(){if(Utils.numberOfPlayers()==2){var b=$("0_0");if(b){Battle.initTd(b);}b=$("9_9");if(b){Battle.initTd(b);}}},initialChecksOk:function(b){if(b.isEnemyUnit()||b.isFriendlyUnit()){return false;}if(b.checkEffects()){return false;}if($("moves").innerHTML==0){if(lastSelection!=null){Utils.resetSelection(null);}return false;}if(b.hasAttacked){RaiseError.alreadyAttacked();return false;}return true;},selected:function(b,c){var d=Utils.getItem(b);if(!Battle.isBlinkerSelected()&&!Battle.initialChecksOk(d)){return;}if(lastSelection==null){Battle.noneSelected(d);}else{if(Battle.sameSector(d)){Battle.clearSelected();Information.fixed=false;return;}Battle.oneSelected(d,c);}},isBlinkerSelected:function(){return blinkSelection!=null||(lastSelection!=null&&lastSelection.isBlinker());},blinkerInRange:function(b){if(Battle.isBlinkerSelected()){return b.x()>4;}return true;},noneSelected:function(d){if(!d.hasChildNodes()){return;}if(Battle.hasCoolDown(d)||!Battle.blinkerInRange(d)){return;}d.setClass("selectedSector");var c=d.getQuantity();var b=$("quantity");b.value=c;b.focus();min=Math.round(0.5+(Number(c)*0.2));Information.fill("minquantity",min);Information.fill("maxquantity",c-min);Information.fillAll(d);lastSelection=d;Information.fixed=true;Tutorial.advance();},hasCoolDown:function(c){if(BattleElements){var b=BattleElements[c.id];if(b!=null&&b.coolDown>0){RaiseError.coolDown();return true;}}return false;},setPosition:function(c){if(lastSelection!=null&&lastSelection.getPosition()!=c&&movesObj.hasMoves(1)){var b=lastSelection.getPosition();lastSelection.setPosition(c);Utils.registerRotation(lastSelection,b,c);movesObj.decrementMoves(1);if(!movesObj.silentHasMoves(1)){Utils.resetSelection(null);}}},oneSelected:function(c,b){Information.fixed=false;var d=Battle.getCost();if(movesObj.hasMoves(d)){if(lastSelection.isQueen()){Battle.insertEgg(c,d,b);return;}if(blinkSelection!=null||lastSelection.isBlinker()){Battle.blinkSelected(c,d,b);}else{if(Utils.canMoveOver(c,b)){Battle.moveUnit(c,d,b);}}}},blinkSelected:function(c,d,b){if(blinkSelection==null){blinkSelection=lastSelection;lastSelection=null;Battle.noneSelected(c);}else{if(c.id!=blinkSelection.id&&Battle.blinkerInRange(c)){Battle.moveUnit(c,d,b);Battle.clearBlinkSelected();}}},insertEgg:function(c,b){c.insertSpecific(Unit.egg,1);c.node.item=c;if(!c.hasChildNodes()){c.removeAll();}movesObj.decrementMoves(Unit.queen.movementCost);Utils.registerEgg(c);lastSelection.setClass("");lastSelection=null;},getCost:function(){if(blinkSelection!=null){return blinkSelection.movementCost();}return lastSelection.movementCost();},moveUnit:function(g,h,e){var f=lastSelection.getQuantity();var b=lastSelection.getPosition();var d=Utils.getQuantity();if(d<=f&&d>0){var c=f-d;if(c>0){h*=2;if(!movesObj.hasMoves(h)){RaiseError.noMovesToSplit(h);return;}}if(!Battle.quantityValueCheck(c,f,d)){return;}if(!g.hasChildNodes()){g.removeAll();}g.insert(lastSelection,d,e);g.node.item=g;BattleElements[g.id]=BattleElements[lastSelection.id];Utils.updateSpecialEffectsImages(lastSelection,g);if(c>0){lastSelection.setQuantity(c);}else{lastSelection.removeAll();lastSelection.node.item=null;delete BattleElements[lastSelection.id];}movesObj.decrementMoves(h);Battle.registerMovement(lastSelection,g,d,b);if(lastSelection.isSource()&&c==0){lastSelection.setClass("unitOpacity");}else{lastSelection.setClass("");}lastSelection=null;Tutorial.advance();}else{RaiseError.invalidQuantity();}},registerMovement:function(c,e,d,b){if(blinkSelection!=null){Utils.registerBlink(c,e,d,b);}else{Utils.registerMove(c,e,d,b);}},quantityValueCheck:function(c,e,b){var d=Math.round(0.5+(e*0.2));if(b<d){RaiseError.minimumMove(b,lastSelection.unitName(),d);return false;}if(c<d&&c!=0){RaiseError.minimumRest(c,lastSelection.unitName(),d);return false;}return true;},submit:function(){var e=Message.raiseConfirm("EndTurn");if(e){var b=$("movesMade");$("submit").disabled=true;var d=Utils.queryString("id");var c="../Ajax/Battle/Battle.ashx?type=battle&id="+d+"&moves="+b.value;Utils.ajaxRequest("get",c,Utils.getBattleDiv(),Battle.submitCallBack);}},submitCallBack:function(){$("movesMade").value="";FillInformation.start();},giveUp:function(){var d=Message.raiseConfirm("GiveUp");if(d){$("giveUp").disabled=true;$("submit").disabled=true;var c=Utils.queryString("id");var b="../Ajax/Battle/Battle.ashx?type=giveUp&id="+c;Utils.ajaxRequest("get",b,Utils.getBattleDiv(),Battle.giveUpCallBack);}},giveUpCallBack:function(){Cookie.dispose("HasBattles");Cookie.dispose("HasUniverseBattles");},getAllMessages:function(){var c=Utils.queryString("id");var b="../Ajax/Battle/BattleMessages.ashx?id="+c;Utils.ajaxRequest("get",b,$("messages"),Battle.getAllMessagesCallBack);},getAllMessagesCallBack:function(){},sameSector:function(b){return lastSelection!=null&&lastSelection.id==b.id;},clearSelected:function(){if(lastSelection!=null){var b="";lastSelection.setClass("");lastSelection=null;Utils.getQuantityElement().value=b;Information.fill("minquantity",b);Information.fill("maxquantity",b);Battle.clearBlinkSelected();}},clearBlinkSelected:function(){if(blinkSelection!=null){blinkSelection.setClass("");blinkSelection=null;}},canMove:function canMove(e){var c=lastSelection.id.split("_");var d=lastSelection.getChildId().toLowerCase().split("_");var b=Unit[d[0]].movementType;if(b==""){return false;}return movesObj[b](c,e);}};var lastSelection;var Positioning={start:function(){if($("isSpectator").value==0){Positioning.initTDElements();Positioning.initBottomElements();$("reset").addEvent("click",function(b){PositioningReset.reset(this);});$("submit").addEvent("click",function(b){Positioning.submit();});}},initTDElements:function(){Utils.getTdElements().each(function(b){b.addEvent("click",function(c){Positioning.selected(this,c);});b.addEvent("mouseout",function(c){Utils.canMoveOut();});b.addEvent("mouseover",function(c){Utils.canMoveOverPositioning(this.id,c);});});},initBottomElements:function(){Positioning.getBottomElements().each(function(b){if(!b.hasClass("initialBottomIgnore")){b.addEvent("click",function(c){Positioning.selected(this);});b.addEvent("mouseout",function(c){if(lastSelection!=null&&this.getFirst().get("tag")=="span"){if(lastSelection.getImageName()==b.id){this.className="unitOpacity";}}});b.addEvent("mouseover",function(c){if(lastSelection!=null&&this.getFirst().get("tag")=="span"){if(lastSelection.getImageName()==b.id){this.className="unitOpacityOver";}}});b.setStyle("background-image","url("+$("imagePath").value+"/Units/"+b.id.toLowerCase()+".png)");b.setStyle("background-repeat","no-repeat");}});},submit:function(){if(Positioning.hasPositioned()){var b=$("movesMade");$("submit").disabled=true;Positioning.gatherUnits(b);var d=Utils.queryString("id");var c="../Ajax/Battle/Battle.ashx?type=deploy&id="+d+"&moves="+b.value;Utils.ajaxRequest("get",c,Utils.getBattleDiv(),Positioning.submitCallBack);}},gatherUnits:function(b){if(Utils.numberOfPlayers()==2){Positioning.setUnits2(b);}else{Positioning.setUnits4(b);}},setUnits2:function(b){for(var c=1;c<9;++c){Positioning.addMove(b,"7_"+c);Positioning.addMove(b,"8_"+c);}},setUnits4:function(b){for(var c=3;c<11;++c){Positioning.addMove(b,"11_"+c);Positioning.addMove(b,"12_"+c);}},submitCallBack:function(){window.location=window.location;},addMove:function(b,f){var d=Utils.getItem($(f));if(d.hasChildNodes()){var c=Unit[d.unitName().toLowerCase()];var e=d.getQuantity();b.value+="p:"+c.code+"-"+f+"-"+e+";";}},hasPositioned:function(){var c=false;var b="";Positioning.getBottomElements().each(function(f){if(Utils.hasChilds(f)){if(f.className!="initialBottomIgnore"){var e=Utils.getItem(f);var d=e.unitName();b+=d+" "+e.getQuantity()+"\n";c=true;}}});if(c){RaiseError.unitsNotPositioned(b);}return !c;},selected:function(b,c){if(Utils.numberOfPlayers()!=2&&!Utils.coordinateValid(b.id)){return;}var d=Utils.getItem(b);if(lastSelection==null){Positioning.noneSelected(d);}else{if(Positioning.sameSector(d)){Positioning.cleanSelected();return;}Positioning.oneSelected(d,c);}},noneSelected:function(d){if(!d.hasChildNodes()){return;}d.setClass("selectedSector");var c=d.getQuantity();var b=$("quantity");b.value=c;b.focus();min=Math.round(0.5+(Number(c)*0.2));Information.fill("minquantity",min);Information.fill("maxquantity",c-min);Information.fillAll(d);lastSelection=d;Tutorial.advance();},oneSelected:function(f,d){if(Utils.canMoveOverPositioning(f.id,d)){var e=lastSelection.getQuantity();var c=Utils.getQuantity();if(c<=e&&c>0){var b=e-c;if(!f.hasChildNodes()){f.removeAll();}f.insert(lastSelection,c,d);f.node.item=f;if(b>0){lastSelection.setQuantity(b);}else{lastSelection.removeAll();lastSelection.node.item=null;}if(lastSelection.isSource()&&b==0){lastSelection.setClass("unitOpacity");}else{lastSelection.setClass("");}lastSelection=null;Tutorial.advance();}else{RaiseError.invalidQuantity();}}},sameSector:function(b){return lastSelection.id==b.id;},cleanSelected:function(){if(lastSelection!=null){var b="";lastSelection.setClass(b);lastSelection=null;Utils.getQuantityElement().value=b;Information.fill("minquantity",b);Information.fill("maxquantity",b);}},getBottomElements:function(){if(Utils.numberOfPlayers()==2){return $("initialBottom").getElements("td");}return $("initialBottom4").getElements("td");},saveDeploy:function(){if(Positioning.hasPositioned()){var c=$("tournamentId").value+$("currentUser").value;var b=$("movesMade");Positioning.gatherUnits(b);Cookie.dispose(c);Cookie.write(c,encodeURI(b.value));b.value="";RaiseError.deploySaved();}},loadDeploy:function(){var f=$("tournamentId").value+$("currentUser").value;var d=decodeURI(Cookie.read(f));if(d!="null"&&d!=""){Positioning.cleanBottom();Positioning.clearBoard();var g=d.split(";");for(var j=0;j<g.length;++j){var h=g[j];if(h!=""){var c=h.split(":")[1].split("-");var k=$(c[1]);var b=Positioning.createUnitImage(c[0],c[2]);k.empty();b.inject(k);}}RaiseError.deployLoaded();}else{RaiseError.noDeploySaved();}},emptyField:function(b){b.empty();b.appendChild(new Element("span"));},createUnitImage:function(c,e){var d=Unit[c]();var b=new Element("img");b.src=$("imagePath").value+"/Units/"+d.name.toLowerCase()+".png";b.title=e;b.alt=d.name.toLowerCase();return b;},cleanBottom:function(){$("initialBottom").getElements("td").each(function(b){if(!b.hasClass("initialBottomIgnore")){Positioning.emptyField(b);b.className="unitOpacity";}});},clearBoard:function(){for(var b=1;b<=8;++b){Positioning.emptyField($("7_"+b));Positioning.emptyField($("8_"+b));}}};var lastSelection;var FillInformation={start:function(){Utils.initSpecialMoveImages(false);FillInformation.initTDElements();FillInformation.initOtherElements("initialTop");FillInformation.initOtherElements("initialRight");FillInformation.initOtherElements("initialLeft");var b=$("giveUp");if(b){b.addEvent("click",function(c){FillInformation.giveUp();});}if($("battleCalculator")){$("elementSelectedQuantInput").addEvent("keyup",function(c){Information.fillCalculatorEvent(this,c);});$("elementSelectedRangeInput").addEvent("keyup",function(c){Information.fillCalculatorRangeEvent(this,c);});}},initTDElements:function(){Utils.getTdElements().each(function(b){b.addEvent("mouseover",function(c){FillInformation.fillElement(this);});});FillInformation.initUltimateElements("9_9");FillInformation.initUltimateElements("0_0");},initUltimateElements:function(b){var d=Utils.numberOfPlayers();var c=$(b);if(c&&d==2){c.addEvent("mouseover",function(f){FillInformation.fillElement(this);});}},initOtherElements:function(b){var d=$(b);if(d!=null){var c=d.getElements("td");c.each(function(e){e.addEvent("mouseover",function(f){FillInformation.fillElement(this);});});}},fillElement:function(b){if(Utils.hasChilds(b)){var c=Utils.getItem(b);if(c!=null){Information.fillAll(c);}}},giveUp:function(){var d=Message.raiseConfirm("GiveUp");if(d){$("giveUp").disabled=true;var c=Utils.queryString("id");var b="../Ajax/Battle/Battle.ashx?type=giveUp&id="+c;Utils.ajaxRequest("get",b,Utils.getBattleDiv(),Battle.giveUpCallBack);}},giveUpCallBack:function(){}};function Handler(){this.positioning=function(){Positioning.start();};this.battle=function(){Battle.start();};this.fill=function(){FillInformation.start();};}var handler=new Handler();var handlerKey;window.addEvent("domready",function(){if(handlerKey){handler[handlerKey]();}});var fleetMovements=[];var UniverseUtils={sendUniverseRequest:function(c,d,b){if($("hub").value=="1"){Message.raiseAlert("YouHaveBattlesToPlay");return false;}for(var e in b){if(e!="CallBack"){c+="&"+e+"="+b[e];}}if(b.CallBack==null){b.CallBack=UniverseUtils.genericCallBack;}Utils.ajaxRequest("get",c,d,b.CallBack);return true;},sendRequest:function(c){var b=Site.appPath+"Ajax/Universe/Universe.ashx?1=1";return UniverseUtils.sendUniverseRequest(b,$("universe"),c);},sendMoveRequest:function(c){var b=Site.appPath+"Ajax/Universe/FleetMove.ashx?"+UniverseUtils.getFullCoordinateQueryString();return UniverseUtils.sendUniverseRequest(b,null,c);},sendSimpleMoveRequest:function(c){var b=Site.appPath+"Ajax/Universe/FleetMove.ashx?1=1";return UniverseUtils.sendUniverseRequest(b,null,c);},getFullCoordinateQueryString:function(){var d=UniverseUtils.getSourceSystem();var b=UniverseUtils.getSourceSector();var e=UniverseUtils.getDestinySystem();var c=UniverseUtils.getDestinySector();return"systemSrc="+d+"&sectorSrc="+b+"&systemDst="+e+"&sectorDst="+c;},getSourceSystem:function(){return UniverseUtils.sourceSelected.getAttribute("system");},getSourceSector:function(){return UniverseUtils.sourceSelected.getAttribute("sector");},getSourceCoordinate:function(){return UniverseUtils.getSourceSystem()+"_"+UniverseUtils.getSourceSector();},getDestinySystem:function(){return UniverseUtils.destinySelected.getAttribute("system");},getDestinySector:function(){return UniverseUtils.destinySelected.getAttribute("sector");},getDestinyCoordinate:function(){return UniverseUtils.getDestinySystem()+"_"+UniverseUtils.getDestinySector();},sourceTypeKey:function(){return UniverseUtils.sourceSelected.getAttribute("type")+"Source";},destinyTypeKey:function(){return UniverseUtils.destinySelected.getAttribute("type")+"Destiny";},isPrivateSector:function(){return $("isPrivateSector").value=="1";},load:function(){var b=$("universe").getElements("td");b.addEvent("click",function(c){UniverseUtils.selected(this,c);});UniverseUtils.removeAllToolTips();UniverseUtils.addToolTips();UniverseDirection.load();UniverseUtils.resetSelected();UniverseUtils.addRightMenuEvents();},addRightMenuEvents:function(){var b=$("zoom1");if(b!=null){b.addEvent("click",function(c){UniverseUtils.zoom1();});$("zoom2").addEvent("click",function(c){UniverseUtils.zoom2();});$("zoom3").addEvent("click",function(c){UniverseUtils.zoom3();});$("zoom4").addEvent("click",function(c){UniverseUtils.zoom4();});}var b=$("moveToButton");if(b!=null){b.addEvent("click",function(c){UniverseUtils.moveEventWithCoordinates();});}},addToolTips:function(){UniverseUtils.addFleetsToolTip();UniverseUtils.addPlanetToolTip();UniverseUtils.addArenaToolTip();UniverseUtils.addMarketToolTip();UniverseUtils.addWormHoleToolTip();UniverseUtils.addBattleToolTip();UniverseUtils.addBeaconToolTip();UniverseUtils.addAcademyToolTip();UniverseUtils.addPirateBayToolTip();UniverseUtils.addRelicToolTip();},addLine:function(c,d){var b=Language.getToken(c);b+=": "+d+"<br/>";return b;},getAlliance:function(b){return"<span class='"+b.s+"'>"+b.a+"</span>";},getTTM:function(b){return b.ttm!=null?b.ttm:1;},getTTTM:function(b){return b.tttm!=null?b.tttm:1;},getETA:function(l){var p=l.c.split(":");var h=l.d.split(":");var b=[Number(p[0]),Number(p[1]),Number(p[2]),Number(p[3])];var j=[Number(h[0]),Number(h[1]),Number(h[2]),Number(h[3])];var c=[Number(b[0]),Number(j[1]),Number(b[2]),Number(j[3])];var f=Math.abs((((b[0]-c[0])+(b[1]-c[1]))*10)+((b[2]-c[2])+(b[3]-c[3])));var e=Math.abs((((j[0]-c[0])+(j[1]-c[1]))*7)+((j[2]-c[2])+(j[3]-c[3])));var o=f>e?f:e;var n=UniverseUtils.getTTM(l);var g=UniverseUtils.getTTTM(l);var k=(o*g)-(g-n);return Utils.getTimeFromTicks(k);},getFleetToolTipBody:function(c){var b=UniverseUtils.addLine("Owner",c.o);b+=UniverseUtils.addLine("Coordinate",c.c);b+=UniverseUtils.addLine("IsMoving",Language.getToken(c.m));if(c.m){b+=UniverseUtils.addLine("Destination",c.d);b+=UniverseUtils.addLine("ETA",UniverseUtils.getETA(c));b+=UniverseUtils.addLine("TTM",Utils.getTimeFromTicks(UniverseUtils.getTTM(c)));c.ttm=1;}if(c.a!=""){b+=UniverseUtils.addLine("Alliance",UniverseUtils.getAlliance(c));}else{b+=UniverseUtils.addLine("Alliance",Language.getToken("None"));}b+=UniverseUtils.getFleetBeaconInformation(c);b+=UniverseUtils.getToolTipResources(c,"Cargo");b+=UniverseUtils.getFleetToolTipUnits(c,"Units");return b;},getFleetBeaconInformation:function(c){var b="";if(c.lq!=null){b+=UniverseUtils.addLine("LightQuantity",c.lq);}if(c.mq!=null){b+=UniverseUtils.addLine("MediumQuantity",c.mq);}if(c.hq!=null){b+=UniverseUtils.addLine("HeavyQuantity",c.hq);}return b;},getFleetToolTipUnits:function(d,f){var b="";if(d.u!=null){if(d.u.length>1){var b=UniverseUtils.addLine(f,"");b+="<div class='popupFleetUnits'>";for(var c=0;c<d.u.length;++c){var e=d.u[c];if(e.n!="ignore"){b+="<div><img src='"+Utils.resolveUnitImage(e.n)+"' alt='' title=''/><br/>"+e.q+"</div>";}}b+="</div>";}else{var b=UniverseUtils.addLine(f,Language.getToken("None"));}}return b;},getToolTipResources:function(e,d){var b="";if(e.i!=null){if(e.i.length>1){var b=UniverseUtils.addLine(d,"");b+="<div class='popupPlanetIncome'>";for(var c=0;c<e.i.length;++c){var f=e.i[c];if(f.n!="ignore"){b+="<div><img src='"+Utils.resolveEtcImage("Fill","gif")+"' class='resourceSmall resource"+f.n+"' alt='' title=''/><br/>"+f.q+"</div>";}}b+="</div>";}else{var b=UniverseUtils.addLine(d,Language.getToken("None"));}}return b;},getPlanetToolTipFacilities:function(b){if(b.f!=null){return UniverseUtils.addLine("FacilityLevel",b.f);}return"";},getBattleToolTipBody:function(c){var b=UniverseUtils.addLine("Player1",c.p1);if(c.a1!=""){b+=UniverseUtils.addLine("Alliance","<span class='"+c.s1+"'>"+c.a1+"</span>");}else{b+=UniverseUtils.addLine("Alliance",Language.getToken("None"));}b+=UniverseUtils.addLine("Player2",c.p2);if(c.a2!=""){b+=UniverseUtils.addLine("Alliance","<span class='"+c.s2+"'>"+c.a2+"</span>");}else{b+=UniverseUtils.addLine("Alliance",Language.getToken("None"));}return b;},addFleetsToolTip:function(){if(fleets){for(var e in fleets){var c=fleets[e];var d=$(e);if(d!=null){var b=UniverseUtils.getFleetToolTipBody(c);Utils.insertTip(d,c.n,b);}}}},getbeaconInformation:function(c){var b=UniverseUtils.getPlanetToolTipFacilities(c);b+=UniverseUtils.getToolTipResources(c,"Income");b+=UniverseUtils.getFleetToolTipUnits(c,"DefenseFleet");return b;},addPlanetToolTip:function(){if(planets){for(var e in planets){var c=planets[e];var d=$(e);if(d){var b="";if(c.o!=""){b+=UniverseUtils.addLine("Owner",c.o);}b+=UniverseUtils.addLine("Level",c.l);b+=UniverseUtils.addLine("Terrain",Language.getToken(c.pt));b+=UniverseUtils.addLine("Coordinate",c.c);if(c.a!=""){b+=UniverseUtils.addLine("Alliance",UniverseUtils.getAlliance(c));}else{b+=UniverseUtils.addLine("Alliance",Language.getToken("None"));}b+=UniverseUtils.getbeaconInformation(c);Utils.insertTip(d,c.n,b);}}}},addArenaToolTip:function(){if(arenas){for(var e in arenas){var c=arenas[e];var d=$(e);if(d){var b=UniverseUtils.addLine("Owner",c.o);b+=UniverseUtils.addLine("IsInBattle",c.b);b+=UniverseUtils.addLine("Coordinate",c.c);Utils.insertTip(d,c.n,b);}}}},addMarketToolTip:function(){if(markets){for(var e in markets){var d=markets[e];var c=$(e);if(c){var b=UniverseUtils.addLine("Coordinate",d.c);b+=UniverseUtils.addLine("Level",d.l);b+=UniverseUtils.addLine("TradeResource",Language.getToken(d.r));Utils.insertTip(c,d.n,b);}}}},addWormHoleToolTip:function(){if(wormHoles){for(var e in wormHoles){var c=wormHoles[e];var d=$(e);if(d){var b=UniverseUtils.addLine("Coordinate",c.c);if(c.o!=null){b+=UniverseUtils.addLine("Owner",c.o);b+=UniverseUtils.addLine("Alliance",UniverseUtils.getAlliance(c));}Utils.insertTip(d,c.n,b);}}}},addBeaconToolTip:function(){if(beacons){for(var e in beacons){var c=beacons[e];var d=$(e);if(d){var b=UniverseUtils.addLine("Coordinate",c.c);b+=UniverseUtils.addLine("Owner",c.o);b+=UniverseUtils.addLine("Alliance",UniverseUtils.getAlliance(c));Utils.insertTip(d,c.n,b);}}}},addBattleToolTip:function(){if(battles){for(var e in battles){var d=battles[e];var c=$(e);if(c!=null){var b=UniverseUtils.getBattleToolTipBody(d);Utils.insertTip(c,d.n,b);}}}},addAcademyToolTip:function(){if(academies){for(var e in academies){var d=academies[e];var c=$(e);if(c){var b=UniverseUtils.addLine("Coordinate",d.c);b+=UniverseUtils.addLine("Level",d.l);Utils.insertTip(c,d.n,b);}}}},addPirateBayToolTip:function(){if(piratebays){for(var e in piratebays){var d=piratebays[e];var c=$(e);if(c){var b=UniverseUtils.addLine("Coordinate",d.c);b+=UniverseUtils.addLine("Level",d.l);Utils.insertTip(c,d.n,b);}}}},addRelicToolTip:function(){if(relics){for(var e in relics){var d=relics[e];var c=$(e);if(c){var b=UniverseUtils.addLine("Owner",d.o);b+=UniverseUtils.addLine("IsInBattle",d.b);b+=UniverseUtils.addLine("Coordinate",d.c);if(d.a!=""){b+=UniverseUtils.addLine("Alliance",UniverseUtils.getAlliance(d));}else{b+=UniverseUtils.addLine("Alliance",Language.getToken("None"));}Utils.insertTip(c,d.n,b);}}}},removeAllToolTips:function(){$$(".tip-top").each(function(b){var c=b.getParent();c.dispose();if(b.tip!=null){b.tip.dispose();}});},toggleMoveTo:function(c){var b=$("moveToButton");if(b!=null){b.disabled=c;}},selected:function(c,b){if(UniverseUtils.sourceSelected==null){UniverseUtils.noSelected(c,b);}else{UniverseUtils.oneSelected(c,b);}},noSelected:function(d,c){var b=d.getAttribute("type");if(b=="fleetsector"){UniverseUtils.toggleMoveTo(false);UniverseUtils.renderFleetMenu(d,c);return;}if(b=="planetsector"){UniverseUtils.renderPlanetMenu(d,c);return;}if(b=="arenasector"){UniverseUtils.renderArenaMenu(d,c);return;}if(b=="fleetbattlesector"||b=="planetbattlesector"||b=="relicbattlesector"){UniverseUtils.renderBattleMenu(d,c);}if(b=="relicsector"){UniverseUtils.renderRelicMenu(d,c);}},oneSelected:function(f,d){UniverseUtils.toggleMoveTo(true);var b=f.getAttribute("type");var c=UniverseUtils.sourceSelected.getAttribute("type");if(b=="fleetsector"||c=="fleetsector"){UniverseUtils.hideFleetMenu(f,d);return;}UniverseUtils.hideMenu(f,d);},resetSourceSelected:function(){if(UniverseUtils.sourceSelected!=null){UniverseUtils.unselectSector(UniverseUtils.sourceSelected);UniverseUtils.sourceSelected=null;}},resetDestinySelected:function(){if(UniverseUtils.destinySelected!=null){UniverseUtils.unselectSector(UniverseUtils.destinySelected);UniverseUtils.destinySelected=null;}},resetSelected:function(){UniverseUtils.resetSourceSelected();UniverseUtils.resetDestinySelected();UniverseUtils.hideAllOptions();},hideAllOptions:function(){var b=$("optionMenuText");if(b!=null){b.getElements("div").each(function(c){c.className="optionHidden";});}},renderFleetMenu:function(d,c){if(fleets){var b=fleets[d.id];if(b==null){return;}if(b.cm){if(b.m){UniverseUtils.selectSector(d);UniverseUtils.sourceSelected=d;Menu.showUniverseMenu(c);UniverseEvents.fleetsectorSourceOnMove();}else{UniverseUtils.selectSector(d);UniverseUtils.sourceSelected=d;}}}},renderPlanetMenu:function(d,c){if(planets){var b=planets[d.id];if(b!=null){if(b.cw){UniverseUtils.sourceSelected=d;Menu.showUniverseMenu(c);UniverseEvents.planetsectorSource();}}}},genericShowMenu:function(g,f,b,d){if(b){var c=b[g.id];if(c!=null){UniverseUtils.sourceSelected=g;Menu.showUniverseMenu(f);d();}}},renderArenaMenu:function(c,b){UniverseUtils.genericShowMenu(c,b,arenas,UniverseEvents.arenasectorSource);},renderRelicMenu:function(c,b){UniverseUtils.genericShowMenu(c,b,relics,UniverseEvents.relicsectorSource);},renderBattleMenu:function(d,c){if(battles){var b=battles[d.id];if(b!=null){UniverseUtils.sourceSelected=d;Menu.showUniverseMenu(c);UniverseEvents.fleetbattlesectorSource();}}},hideFleetMenu:function(g,d){var f=$("optionMenu");var b=fleets[g.id];if(g.id==UniverseUtils.sourceSelected.id||!f.hasClass("hidden")){f.addClass("hidden");UniverseUtils.resetSelected();}else{Menu.showUniverseMenu(d);UniverseUtils.selectSector(g);UniverseUtils.destinySelected=g;var c=UniverseUtils.sourceTypeKey();UniverseEvents[c]();}},hideMenu:function(c,b){Menu.hideUniverseMenu(b);UniverseUtils.resetSelected();},genericCallBack:function(){},updateDestinyAndMove:function(){UniverseUtils.updateDestinyAndMove2(UniverseUtils.getDestinyCoordinate(),1);},updateDestinyAndMove2:function(f,d){var e=UniverseUtils.getSourceCoordinate();var c=fleets[e];UniverseUtils.updateTTM(c,d);c.m=true;c.d=f.replaceAll("_",":");UniverseUtils.hideMenu();var b=UniverseUtils.getFleetToolTipBody(c);Utils.updateTip($(e),b);},updateTTM:function(b,c){b.ttm=1;b.tttm=c;},cancelDestinyAndMove:function(){var c=UniverseUtils.getSourceCoordinate();var b=fleets[c];b.m=false;b.d="";UniverseUtils.hideMenu();Utils.updateTip($(c),UniverseUtils.getFleetToolTipBody(b));},moveEvent:function(){UniverseUtils.sendMoveRequest({Type:"move"});UniverseUtils.updateDestinyAndMove();},moveUndiscoveredEvent:function(){Menu.hideUniverseMenu();if(Message.raiseConfirm("MoveUndiscovered")){UniverseUtils.sendMoveRequest({Type:"moveundiscovered"});UniverseUtils.updateDestinyAndMove2(UniverseUtils.getDestinyCoordinate(),4);}},moveToValid:function(){var b=Number($("x").value);var e=Number($("y").value);var d=Number($("sx").value);var c=Number($("sy").value);return Utils.systemCoordinateValid(b)&&Utils.systemCoordinateValid(e)&&Utils.sectorCoordinateXValid(d)&&Utils.sectorCoordinateYValid(c);},moveEventWithCoordinates:function(){if(UniverseUtils.sourceSelected==null){RaiseError.needToSelectAFleetFirst();return;}if(UniverseUtils.moveToValid()){var c=$("x").value+"_"+$("y").value;var b=$("sx").value+"_"+$("sy").value;UniverseUtils.sendSimpleMoveRequest({Type:"coordValid",systemDst:c,sectorDst:b,CallBack:UniverseUtils.moveEventWithCoordinatesCallBack});}else{RaiseError.invalidCoordinate();}},moveEventWithCoordinatesCallBack:function(h,g,j,c){var e=$("x").value+"_"+$("y").value;var d=$("sx").value+"_"+$("sy").value;var k=UniverseUtils.getSourceSystem();var f=UniverseUtils.getSourceSector();var b=1;if(j=="False"){if(Message.raiseConfirm("MoveUndiscovered")){UniverseUtils.sendSimpleMoveRequest({Type:"moveundiscovered",systemSrc:k,sectorSrc:f,systemDst:e,sectorDst:d});UniverseUtils.updateDestinyAndMove2(e+"_"+d,4);}}else{UniverseUtils.sendSimpleMoveRequest({Type:"move",systemSrc:k,sectorSrc:f,systemDst:e,sectorDst:d});UniverseUtils.updateDestinyAndMove2(e+"_"+d,1);}},unloadCargoEvent:function(){UniverseUtils.sendMoveRequest({Type:"moveAndUnload"});UniverseUtils.updateDestinyAndMove();},attackEvent:function(){if(UniverseUtils.sendMoveRequest({Type:"attack"})){UniverseUtils.updateDestinyAndMove();}},attackPlanetConquerEvent:function(){if(UniverseUtils.sendMoveRequest({Type:"attackPlanet"})){UniverseUtils.updateDestinyAndMove();}},attackPlanetRaidEvent:function(){if(UniverseUtils.sendMoveRequest({Type:"raidPlanet"})){UniverseUtils.updateDestinyAndMove();}},pursuitAttackEvent:function(){$("optionMenu").addClass("hidden");var b=fleets[UniverseUtils.destinySelected.id];if(UniverseUtils.sendMoveRequest({Type:"pursuitandattack",FleetId:b.id})){UniverseUtils.updateDestinyAndMove();}},cancelEvent:function(){$("optionMenu").addClass("hidden");var b=fleets[UniverseUtils.getSourceCoordinate()];if(UniverseUtils.sendSimpleMoveRequest({Type:"cancelmove",FleetId:b.id})){UniverseUtils.cancelDestinyAndMove();}},transportEvent:function(){var b=fleets[UniverseUtils.getSourceCoordinate()];if(b.cpw){var d=UniverseUtils.getDestinySystem();var c=UniverseUtils.getDestinySector();UniverseMap.show(d,c);}else{RaiseError.cantPassWormHoles();}},conquerEvent:function(){if(UniverseUtils.sendMoveRequest({Type:"conquer"})){UniverseUtils.updateDestinyAndMove();}},challengeEvent:function(){if(UniverseUtils.sendMoveRequest({Type:"arenaChallenge"})){UniverseUtils.updateDestinyAndMove();}},showMarketEvent:function(){var d=UniverseUtils.getSourceCoordinate();var f=UniverseUtils.getDestinyCoordinate();var b=fleets[d];var e=markets[f];var c=Site.appPath+"SimpleMarket.aspx?Fleet="+b.id+"&Market="+e.id;Utils.createIFrame("simpleMarket",c,"Market",921,850);UniverseUtils.hideMenu();},showAcademyEvent:function(){var d=UniverseUtils.getSourceCoordinate();var b=fleets[d];var c=Site.appPath+"Academy.aspx?"+UniverseUtils.getFullCoordinateQueryString()+"&Fleet="+b.id;Utils.createIFrame("Academy",c,"Academy",921,490);UniverseUtils.hideMenu();},showPirateBayEvent:function(){var d=UniverseUtils.getDestinySystem();var c=d.split("_");var b=Site.appPath+"PirateBay.aspx?sysX="+c[0]+"&sysY="+c[1];Utils.createIFrame("PirateBay",b,"PirateBay",921,490);UniverseUtils.hideMenu();},showArenaEvent:function(){var c=UniverseUtils.getSourceCoordinate();var b=arenas[c];window.location=Site.appPath+"Arenas/ArenaInfo.aspx?ArenaStorage="+b.id;},viewBattleEvent:function(){var c=UniverseUtils.getSourceCoordinate();var b=battles[c];window.location=Site.appPath+"Battle/Battle.aspx?id="+b.bId;},showRelicEvent:function(){var e=UniverseUtils.getSourceCoordinate();var f=UniverseUtils.getDestinyCoordinate();var b=fleets[e];var d=relics[f];var c=Site.appPath+"Relic.aspx?"+UniverseUtils.getFullCoordinateQueryString();Utils.createIFrame("relic",c,"Relic",921,500);UniverseUtils.hideMenu();},showRelic2Event:function(){var f=UniverseUtils.getSourceCoordinate();var d=relics[f];var e=UniverseUtils.getSourceSystem();var c=UniverseUtils.getSourceSector();var g="systemSrc="+e+"&sectorSrc="+c;var b=Site.appPath+"Relic.aspx?"+g;Utils.createIFrame("relic",b,"Relic",921,500);UniverseUtils.hideMenu();},attackRelicEvent:function(){var c=UniverseUtils.getSourceCoordinate();var b=fleets[c];if(UniverseUtils.sendMoveRequest({Type:"attackRelic",FleetId:b.id})){UniverseUtils.updateDestinyAndMove();}},conquerRelicEvent:function(){var c=UniverseUtils.getSourceCoordinate();var b=fleets[c];if(UniverseUtils.sendMoveRequest({Type:"conquerRelic",FleetId:b.id})){UniverseUtils.updateDestinyAndMove();}},useUltimate:function(){if(UniverseUtils.sendMoveRequest({Type:"useUltimate",CallBack:Message.messageCallBack})){UniverseUtils.updateDestinyAndMove();}$("ultimateReady").value=0;},fireDevastation:function(){if(Message.raiseConfirm("DevastationUsageConfirmation")){if(UniverseUtils.sendMoveRequest({Type:"fireDevastation",CallBack:Message.messageCallBack})){UniverseUtils.hideMenu();$("ultimateReady").value=0;}}},goToMarketEvent:function(){UniverseUtils.moveEvent();},goToAcademyEvent:function(){UniverseUtils.moveEvent();},goToPirateBayEvent:function(){UniverseUtils.moveEvent();},selectSector:function(b){UniverseSelection.select(b);},unselectSector:function(b){UniverseSelection.unselect(b);},centerInFleet:function(b){UniverseUtils.sendRequest({Type:"centerfleet",Fleet:b,CallBack:UniverseUtils.load});},centerInPlanet:function(b){UniverseUtils.sendRequest({Type:"centerplanet",Planet:b,CallBack:UniverseUtils.load});},centerInCoordinate:function(b){UniverseUtils.sendRequest({Type:"centercoordinate",Coordinate:b,CallBack:UniverseUtils.load});},zoom1:function(){UniverseUtils.sendRequest({Type:"zoom",ZoomLevel:0,CallBack:UniverseUtils.load});},zoom2:function(){UniverseUtils.sendRequest({Type:"zoom",ZoomLevel:1,CallBack:UniverseUtils.load});},zoom3:function(){UniverseUtils.sendRequest({Type:"zoom",ZoomLevel:2,CallBack:UniverseUtils.load});},zoom4:function(){UniverseUtils.sendRequest({Type:"zoom",ZoomLevel:3,CallBack:UniverseUtils.load});},showPlanetIcons:function(){var b=UniverseUtils.showSmallIcons(planets,"Planets");UniverseUtils.insertIconInfoTip(b,"Planets");},showFleetIcons:function(){var b=UniverseUtils.showSmallIcons(fleets,"Fleets");UniverseUtils.insertIconInfoTip(b,"Fleets");},showWormHoleIcons:function(){var b=UniverseUtils.showSmallIcons(wormHoles,"WormHoles");UniverseUtils.insertGenericIconInfoTip(b);},showArenaIcons:function(){var b=UniverseUtils.showSmallIcons(arenas,"Arenas");UniverseUtils.insertGenericIconInfoTip(b);},showMarketIcons:function(){var b=UniverseUtils.showSmallIcons(markets,"Markets");UniverseUtils.insertGenericIconInfoTip(b);},showSmallIcons:function(b,c){UniverseUtils.removeAllToolTips();UniverseUtils.removeOlderIcons();return UniverseUtils.parseAndShowIcons(b,c);},removeOlderIcons:function(){$("universeItems").getElements("td").each(function(c){if(c.className!=""){var d=c.getPrevious("td");var b=new Element("td",{id:c.id});if(d!=null){c.destroy();b.inject(d,"after");}else{d=c.getNext("td");c.destroy();b.inject(d,"before");}}});},parseAndShowIcons:function(q,d){var e=new Hash();var f=$("playerName").value;for(var o in q){var g=q[o];var k=o.split("_");var n=Number(k[0]);var l=Number(k[1]);for(var h=1;h<zoneMapping.length;++h){if(g.on!=null&&g.on!=f){continue;}var j=zoneMapping[h];if(n>=j[0]&&l>=j[1]&&n<=j[2]&&l<=j[3]){var b="s"+h;UniverseUtils.showSmallIcon($(b),q,o,d);if(!e.has(b)){e.set(b,[]);}var p=e.get(b);p.include(g);break;}}}return e;},showSmallIcon:function(c,b,e,d){if(c!=null&&c.className==""){c.className=b[e].uty;c.addEvent("click",function(f){UniverseUtils.centerInCoordinate(e);});}},insertIconInfoTip:function(b,c){b.each(function(f,e){var g=Language.getToken(c);var d="";f.each(function(h){d+="<span class='tipItem'>"+h.n+"</span>: "+h.c+"<br/>";});Utils.insertTip($(e),g,d);});},insertGenericIconInfoTip:function(b){b.each(function(f,d){var g;var c="<span class='tipItem'>"+Language.getToken("Coordinate")+"</span>: ";f.each(function(h){g=h.n;c+=h.c;});var e=$(d);if(e!=null){Utils.insertTip(e,g,c);}});}};var UniverseMap={show:function(e,c){$("optionMenu").addClass("hidden");var d=UniverseUtils.destinySelected.getAttribute("isprivate");if(d==null){d=false;}var b="Ajax/Universe/WormHoleMap.ashx?system="+e+"&sector="+c+"&isPrivate="+d;if(!$("wormHoleMap")){UniverseMap.addWormHoleMapControl();}Utils.ajaxRequest("get",b,$("wormHoleMap"),UniverseMap.onShow);},onShow:function(c,d){var b=$("wormHoleMap").getElements("img");b.addEvent("mouseover",function(f){if(this.getAttribute("current")!="true"){if(this.src.indexOf("Private")>0){this.src=$("imagePath").value+"/Universe/WormHoleSmallestPrivateCurrent.png";}else{this.src=$("imagePath").value+"/Universe/WormHoleSmallestCurrent.png";}}});b.addEvent("mouseout",function(f){if(this.getAttribute("current")!="true"){if(this.src.indexOf("Private")>0){this.src=$("imagePath").value+"/Universe/WormHoleSmallestPrivate.png";}else{this.src=$("imagePath").value+"/Universe/WormHoleSmallest.png";}}});b.addEvent("click",function(h){if(this.getAttribute("current")!="true"){var g=this.getAttribute("system");var f=this.getAttribute("sector");UniverseMap.onMove(g,f);}});},onHide:function(){},onMove:function(c,b){UniverseMap.onHide();UniverseUtils.sendMoveRequest({Type:"transport",wormHoleSystemSrc:c,wormHoleSectorSrc:b});UniverseUtils.updateDestinyAndMove();Utils.closeFrame("wormHoleMapWindow");},addWormHoleMapControl:function(){var b={};var c="<div id='wormHoleMap'></div>";Utils.createFrame("wormHoleMapWindow","WormHole",c,b,UniverseUtils.resetDestinySelected);}};var UniverseEvents={eraseElementClass:function(b){$(b).className="";},showMove:function(){UniverseEvents.eraseElementClass("move");},unloadCargo:function(){UniverseEvents.eraseElementClass("unloadCargo");},showUndiscoveredMove:function(){UniverseEvents.eraseElementClass("moveUndiscovered");},showUltimateReady:function(){var b=UniverseUtils.getDestinyCoordinate();if($("ultimateReady").value=="1"&&ultimateInfo.r&&(!ultimateInfo.lm||(ultimateInfo.lm&&ultimateInfo.uc.contains(b)))){UniverseEvents.eraseElementClass("useUltimate");}},showUltimateNormalReady:function(){var b=UniverseUtils.getDestinyCoordinate();if($("ultimateReady").value=="1"&&ultimateInfo.r&&(!ultimateInfo.lm||(ultimateInfo.lm&&ultimateInfo.uc.contains(b)))){UniverseEvents.eraseElementClass("useUltimate");}},showTransport:function(){UniverseEvents.eraseElementClass("transport");},showAttack:function(){UniverseEvents.eraseElementClass("attack");},showPursuitAndAttack:function(){UniverseEvents.eraseElementClass("pursuitAndAttack");},showPlanetConquerAttack:function(){UniverseEvents.eraseElementClass("attackPlanetConquer");},showPlanetRaidAttack:function(){UniverseEvents.eraseElementClass("attackPlanetRaid");},showCancel:function(){UniverseEvents.eraseElementClass("cancel");},showChallenge:function(){UniverseEvents.eraseElementClass("challenge");},showConquer:function(){UniverseEvents.eraseElementClass("conquer");},showPlanetOptions:function(b){var c="Planets/Default.aspx?id="+b.id;$("viewPlanet").getFirst().href=c;UniverseEvents.eraseElementClass("viewPlanet");$("viewQueue").getFirst().href=c+"#/Planet_"+b.id+"/Panel_Queue/";UniverseEvents.eraseElementClass("viewQueue");if(b.p){$("buildUnits").getFirst().href=c+"#/Planet_"+b.id+"/Panel_Units/";UniverseEvents.eraseElementClass("buildUnits");}$("viewFleets").getFirst().href=c+"#/Planet_"+b.id+"/Panel_Fleets/";UniverseEvents.eraseElementClass("viewFleets");$("viewManage").getFirst().href=c+"#/Planet_"+b.id+"/Panel_Manage/";UniverseEvents.eraseElementClass("viewManage");},showMarket:function(){UniverseEvents.eraseElementClass("market");},showAcademy:function(){UniverseEvents.eraseElementClass("academy");},showPirateBay:function(){UniverseEvents.eraseElementClass("pirateBay");},showArena:function(){UniverseEvents.eraseElementClass("arena");},showToMarket:function(){UniverseEvents.eraseElementClass("toMarket");},showToAcademy:function(){UniverseEvents.eraseElementClass("toAcademy");},showToPirateBay:function(){UniverseEvents.eraseElementClass("toPirateBay");},showBattleLink:function(){UniverseEvents.eraseElementClass("viewBattle");},showRelic:function(){UniverseEvents.eraseElementClass("showRelic");},showRelic2:function(){UniverseEvents.eraseElementClass("showRelic2");},showAttackRelic:function(){UniverseEvents.eraseElementClass("attackRelic");},showConquerRelic:function(){UniverseEvents.eraseElementClass("conquerRelic");},showNoOption:function(){UniverseEvents.eraseElementClass("noOption");},fleetsectorSourceOnMove:function(){UniverseUtils.hideAllOptions();UniverseEvents.showCancel();},fleetsectorSource:function(){UniverseUtils.hideAllOptions();UniverseEvents[UniverseUtils.destinyTypeKey()]();},planetsectorSource:function(){UniverseUtils.hideAllOptions();var c=UniverseUtils.getSourceCoordinate();var b=planets[c];if(b.id!=0){UniverseEvents.showPlanetOptions(b);}},fleetbattlesectorSource:function(){UniverseUtils.hideAllOptions();UniverseEvents.showBattleLink();},arenasectorSource:function(){UniverseUtils.hideAllOptions();UniverseEvents.showArena();},marketsectorSource:function(){UniverseUtils.hideAllOptions();UniverseEvents.showMarket();},academysectorSource:function(){UniverseUtils.hideAllOptions();UniverseEvents.showAcademy();},pirateBaysectorSource:function(){UniverseUtils.hideAllOptions();UniverseEvents.showPirateBay();},relicsectorSource:function(){UniverseUtils.hideAllOptions();var d=UniverseUtils.getSourceCoordinate();var c=relics[d];var b=$("playerName").value;if(b==c.on){UniverseEvents.showRelic2();}else{UniverseEvents.showNoOption();}},fleetsectorDestiny:function(){var c=UniverseUtils.getDestinyCoordinate();var b=fleets[c];if(b.ca){if(b.m){UniverseEvents.showPursuitAndAttack();}else{UniverseEvents.showAttack();}UniverseEvents.showUltimateReady();}else{UniverseEvents.showNoOption();}},planetsectorDestiny:function(){var c=UniverseUtils.getDestinyCoordinate();var b=planets[c];if(b.cm){UniverseEvents.showMove();UniverseEvents.unloadCargo();}if(b.ca){UniverseEvents.showPlanetConquerAttack();UniverseEvents.showPlanetRaidAttack();UniverseEvents.showUltimateReady();}if(b.cc){UniverseEvents.showConquer();}if(!b.ca&&!b.cm&&!b.cc){UniverseEvents.showNoOption();}},wormholesectorDestiny:function(){UniverseEvents.showTransport();},privatewormholesectorDestiny:function(){UniverseEvents.showTransport();},normalsectorDestiny:function(){UniverseEvents.showMove();UniverseEvents.showUltimateNormalReady();},undiscoveredsectorDestiny:function(){UniverseEvents.showUndiscoveredMove();},resourcesectorDestiny:function(){UniverseEvents.showMove();},arenasectorDestiny:function(){UniverseEvents.showChallenge();},marketsectorDestiny:function(){var b=UniverseUtils.getSourceCoordinate();var c=UniverseUtils.getDestinyCoordinate();if(markets[c].a.contains(b)){UniverseEvents.showMarket();}else{UniverseEvents.showToMarket();}},bugswormholesectorDestiny:function(){UniverseEvents.showTransport();},fleetbattlesectorDestiny:function(){UniverseEvents.showNoOption();},beaconsectorDestiny:function(){UniverseEvents.showNoOption();},academysectorDestiny:function(){var b=UniverseUtils.getSourceCoordinate();var c=UniverseUtils.getDestinyCoordinate();if(academies[c].a.contains(b)){UniverseEvents.showAcademy();}else{UniverseEvents.showToAcademy();}},piratebaysectorDestiny:function(){var b=UniverseUtils.getSourceCoordinate();var c=UniverseUtils.getDestinyCoordinate();if(piratebays[c].a.contains(b)){UniverseEvents.showPirateBay();}else{UniverseEvents.showToPirateBay();}},relicsectorDestiny:function(){var d=UniverseUtils.getSourceCoordinate();var b=fleets[d];if(b!=null){var d=UniverseUtils.getDestinyCoordinate();var c=relics[d];if(c.cc){UniverseEvents.showConquerRelic();}if(c.ca){UniverseEvents.showAttackRelic();UniverseEvents.showUltimateReady();}if(c.on==b.on){UniverseEvents.showRelic();}}}};var UniverseSelection={changeToSelect:function(b){b.className=b.className+"Hover";},changeToUnselect:function(b){b.className=b.className.replace("Hover","");},select:function(c){var b=c.getAttribute("type");UniverseSelection[b+"Select"](c);},unselect:function(c){var b=c.getAttribute("type");UniverseSelection[b+"Unselect"](c);},fleetsectorSelect:function(b){UniverseSelection.changeToSelect(b);},fleetsectorUnselect:function(b){UniverseSelection.changeToUnselect(b);},planetsectorSelect:function(b){},planetsectorUnselect:function(b){},wormholesectorSelect:function(b){UniverseSelection.changeToSelect(b);},wormholesectorUnselect:function(b){UniverseSelection.changeToUnselect(b);},privatewormholesectorSelect:function(b){UniverseSelection.changeToSelect(b);},privatewormholesectorUnselect:function(b){UniverseSelection.changeToUnselect(b);},normalsectorSelect:function(b){},normalsectorUnselect:function(b){},undiscoveredsectorSelect:function(b){},undiscoveredsectorUnselect:function(b){},resourcesectorSelect:function(b){},resourcesectorUnselect:function(b){UniverseSelection.changeToUnselect(b);},arenasectorSelect:function(b){UniverseSelection.changeToSelect(b);},arenasectorUnselect:function(b){UniverseSelection.changeToUnselect(b);},marketsectorSelect:function(b){UniverseSelection.changeToSelect(b);},marketsectorUnselect:function(b){UniverseSelection.changeToUnselect(b);},fleetbattlesectorSelect:function(b){},fleetbattlesectorUnselect:function(b){},bugswormholesectorSelect:function(b){UniverseSelection.changeToSelect(b);},bugswormholesectorUnselect:function(b){UniverseSelection.changeToUnselect(b);},beaconsectorSelect:function(b){UniverseSelection.changeToSelect(b);},beaconsectorUnselect:function(b){UniverseSelection.changeToUnselect(b);},academysectorSelect:function(b){UniverseSelection.changeToSelect(b);},academysectorUnselect:function(b){UniverseSelection.changeToUnselect(b);},piratebaysectorSelect:function(b){UniverseSelection.changeToSelect(b);},piratebaysectorUnselect:function(b){UniverseSelection.changeToUnselect(b);},relicsectorSelect:function(b){UniverseSelection.changeToSelect(b);},relicsectorUnselect:function(b){UniverseSelection.changeToUnselect(b);}};var UniverseDirection={b:function(){},addEvents:function(b){b.addEvent("click",function(d){var c=this.getAttribute("code");UniverseDirection.updateUniverse(d,c);});b.addEvent("mouseout",function(c){this.removeClass("selected");});b.addEvent("mouseover",function(c){this.addClass("selected");});},load:function(){var b=$("uab");if(b){UniverseDirection.addEvents($("uab"));UniverseDirection.addEvents($("uad"));UniverseDirection.addEvents($("uae"));UniverseDirection.addEvents($("uag"));}},updateUniverse:function(c,b){UniverseUtils.sendRequest({Type:"movemap",Code:b,CallBack:UniverseUtils.load});},onUpdateUniverseCallBack:function(){UniverseUtils.load();}};window.addEvent("domready",function(){if($("universe")){UniverseUtils.load();}});var Menu={position:function(g,f){var c=window.getSize();var b=window.getScroll();var d={x:"left",y:"top"};var e={x:16,y:16};for(var h in d){var j=f.page[h]+e[h];if((j-b[h])>c[h]){j=f.page[h]-e[h];}g.setStyle(d[h],j);}},positionByElement:function(b,e,c){var n=window.getSize();var k=window.getScroll();var l={x:b.offsetWidth,y:b.offsetHeight};var j=e.getCoordinates();var d={x:j.left,y:j.top};var g={x:"left",y:"top"};for(var f in g){var h=d[f]+c[f];if((h+l[f]-k[f])>n[f]){h=d[f]-c[f]-l[f];}b.setStyle(g[f],h);}},showUniverseMenu:function(b){var c=$("optionMenu");Menu.position(c,b);c.removeClass("hidden");},hideUniverseMenu:function(b){var c=$("optionMenu");c.addClass("hidden");}};var Fleet={fleetLists:null,quantityInput:null,currentClone:null,currentItem:null,changeLog:"",load:function(){Fleet.fleetLists=$$(".fleetUnits, .BattleMoonUnits, .BlinkerUnits, .QueenUnits");if(Fleet.fleetLists.length>0){Fleet.fleetLists.each(function(b){Fleet.setDrag(b);});$("transferQuantity").addEvent("click",Fleet.transferQuantity);$("cancelTransfer").addEvent("click",Fleet.clearTransferInfo);$("saveChanges").addEvent("click",Fleet.saveChangesPlanet);$("saveChanges").disabled=true;Fleet.quantityInput=$("quantity");FleetCargo.load();}},sendRequest:function(c){var b=Site.appPath+"Ajax/Fleet/Fleet.ashx?1=1";for(var d in c){if(d!="CallBack"){b+="&"+d+"="+c[d];}}if(c.CallBack==null){c.CallBack=Fleet.genericCallBack;}Utils.ajaxRequest("get",b,null,c.CallBack);},setDrag:function(b){b.getElements("div").each(function(c){c.addEvent("mousedown",function(d){if(b==null){return;}if(Fleet.isInBattle(b)){RaiseError.fleetInBattle();return;}if(Fleet.isMoving(b)){RaiseError.fleetIsMoving();return;}Fleet.unitClick(this,b,d);});});},isInBattle:function(c){var b=c.getAttribute("isInBattle");return b=="true";},isMoving:function(c){var b=c.getAttribute("isMoving");return b=="true";},unitClick:function(d,c,f){var g=Fleet.getClone(d);var b=g.makeDraggable({droppables:Fleet.fleetLists,onDrop:function(e,j){if(j==null){g.dispose();return;}if(Fleet.isInBattle(j)){RaiseError.fleetInBattle();g.dispose();j.removeClass("fleetUnitsOver");return;}if(Fleet.isMoving(j)){RaiseError.fleetIsMoving();g.dispose();j.removeClass("fleetUnitsOver");return;}var h=d.getParent();if(j&&j!=h&&Fleet.isFleetAround(h,j)){Fleet.dropEvent(g,d,j);}else{g.dispose();}},onEnter:function(e,j){var h=d.getParent();if(j!=h&&Fleet.isFleetAround(h,j)){j.addClass("fleetUnitsOver");}},onLeave:function(e,h){if(h!=c){h.removeClass("fleetUnitsOver");}}});b.start(f);},chooseClassToAdd:function(b){if(b.hasClass("BattleMoonUnits")){b.addClass("BattleMoonUnitsOver");return;}if(b.hasClass("BlinkerUnits")){b.addClass("BlinkerUnitsOver");return;}if(b.hasClass("QueenUnitsUnits")){b.addClass("QueenUnitsUnitsOver");return;}b.addClass("fleetUnitsOver");},chooseClassToRemove:function(b){if(b.hasClass("BattleMoonUnitsOver")){b.removeClass("BattleMoonUnitsOver");return;}if(b.hasClass("BlinkerUnitsOver")){b.removeClass("BlinkerUnitsOver");return;}if(b.hasClass("QueenUnitsUnitsOver")){b.removeClass("QueenUnitsUnitsOver");return;}b.removeClass("fleetUnitsOver");},isFleetAround:function(e,b){if(Fleets){var d=Fleets[b.getAttribute("fleetid")];var c=Number(e.getAttribute("fleetid"));if(!d.p.contains(c)){return false;}}return true;},getClone:function(c){var d=c.clone();var b=c.getAttribute("unitName");d.setAttribute("unitName",b);d.setStyles(c.getCoordinates());d.setStyles({opacity:0.7,position:"absolute"});d.inject(document.body);return d;},dropEvent:function(e,c,b){if(Fleet.currentClone!=null){Fleet.clearTransferInfo();}var d=$("quantitySelector");Menu.positionByElement(d,e,{x:30,y:30});d.removeClass("hidden");Fleet.quantityInput.focus();Fleet.quantityInput.value=e.getFirst().getAttribute("quantity");Fleet.currentClone=e;Fleet.currentItem=c;Fleet.currentDestiny=b;},clearTransferInfo:function(){var b=$("quantitySelector");b.addClass("hidden");Fleet.currentClone.dispose();Fleet.currentDestiny.removeClass("fleetUnitsOver");Fleet.currentClone=null;Fleet.currentItem=null;Fleet.currentDestiny=null;},transferQuantity:function(g){var b=Fleet.currentClone.getAttribute("unitName");var f=Number(Fleet.quantityInput.value);var c=Number(Fleet.currentClone.getFirst().getAttribute("quantity"));if(f>0&&f<=c){var d=Fleet.addQuantity(b,f);if(d){if(f==c){Fleet.currentItem.destroy();}else{var h=Number(c)-Number(f);Fleet.changeQuantity(Fleet.currentItem,h);}}else{RaiseError.fleetAtMaximum();}Fleet.clearTransferInfo();}else{RaiseError.invalidQuantity();}},addQuantity:function(b,e){var c=false;var d=Fleet.currentDestiny.getElements("div");d.each(function(k){if(c){return;}var g=k.getAttribute("unitName");if(g==b){Fleet.registerChange(b,e);var j=k.getFirst().getAttribute("quantity");var h=Number(j)+Number(e);Fleet.changeQuantity(k,h);c=true;}});if(c){return true;}if(d.length<8){var f=Fleet.currentItem.clone();f.addEvent("mousedown",function(g){Fleet.unitClick(this,Fleet.currentDestiny,g);});Fleet.currentDestiny.adopt(f);Fleet.changeQuantity(f,e);Fleet.registerChange(b,e);return true;}return false;},changeQuantity:function(d,e){var b=d.getFirst();b.setAttribute("quantity",e);var c=d.getElement("span");c.empty();c.appendText(e);},registerChange:function(c,e){var d=Fleet.currentItem.getParent().getAttribute("fleetId");var b=Fleet.currentDestiny.getAttribute("fleetId");Fleet.changeLog+=d+"-"+b+"-"+c+"-"+e+";";$("saveChanges").disabled=false;},genericCallBack:function(){Fleet.changeLog="";Fleet.load();},saveChangesPlanet:function(){Fleet.sendRequest({Type:"change",Changes:Fleet.changeLog,CargoChanges:FleetCargo.changeLog,IsInPlanet:1,CallBack:Fleet.saveChangesCallBack});},saveChangesPlayer:function(){Fleet.sendRequest({Type:"change",Changes:Fleet.changeLog,CargoChanges:FleetCargo.changeLog,IsInPlanet:0,CallBack:Fleet.saveChangesCallBack});},saveChangesCallBack:function(){Fleet.changeLog="";Fleet.load();Message.raiseAlert("FleetSavedWithSuccess");},deleteFleet:function(f,b,d){if(!Message.raiseConfirm("AreYouSureYouWantToDeleteFleet")){return;}var c=$("fleet"+b);var e=$("fleet"+d);c.getElements(".fleetListUnit").each(function(k){var g=k.getAttribute("unitName");var j=k.getFirst().getAttribute("quantity");var h=false;var l=e.getElements(".fleetListUnit");l.each(function(n){var q=n.getAttribute("unitName");if(q==g){var p=n.getFirst().getAttribute("quantity");var o=Number(j)+Number(p);Fleet.changeQuantity(n,o);h=true;}});if(!h){e.adopt(k);}});c.getParent().dispose();Fleet.sendRequest({Type:"delete",PlanetId:f,FleetId:b});},deleteEmptyFleet:function(b){if(!Message.raiseConfirm("AreYouSureYouWantToDeleteFleet")){return;}var c=$("fleet"+b);c.getParent().dispose();Fleet.sendRequest({Type:"deleteEmpty",FleetId:b});},dropTradeCargo:function(b,c){var d=$(c);d.getElements(".cargoList").each(function(f){var e=f.getAttribute("isTradeResource");if(e=="true"){f.destroy();}});if(d.getElements(".cargoList").length==0){d.destroy();}else{$(c).getElements(".dropTradeFleetCargo").each(function(e){e.destroy();});}Fleet.sendRequest({Type:"dropfleetcargo",FleetId:b});}};window.addEvent("domready",function(){if($("fleetList")){Fleet.load();}});window.addEvent("domready",function(){var b=$("marketTable");if(b!=null){b.getElements("tr>td>input[type=text]").addEvent("keyup",function(c){this.value=ClearAlphas(this.value);this.getNext("div").lastChild.innerHTML=this.value*this.parentNode.previousSibling.previousSibling.innerHTML;});}});function ClearAlphas(d){var e="";for(var b=0;b<d.length;++b){var c=parseFloat(d[b]);if(!isNaN(c)){e+=d[b];}}return e;}function AHFilter(){var b=$("searchChange");b.value=1;}var Ticker={data:[],tickerPanel:null,elements:[],bootstrap:function(b){if($("tickerPlaceHolder")==null){return;}Ticker.tickerPanel=$("ticker");log.debug("Bootstrap Ticker...");Ticker.sendRequest(true);setInterval("Ticker.fetchData();",750);},fetchData:function(){var e=Ticker.data.pop();log.debug("Fetching data... ");if(e!=null){log.info(e);var b=new Element("li",{html:e,styles:{opacity:0}});b.inject(Ticker.tickerPanel,"top");var d=new Fx.Tween(b,{property:"opacity",duration:500});d.start(1);Ticker.elements.push(b);}if(Ticker.elements.length>25){var c=Ticker.elements.shift();c.dispose();}},updateTicker:function(){log.debug("Got response: "+(window.tickerData.length-1)+" items");for(var b=1;b<window.tickerData.length;++b){Ticker.data.push(window.tickerData[b]);}setTimeout("Ticker.sendRequest(false);",1000*5);},sendRequest:function(c){log.debug("Sending request to Ticker...");var b="Ajax/Utils/Ticker.ashx";if(c){b+="?Bootstrap=1";}Utils.ajaxRequest("get",b,$("tickerPlaceHolder"),Ticker.updateTicker);}};window.addEvent("domready",Ticker.bootstrap);var Advertising={index:0,bootstrap:function(){if(null!=window.Auction&&1<window.Auction.length){for(var b=0;b<10;++b){Advertising.fetchData();}setInterval("Advertising.fetchData();",3000);}},fetchData:function(){if(Advertising.index>=window.Auction.length-1){Advertising.index=0;}var g=window.Auction[++Advertising.index];var f=$("ahAd");var b=new Element("tr",{styles:{opacity:0}});var d=f.getElement("tr").getParent();b.inject(d);var c=new Element("td",{html:g.quant});c.inject(b);c=new Element("td",{html:"<img class='smallShip' src='"+Utils.resolveImage(g.name)+"' alt='obj.name' title='obj.name'/>"});c.inject(b);c=new Element("td",{html:g.bid});c.inject(b);c=new Element("td",{html:g.buy});c.inject(b);var e=new Fx.Tween(b,{property:"opacity",duration:1000});if(d.getChildren().length>11){d.getElements("tr:nth-child(2)").dispose();}e.start(1);}};window.addEvent("domready",Advertising.bootstrap);var checkboxHeight="25";var radioHeight="25";var selectWidth="190";var Custom={init:function(){var c=document.getElementsByTagName("input");var b;var d;var e;for(a=0;a<c.length;a++){Custom.initInput(c[a]);}c=document.getElementsByTagName("select");for(a=0;a<c.length;a++){Custom.initSelect(c[a]);}},initInput:function(b){if((b.type=="checkbox"||b.type=="radio")&&b.className=="styled"){var c=document.createElement("span");c.className=b.type;if(b.checked==true){if(b.type=="checkbox"){position="0 -"+(checkboxHeight*2)+"px";c.style.backgroundPosition=position;}else{position="0 -"+(radioHeight*2)+"px";c.style.backgroundPosition=position;}}b.parentNode.insertBefore(c[a],b);b.onchange=Custom.clear;c.onmousedown=Custom.pushed;c.onmouseup=Custom.check;document.onmouseup=Custom.clear;}},initSelect:function(b){var e;if(b.selectedIndex>=0){e=b.options[b.selectedIndex].innerHTML;}else{e="";}b.className="styled";var d=document.createElement("span");d.className="select";d.id="select"+b.name;d.innerHTML=e;b.parentNode.insertBefore(d,b);b.correctOnChange=b.onchange;b.onchange=Custom.choose;Custom.initialChoose(b);if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var c=window.location+"";if(c.indexOf("AuctionHouse")>-1){d.style.margin="0px 0px 0px 0px";return;}if(c.indexOf("AddToAuction")>-1){d.style.margin="0px 0px 0px 120px";return;}if(c.indexOf("PaymentType.")>-1){d.style.margin="0px 0px 0px 190px";return;}if(c.indexOf("SearchPlayers.")>-1||c.indexOf("CreateFriendly.")>-1){d.style.margin="0px 0px 0px 40px";return;}if(c.indexOf("CreateArena.")>-1){d.style.margin="0px 0px 0px 170px";}if(c.indexOf("Team.")>-1){d.style.margin="0px 0px 0px 40px";}if(c.indexOf("PaymentType.aspx?Type=Sms")>-1){d.style.margin="0px 0px 0px 120px";return;}}},pushed:function(){element=this.nextSibling;if(element.checked==true&&element.type=="checkbox"){this.style.backgroundPosition="0 -"+checkboxHeight*3+"px";}else{if(element.checked==true&&element.type=="radio"){this.style.backgroundPosition="0 -"+radioHeight*3+"px";}else{if(element.checked!=true&&element.type=="checkbox"){this.style.backgroundPosition="0 -"+checkboxHeight+"px";}else{this.style.backgroundPosition="0 -"+radioHeight+"px";}}}},check:function(){element=this.nextSibling;if(element.checked==true&&element.type=="checkbox"){this.style.backgroundPosition="0 0";element.checked=false;}else{if(element.type=="checkbox"){this.style.backgroundPosition="0 -"+checkboxHeight*2+"px";}else{this.style.backgroundPosition="0 -"+radioHeight*2+"px";group=this.nextSibling.name;inputs=document.getElementsByTagName("input");for(a=0;a<inputs.length;a++){if(inputs[a].name==group&&inputs[a]!=this.nextSibling){inputs[a].previousSibling.style.backgroundPosition="0 0";}}}element.checked=true;}},clear:function(){inputs=document.getElementsByTagName("input");for(var c=0;c<inputs.length;c++){if(inputs[c].type=="checkbox"&&inputs[c].checked==true&&inputs[c].className=="styled"){inputs[c].previousSibling.style.backgroundPosition="0 -"+checkboxHeight*2+"px";}else{if(inputs[c].type=="checkbox"&&inputs[c].className=="styled"){inputs[c].previousSibling.style.backgroundPosition="0 0";}else{if(inputs[c].type=="radio"&&inputs[c].checked==true&&inputs[c].className=="styled"){inputs[c].previousSibling.style.backgroundPosition="0 -"+radioHeight*2+"px";}else{if(inputs[c].type=="radio"&&inputs[c].className=="styled"){inputs[c].previousSibling.style.backgroundPosition="0 0";}}}}}},choose:function(){if(this.correctOnChange!=null){this.correctOnChange();}var b=this.options[this.selectedIndex];document.getElementById("select"+this.name).innerHTML=b.innerHTML;},initialChoose:function(b){if(b.selectedIndex>=0){var c=b.options[b.selectedIndex];document.getElementById("select"+b.name).innerHTML=c.innerHTML;}else{document.getElementById("select"+b.name).innerHTML="";}}};window.addEvent("domready",function(){Custom.init();});var Prices={sendRequest:function(c){var b=Site.appPath+"Ajax/Prices/Prices.ashx?1=1";for(var d in c){if(d!="CallBack"){b+="&"+d+"="+c[d];}}if(c.CallBack==null){c.CallBack=UniverseUtils.genericCallBack;}Utils.ajaxRequest("get",b,$("pricesContent"),c.CallBack);},changes:function(){var c=$("languageChooser").value;var b=Site.appPath+"Ajax/Prices/Prices.ashx?Type=Change&Language="+c;Utils.ajaxRequest("get",b,$("pricesContent"));},getQueryString:function(b){hu=window.location.search.substring(1);gy=hu.split("&");for(i=0;i<gy.length;i++){ft=gy[i].split("=");if(ft[0]==b){return ft[1];}}}};window.addEvent("domready",function(){if($("languageChooser")){$("languageChooser").correctOnChange=Prices.changes;}});function printPage(b){var c=Prices.getQueryString("Invoice");if(c!=null){b+="?Invoice="+c;}window.open(b,Language.getToken("Invoice"),"width=1024;menubar=no,scrollbars=yes");}var Quests={sendQuestRequest:function(c,d,b){for(var e in b){if(e!="CallBack"){c+="&"+e+"="+b[e];}}if(b.CallBack==null){b.CallBack=UniverseUtils.genericCallBack;}Utils.ajaxRequest("get",c,d,b.CallBack);},sendRequest:function(c){var b=Site.appPath+"Ajax/Quests/Quest.ashx?1=1";Quests.sendQuestRequest(b,$("quest"),c);},getQuest:function(b){Quests.sendRequest({Type:"quest",Info:b,CallBack:Quests.getQuestCallBack});},getQuest2:function(b,c){Quests.sendRequest({Type:"quest",Info:b,Id:c,CallBack:Quests.getQuestCallBack});},getQuest3:function(c,b){Quests.sendRequest({Type:"quest",Info:c,Target:b,CallBack:Quests.getQuestCallBack});},getQuestCallBack:function(e,b,f,d){if($("questWindow")==null){var c={top:200,closeEvent:"Quests.closeFrame();"};Utils.createBorder("questWindow",f,c);new Fx.Scroll(window,{}).toElement("globalMenu");}},accept:function(c,b){Quests.sendRequest({Type:"accept",Info:c,Target:b,CallBack:Quests.closeFrame});},cancel:function(b,c){Quests.sendRequest({Type:"cancel",Info:b,Id:c,CallBack:Quests.closeFrame});},deliver:function(b,c){Quests.sendRequest({Type:"deliver",Info:b,Id:c,CallBack:Quests.showResult});},getBounty:function(b){Quests.sendRequest({Type:"bounty",Id:b,CallBack:Quests.getQuestCallBack});},acceptBounty:function(b){Quests.sendRequest({Type:"acceptBounty",Id:b,CallBack:Quests.closeFrame});},cancelBounty:function(b){Quests.sendRequest({Type:"cancelBounty",Id:b,CallBack:Quests.closeFrame});},closeFrame:function(){Utils.closeFrame("questWindow");window.location=window.location;},showResult:function(d,b,e,c){$("result").innerHTML=e;if(e.indexOf("success")!=-1){$("questButtons").dispose();}},deliverAcademyQuestItem:function(f,e,d){var c=Site.appPath+"Ajax/Quests/Quest.ashx?system="+e+"&sector="+d;var b={Type:"deliverAcademyQuestItem",Fleet:f};Quests.sendQuestRequest(c,$("questsToDeliver"),b);}};var FleetCargo={fleetCargos:null,quantityInput:null,currentClone:null,currentItem:null,changeLog:"",load:function(){FleetCargo.fleetCargos=$$(".fleetCargo");if(FleetCargo.fleetCargos.length>0){FleetCargo.fleetCargos.each(function(b){FleetCargo.setCargoDrag(b);});$("transferCargoQuantity").addEvent("click",FleetCargo.transferQuantity);$("cancelCargoTransfer").addEvent("click",FleetCargo.clearTransferInfo);FleetCargo.quantityInput=$("quantityCargo");}},setCargoDrag:function(c){var b=c.getPrevious("div");c.getElements("div").each(function(d){if(d.hasClass("cargoList")){d.addEvent("mousedown",function(f){if(b==null){return;}if(Fleet.isInBattle(b)){RaiseError.fleetInBattle();return;}if(Fleet.isMoving(b)){RaiseError.fleetIsMoving();return;}FleetCargo.resourceClick(this,c,f);});}});},resourceClick:function(d,c,f){var g=Fleet.getClone(d);var b=g.makeDraggable({droppables:FleetCargo.fleetCargos,onDrop:function(e,j){if(j==null){g.dispose();return;}if(FleetCargo.isInBattle(j)){RaiseError.fleetInBattle();g.dispose();j.removeClass("fleetCargoOver");return;}if(FleetCargo.isMoving(j)){RaiseError.fleetIsMoving();g.dispose();j.removeClass("fleetCargoOver");return;}var h=d.getParent();if(j&&j!=h&&FleetCargo.isFleetAround(h,j)){FleetCargo.dropCargoEvent(g,d,j);}else{g.dispose();}},onEnter:function(e,j){var h=d.getParent();if(j!=h&&FleetCargo.isFleetAround(h,j)){j.addClass("fleetCargoOver");}},onLeave:function(e,h){if(h!=c){h.removeClass("fleetCargoOver");}}});b.start(f);},isInBattle:function(b){return Fleet.isInBattle(b.getPrevious());},isMoving:function(b){return Fleet.isMoving(b.getPrevious());},isFleetAround:function(b,c){return Fleet.isFleetAround(b.getPrevious(),c.getPrevious());},clearTransferInfo:function(){var b=$("quantityCargoSelector");b.addClass("hidden");FleetCargo.currentClone.dispose();FleetCargo.currentDestiny.removeClass("fleetCargoOver");FleetCargo.currentClone=null;FleetCargo.currentItem=null;FleetCargo.currentDestiny=null;},dropCargoEvent:function(e,c,b){if(FleetCargo.currentClone!=null){FleetCargo.clearTransferInfo();}var d=$("quantityCargoSelector");Menu.positionByElement(d,e,{x:30,y:30});d.removeClass("hidden");FleetCargo.quantityInput.focus();FleetCargo.quantityInput.value=e.getChildren("span")[0].innerHTML;FleetCargo.currentClone=e;FleetCargo.currentItem=c;FleetCargo.currentDestiny=b;},transferQuantity:function(){var c=FleetCargo.currentClone.getFirst().getAttribute("resourceName");var e=Number(FleetCargo.quantityInput.value);var b=Number(FleetCargo.getQuantity(FleetCargo.currentClone));if(e>0&&e<=b){var d=FleetCargo.addQuantity(c,e);if(d){if(e==b){FleetCargo.currentItem.destroy();}else{var f=Number(b)-Number(e);FleetCargo.changeQuantity(FleetCargo.currentItem,f);}}FleetCargo.clearTransferInfo();}else{RaiseError.invalidQuantity();}},getQuantity:function(b){return FleetCargo.getQuantitySpan(b).innerHTML;},getQuantitySpan:function(b){return b.getChildren("span")[0];},addQuantity:function(b,e){var c=false;var d=FleetCargo.currentDestiny.getElements(".cargoList");d.each(function(j){if(c){return;}var g=j.getFirst().getAttribute("resourcename");if(g==b){FleetCargo.registerChange(b,e);var k=FleetCargo.getQuantity(j);var h=Number(k)+Number(e);FleetCargo.changeQuantity(j,h);c=true;}});if(c){return true;}var f=FleetCargo.currentItem.clone();f.addEvent("mousedown",function(g){FleetCargo.resourceClick(this,FleetCargo.currentDestiny,g);});FleetCargo.currentDestiny.adopt(f);FleetCargo.changeQuantity(f,e);FleetCargo.registerChange(b,e);return true;},changeQuantity:function(d,e){var b=d.getFirst();b.setAttribute("quantity",e);var c=FleetCargo.getQuantitySpan(d);c.empty();c.appendText(e);},registerChange:function(c,e){var d=FleetCargo.currentItem.getParent().getPrevious().getAttribute("fleetId");var b=FleetCargo.currentDestiny.getPrevious().getAttribute("fleetId");FleetCargo.changeLog+=d+"-"+b+"-"+c+"-"+e+";";$("saveChanges").disabled=false;}};var Forum={currentElement:null,previousHash:null,init:function(){Site.HistoryManager.addEvent("onHistoryChange",Forum.onHistoryChanged);try{if(window.location.href.indexOf("#")>=0){Forum.onHistoryChanged(window.location.hash);}}catch(b){log.error(b);}},sendForumRequest:function(c,d,b,e){var g="/";var h="1=1";for(var f in b){if(f!="CallBack"){h+="&"+f+"="+b[f];if(f!="Text"&&f!="Description"){g+=f+"_"+b[f]+"/";}}}if(b.CallBack==null){b.CallBack=Forum.genericCallBack;}Site.HistoryManager.addState(g);Forum.previousHash=g;new Fx.Scroll(window,{}).toElement(d);Forum.currentElement=d;if(e=="get"){c+="?"+h;Utils.simpleLoadAjaxGet(c,d,b.CallBack);}else{Utils.simpleLoadAjaxPost(c,d,b.CallBack,h);}return true;},genericCallBack:function(f,e,j,h){Forum.currentElement.setStyle("opacity",0);var g=new Fx.Tween(Forum.currentElement,{property:"opacity",duration:500});g.start(1);},sendRequest:function(c,d){var b=Site.appPath+"Ajax/Forum/Forum.ashx";return Forum.sendForumRequest(b,$(d),c,"get");},sendPostRequest:function(c,d){var b=Site.appPath+"Ajax/Forum/Forum.ashx";return Forum.sendForumRequest(b,$(d),c,"post");},getMethod:function(c){var d=c[1];var b=d.split("_");if(b[0]=="Type"){return b[1];}return null;},getParam:function(c){var d=c[2];var b=d.split("_");if(b.length==2){return b[1];}return null;},onHistoryChanged:function(b){b=b.replace("#","");if(b==""||b=="/"){window.location="Forum.aspx";return;}if(Forum.previousHash==b){return;}var d=b.split("/");var e=Forum.getMethod(d);var c=Forum.getParam(d);if(e!=undefined&&e!=null&&c!="undefined"){if(c==null){Forum[e]();}else{Forum[e](c);}}},insertAtCursor:function(f,d){var e=$(f);d=" "+d;if(document.selection){e.focus();sel=document.selection.createRange();sel.text=d;return;}if(e.selectionStart||e.selectionStart=="0"){var c=e.selectionStart;var b=e.selectionEnd;e.value=e.value.substring(0,c)+d+e.value.substring(b,e.value.length);}else{e.value+=d;}},showCreateTopic:function(){Forum.sendRequest({Type:"showCreateTopic"},"createTopic");},showCreateThread:function(){Forum.sendRequest({Type:"showCreateThread"},"createThread");},showCreatePost:function(){Forum.sendRequest({Type:"showCreatePost"},"createPost");},showTopics:function(){Forum.sendRequest({Type:"showTopics"},"forum");},showTopic:function(b){Forum.sendRequest({Type:"showTopic",TopicId:b},"forum");},showThread:function(b){Forum.sendRequest({Type:"showThread",ThreadId:b},"forum");},showEditPost:function(b){Forum.sendRequest({Type:"showEditPost",PostId:b},"createPost");},closeCreateTopic:function(){Forum.sendRequest({Type:"closeCreateTopic"},"createTopic");},closeCreateThread:function(){Forum.sendRequest({Type:"closeCreateThread"},"createThread");},closeCreatePost:function(){Forum.sendRequest({Type:"closeCreatePost"},"createPost");},closeEditPost:function(){Forum.sendRequest({Type:"closeEditPost"},"createPost");},createTopic:function(){Forum.sendPostRequest({Type:"createTopic",Name:$("topicName").value,Description:$("topicDescription").value},"publicforum");},createThread:function(){Forum.sendPostRequest({Type:"createThread",Title:$("threadTitle").value,Description:$("threadDescription").value,TopicId:$("topicId").value},"forumTopic");},createPost:function(){Forum.sendPostRequest({Type:"createPost",Text:$("postTextArea").value,ThreadId:$("threadId").value},"forumThread");},eraseTopic:function(b){if(confirm(Language.getToken("EraseTopic"))){Forum.sendRequest({Type:"eraseTopic",TopicId:b},"publicforum");}},eraseThread:function(b){if(confirm(Language.getToken("EraseThread"))){Forum.sendRequest({Type:"eraseThread",ThreadId:b},"forumTopic");}},erasePost:function(b){if(confirm(Language.getToken("ErasePost"))){Forum.sendRequest({Type:"erasePost",PostId:b},"forumThread");}},editPost:function(b){Forum.sendPostRequest({Type:"editPost",PostId:b,Text:$("postTextArea").value},"forumThread");}};window.addEvent("domready",Forum.init);
